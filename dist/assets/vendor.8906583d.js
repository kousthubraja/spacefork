/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};function e(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{a(r.next(t))}catch(e){o(e)}}function u(t){try{a(r.throw(t))}catch(e){o(e)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((r=r.apply(t,e||[])).next())}))}function i(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(u){o=[6,u],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function o(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=c(t[n],e[n]));return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var h=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function l(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var p=function(t){function n(e,r,i){var o=t.call(this,r)||this;return o.code=e,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,d.prototype.create),o}return e(n,t),n}(Error),d=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?v(o,r):"Error",u=this.serviceName+": "+s+" ("+i+").",a=new p(i,u,r);return a},t}();function v(t,e){return t.replace(y,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var y=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function m(t,e){var n=new b(t,e);return n.subscribe.bind(n)}var b=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=w),void 0===r.error&&(r.error=w),void 0===r.complete&&(r.complete=w);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function w(){}var I=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),E=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new h;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=n({identifier:"[DEFAULT]",optional:!1},t),r=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(r);try{var s=this.getOrInitializeService(o);if(!s){if(i)return null;throw Error("Service "+this.name+" is not available")}return s}catch(u){if(i)return null;throw u}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService("[DEFAULT]")}catch(l){}try{for(var r=o(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var u=s(i.value,2),a=u[0],c=u[1],h=this.normalizeInstanceIdentifier(a);try{var f=this.getOrInitializeService(h);c.resolve(f)}catch(l){}}}catch(p){e={error:p}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(u(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return"[DEFAULT]"===t?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _,T=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new E(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function A(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var N,S,D=[];(S=N||(N={}))[S.DEBUG=0]="DEBUG",S[S.VERBOSE=1]="VERBOSE",S[S.INFO=2]="INFO",S[S.WARN=3]="WARN",S[S.ERROR=4]="ERROR",S[S.SILENT=5]="SILENT";var O,x={debug:N.DEBUG,verbose:N.VERBOSE,info:N.INFO,warn:N.WARN,error:N.ERROR,silent:N.SILENT},P=N.INFO,k=((_={})[N.DEBUG]="log",_[N.VERBOSE]="log",_[N.INFO]="info",_[N.WARN]="warn",_[N.ERROR]="error",_),L=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=k[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,A(["["+i+"]  "+t.name+":"],n))}},R=function(){function t(t){this.name=t,this._logLevel=P,this._logHandler=L,this._userLogHandler=null,D.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in N))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?x[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.DEBUG],t)),this._logHandler.apply(this,A([this,N.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.VERBOSE],t)),this._logHandler.apply(this,A([this,N.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.INFO],t)),this._logHandler.apply(this,A([this,N.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.WARN],t)),this._logHandler.apply(this,A([this,N.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.ERROR],t)),this._logHandler.apply(this,A([this,N.ERROR],t))},t}();function C(t){D.forEach((function(e){e.setLogLevel(t)}))}var V,M=((O={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",O["bad-app-name"]="Illegal App name: '{$appName}",O["duplicate-app"]="Firebase App named '{$appName}' already exists",O["app-deleted"]="Firebase App named '{$appName}' already deleted",O["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",O["invalid-log-argument"]="First argument to `onLog` must be null or a function.",O),U=new d("app","Firebase",M),j=((V={})["@firebase/app"]="fire-core",V["@firebase/analytics"]="fire-analytics",V["@firebase/auth"]="fire-auth",V["@firebase/database"]="fire-rtdb",V["@firebase/functions"]="fire-fn",V["@firebase/installations"]="fire-iid",V["@firebase/messaging"]="fire-fcm",V["@firebase/performance"]="fire-perf",V["@firebase/remote-config"]="fire-rc",V["@firebase/storage"]="fire-gcs",V["@firebase/firestore"]="fire-fst",V["fire-js"]="fire-js",V["firebase-wrapper"]="fire-js-all",V),F=new R("@firebase/app"),q=function(){function t(t,e,n){var r,i,s=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=c(void 0,t),this.container=new T(e.name),this._addComponent(new I("app",(function(){return s}),"PUBLIC"));try{for(var u=o(this.firebase_.INTERNAL.components.values()),a=u.next();!a.done;a=u.next()){var h=a.value;this._addComponent(h)}}catch(f){r={error:f}}finally{try{a&&!a.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){F.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw U.create("app-deleted",{appName:this.name_})},t}();q.prototype.name&&q.prototype.options||q.prototype.delete||console.log("dc");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function G(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name="[DEFAULT]");var s=o.name;if("string"!=typeof s||!s)throw U.create("bad-app-name",{appName:String(s)});if(g(e,s))throw U.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=j[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),u=e.match(/\s|\//);if(o||u){var a=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&a.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&u&&a.push("and"),u&&a.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void F.warn(a.join(" "))}s(new I(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:C,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw U.create("invalid-log-argument",{appName:name});!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=x[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:N[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=D;r<i.length;r++)n(i[r])}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,e)},apps:null,SDK_VERSION:"8.0.0",INTERNAL:{registerComponent:s,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!g(e,t=t||"[DEFAULT]"))throw U.create("no-app",{appName:t});return e[t]}function s(s){var u,a,h=s.name;if(n.has(h))return F.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===s.type?r[h]:null;if(n.set(h,s),"PUBLIC"===s.type){var f=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[h])throw U.create("invalid-app-argument",{appName:h});return t[h]()};void 0!==s.serviceProps&&c(f,s.serviceProps),r[h]=f,t.prototype[h]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,h);return n.apply(this,s.multipleInstances?t:[])}}try{for(var l=o(Object.keys(e)),p=l.next();!p.done;p=l.next()){var d=p.value;e[d]._addComponent(s)}}catch(v){u={error:v}}finally{try{p&&!p.done&&(a=l.return)&&a.call(l)}finally{if(u)throw u.error}}return"PUBLIC"===s.type?r[h]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var B=function t(){var e=G(q);return e.INTERNAL=n(n({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){c(e,t)},createSubscribe:m,ErrorFactory:d,deepExtend:c}),e}(),z=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){F.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var H=self.firebase.SDK_VERSION;H&&H.indexOf("LITE")>=0&&F.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var K=B.initializeApp;B.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return l()&&F.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),K.apply(void 0,t)};var W,X,Y=B;(W=Y).INTERNAL.registerComponent(new I("platform-logger",(function(t){return new z(t)}),"PRIVATE")),W.registerVersion("@firebase/app","0.6.12",X),W.registerVersion("fire-js","");
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Y.registerVersion("firebase","8.0.0","app");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var Q=function(t,e){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function J(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var $,Z="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},tt=tt||{},et=Z||self;function nt(){}function rt(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function it(t){var e=rt(t);return"array"==e||"object"==e&&"number"==typeof t.length}function ot(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var st="closure_uid_"+(1e9*Math.random()>>>0),ut=0;function at(t,e,n){return t.call.apply(t.bind,arguments)}function ct(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ht(t,e,n){return(ht=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?at:ct).apply(null,arguments)}function ft(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var lt=Date.now;function pt(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function dt(){this.j=this.j,this.i=this.i}dt.prototype.j=!1,dt.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,st)&&t[st]||(t[st]=++ut))},dt.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var vt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},yt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function gt(t){return Array.prototype.concat.apply([],arguments)}function mt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function bt(t){return/^[\s\xa0]*$/.test(t)}var wt,It=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Et(t,e){return-1!=t.indexOf(e)}function _t(t,e){return t<e?-1:t>e?1:0}t:{var Tt=et.navigator;if(Tt){var At=Tt.userAgent;if(At){wt=At;break t}}wt=""}function Nt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function St(t){var e={};for(var n in t)e[n]=t[n];return e}var Dt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ot(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Dt.length;o++)n=Dt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function xt(t){return xt[" "](t),t}xt[" "]=nt;var Pt,kt,Lt=Et(wt,"Opera"),Rt=Et(wt,"Trident")||Et(wt,"MSIE"),Ct=Et(wt,"Edge"),Vt=Ct||Rt,Mt=Et(wt,"Gecko")&&!(Et(wt.toLowerCase(),"webkit")&&!Et(wt,"Edge"))&&!(Et(wt,"Trident")||Et(wt,"MSIE"))&&!Et(wt,"Edge"),Ut=Et(wt.toLowerCase(),"webkit")&&!Et(wt,"Edge");function jt(){var t=et.document;return t?t.documentMode:void 0}t:{var Ft="",qt=(kt=wt,Mt?/rv:([^\);]+)(\)|;)/.exec(kt):Ct?/Edge\/([\d\.]+)/.exec(kt):Rt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(kt):Ut?/WebKit\/(\S+)/.exec(kt):Lt?/(?:Version)[ \/]?(\S+)/.exec(kt):void 0);if(qt&&(Ft=qt?qt[1]:""),Rt){var Gt=jt();if(null!=Gt&&Gt>parseFloat(Ft)){Pt=String(Gt);break t}}Pt=Ft}var Bt,zt={};function Ht(t){return function(t,e){var n=zt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=It(String(Pt)).split("."),r=It(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=_t(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||_t(0==s[2].length,0==u[2].length)||_t(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}if(et.document&&Rt){var Kt=jt();Bt=Kt||(parseInt(Pt,10)||void 0)}else Bt=void 0;var Wt=Bt,Xt=!Rt||9<=Number(Wt),Yt=Rt&&!Ht("9"),Qt=function(){if(!et.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{et.addEventListener("test",nt,e),et.removeEventListener("test",nt,e)}catch(n){}return t}();function Jt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function $t(t,e){if(Jt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Mt){t:{try{xt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Zt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Jt.prototype.b=function(){this.defaultPrevented=!0},pt($t,Jt);var Zt={2:"touch",3:"pen",4:"mouse"};$t.prototype.b=function(){$t.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Yt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var te="closure_listenable_"+(1e6*Math.random()|0),ee=0;function ne(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++ee,this.Y=this.Z=!1}function re(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ie(t){this.src=t,this.a={},this.b=0}function oe(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=vt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(re(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function se(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}ie.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=se(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new ne(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var ue="closure_lm_"+(1e6*Math.random()|0),ae={};function ce(t,e,n,r,i){if(r&&r.once)return fe(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)ce(t,e[o],n,r,i);return null}return n=be(n),t&&t[te]?t.va(e,n,ot(r)?!!r.capture:!!r,i):he(t,e,n,!1,r,i)}function he(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=ot(i)?!!i.capture:!!i;if(s&&!Xt)return null;var u=ge(t);if(u||(t[ue]=u=new ie(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=ye,e=Xt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Qt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(de(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function fe(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)fe(t,e[o],n,r,i);return null}return n=be(n),t&&t[te]?t.wa(e,n,ot(r)?!!r.capture:!!r,i):he(t,e,n,!0,r,i)}function le(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)le(t,e[o],n,r,i);else r=ot(r)?!!r.capture:!!r,n=be(n),t&&t[te]?(t=t.c,(e=String(e).toString())in t.a&&(-1<(n=se(o=t.a[e],n,r,i))&&(re(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=ge(t))&&(e=t.a[e.toString()],t=-1,e&&(t=se(e,n,r,i)),(n=-1<t?e[t]:null)&&pe(n))}function pe(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[te])oe(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(de(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ge(e))?(oe(n,t),0==n.b&&(n.src=null,e[ue]=null)):re(t)}}}function de(t){return t in ae?ae[t]:ae[t]="on"+t}function ve(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&pe(t),n.call(r,e)}function ye(t,e){if(t.Y)return!0;if(!Xt){if(!e)t:{e=["window","event"];for(var n=et,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return ve(t,e=new $t(e,this))}return ve(t,new $t(e,this))}function ge(t){return(t=t[ue])instanceof ie?t:null}var me="__closure_events_fn_"+(1e9*Math.random()>>>0);function be(t){return"function"==rt(t)?t:(t[me]||(t[me]=function(e){return t.handleEvent(e)}),t[me])}function we(){dt.call(this),this.c=new ie(this),this.J=this,this.C=null}function Ie(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&oe(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}pt(we,dt),we.prototype[te]=!0,($=we.prototype).addEventListener=function(t,e,n,r){ce(this,t,e,n,r)},$.removeEventListener=function(t,e,n,r){le(this,t,e,n,r)},$.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new Jt(t,n);else if(t instanceof Jt)t.target=t.target||n;else{var i=t;Ot(t=new Jt(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Ie(s,r,!0,t)&&i}if(i=Ie(s=t.a=n,r,!0,t)&&i,i=Ie(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Ie(s=t.a=e[o],r,!1,t)&&i;return i},$.G=function(){if(we.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)re(n[r]);delete e.a[t],e.b--}}this.C=null},$.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},$.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ee=et.JSON.stringify;function _e(){this.b=this.a=null}var Te,Ae=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Se}),(function(t){t.reset()}),100);function Ne(){var t=Pe,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Se(){this.next=this.b=this.a=null}function De(t){et.setTimeout((function(){throw t}),0)}function Oe(t,e){Te||function(){var t=et.Promise.resolve(void 0);Te=function(){t.then(ke)}}(),xe||(Te(),xe=!0),Pe.add(t,e)}_e.prototype.add=function(t,e){var n=Ae.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Se.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Se.prototype.reset=function(){this.next=this.b=this.a=null};var xe=!1,Pe=new _e;function ke(){for(var t;t=Ne();){try{t.a.call(t.b)}catch(n){De(n)}var e=Ae;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}xe=!1}function Le(t,e){we.call(this),this.b=t||1,this.a=e||et,this.f=ht(this.Ya,this),this.g=lt()}function Re(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Ce(t,e,n){if("function"==rt(t))n&&(t=ht(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ht(t.handleEvent,t)}return 2147483647<Number(e)?-1:et.setTimeout(t,e||0)}function Ve(t){t.a=Ce((function(){t.a=null,t.c&&(t.c=!1,Ve(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}pt(Le,we),($=Le.prototype).aa=!1,$.M=null,$.Ya=function(){if(this.aa){var t=lt()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Re(this),this.start()))}},$.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=lt())},$.G=function(){Le.S.G.call(this),Re(this),delete this.a};var Me=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(t,e){function n(){this.constructor=t}Q(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Ve(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(et.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(dt);function Ue(t){dt.call(this),this.b=t,this.a={}}pt(Ue,dt);var je=[];function Fe(t,e,n,r){Array.isArray(n)||(n&&(je[0]=n.toString()),n=je);for(var i=0;i<n.length;i++){var o=ce(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function qe(t){Nt(t.a,(function(t,e){this.a.hasOwnProperty(e)&&pe(t)}),t),t.a={}}function Ge(){this.a=!0}function Be(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ee(n)}catch(u){return e}}(t,n)+(r?" "+r:"")}))}Ue.prototype.G=function(){Ue.S.G.call(this),qe(this)},Ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ge.prototype.info=function(){};var ze=null;function He(){return ze=ze||new we}function Ke(t){Jt.call(this,"serverreachability",t)}function We(t){var e=He();e.dispatchEvent(new Ke(e,t))}function Xe(t){Jt.call(this,"statevent",t)}function Ye(t){var e=He();e.dispatchEvent(new Xe(e,t))}function Qe(t){Jt.call(this,"timingevent",t)}function Je(t,e){if("function"!=rt(t))throw Error("Fn must not be null and must be a function");return et.setTimeout((function(){t()}),e)}pt(Ke,Jt),pt(Xe,Jt),pt(Qe,Jt);var $e={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ze={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function tn(){}function en(t){var e;return(e=t.a)||(e=t.a={}),e}function nn(){}tn.prototype.a=null;var rn,on={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function sn(){Jt.call(this,"d")}function un(){Jt.call(this,"c")}function an(){}function cn(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new Ue(this),this.P=hn,t=Vt?125:void 0,this.R=new Le(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}pt(sn,Jt),pt(un,Jt),pt(an,tn),rn=new an;var hn=45e3,fn={},ln={};function pn(t,e,n){t.H=1,t.i=Cn(On(e)),t.j=n,t.I=!0,dn(t,null)}function dn(t,e){t.u=lt(),gn(t),t.l=On(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),Xn(n.b,"t",r),t.D=0,t.a=Gr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Me(ht(t.Ca,t,t.a),t.O)),Fe(t.J,t.a,"readystatechange",t.Wa),e=t.B?St(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),We(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.T,t.j)}function vn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=yn(t,n);if(i==ln){4==e&&(t.h=4,Ye(14),r=!1),Be(t.c,t.f,null,"[Incomplete Response]");break}if(i==fn){t.h=4,Ye(15),Be(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Be(t.c,t.f,i,null),En(t,i)}4==e&&0==n.length&&(t.h=1,Ye(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Rr(e),e.F=!0)):(Be(t.c,t.f,n,"[Invalid Chunked Response]"),In(t),wn(t))}function yn(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?ln:(n=Number(e.substring(n,r)),isNaN(n)?fn:(r+=1)+n>e.length?ln:(e=e.substr(r,n),t.D=r+n,e))}function gn(t){t.U=lt()+t.P,mn(t,t.P)}function mn(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Je(ht(t.Ua,t),e)}function bn(t){t.o&&(et.clearTimeout(t.o),t.o=null)}function wn(t){0==t.g.v||t.A||Mr(t.g,t)}function In(t){bn(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Re(t.R),qe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function En(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||er(n.b,t)))if(n.I=t.N,!t.C&&er(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(y){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Vr(n),Ar(n)}Lr(n),Ye(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Je(ht(n.Ra,n),6e3));if(1>=tr(n.b)&&n.ea){try{n.ea()}catch(y){}n.ea=void 0}}else jr(n,11)}else if((t.C||n.a==t)&&Vr(n),!bt(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(Et(h,"spdy")||Et(h,"quic")||Et(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(nr(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,Rn(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=lt()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=qr(a,a.C?a.ga:null,a.fa),p.C){rr(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(bn(d),gn(d)),a.a=p}else kr(a);0<n.g.length&&Dr(n)}else"stop"!=i[0]&&"close"!=i[0]||jr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?jr(n,7):Tr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);We(4)}catch(y){}}function _n(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(it(t)||"string"==typeof t)yt(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(it(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(it(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Tn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Tn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function An(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Nn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Nn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Nn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}($=cn.prototype).setTimeout=function(t){this.P=t},$.Wa=function(t){t=t.target;var e=this.F;e&&3==wr(t)?e.f():this.Ca(t)},$.Ca=function(t){try{if(t==this.a)t:{var e=wr(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!Vt&&!this.a.$())){this.A||4!=e||7==n||We(8==n||0>=r?3:2),bn(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!bt(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Ye(12),In(this),wn(this);break t}Be(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,En(this,a)}this.I?(vn(this,e,o),Vt&&this.b&&3==e&&(Fe(this.J,this.R,"tick",this.Va),this.R.start())):(Be(this.c,this.f,o,null),En(this,o)),4==e&&In(this),this.b&&!this.A&&(4==e?Mr(this.g,this):(this.b=!1,gn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ye(12)):(this.h=0,Ye(13)),In(this),wn(this)}}}catch(Xl){}},$.Va=function(){if(this.a){var t=wr(this.a),e=this.a.$();this.D<e.length&&(bn(this),vn(this,t,e),this.b&&4!=t&&gn(this))}},$.cancel=function(){this.A=!0,In(this)},$.Ua=function(){this.o=null;var t=lt();0<=t-this.U?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(We(3),Ye(17)),In(this),this.h=2,wn(this)):mn(this,this.U-t)},($=Tn.prototype).K=function(){An(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},$.L=function(){return An(this),this.a.concat()},$.get=function(t,e){return Nn(this.b,t)?this.b[t]:e},$.set=function(t,e){Nn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},$.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Sn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Dn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Dn){this.a=void 0!==e?e:t.a,xn(this,t.f),this.j=t.j,Pn(this,t.c),kn(this,t.h),this.g=t.g,e=t.b;var n=new zn;n.c=e.c,e.a&&(n.a=new Tn(e.a),n.b=e.b),Ln(this,n),this.i=t.i}else t&&(n=String(t).match(Sn))?(this.a=!!e,xn(this,n[1]||"",!0),this.j=Vn(n[2]||""),Pn(this,n[3]||"",!0),kn(this,n[4]),this.g=Vn(n[5]||"",!0),Ln(this,n[6]||"",!0),this.i=Vn(n[7]||"")):(this.a=!!e,this.b=new zn(null,this.a))}function On(t){return new Dn(t)}function xn(t,e,n){t.f=n?Vn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Pn(t,e,n){t.c=n?Vn(e,!0):e}function kn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ln(t,e,n){e instanceof zn?(t.b=e,function(t,e){e&&!t.f&&(Hn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Kn(this,e),Xn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Mn(e,Gn)),t.b=new zn(e,t.a))}function Rn(t,e,n){t.b.set(e,n)}function Cn(t){return Rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^lt()).toString(36)),t}function Vn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Mn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Dn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Mn(e,jn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Mn(e,jn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Mn(n,"/"==n.charAt(0)?qn:Fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Mn(n,Bn)),t.join("")};var jn=/[#\/\?@]/g,Fn=/[#\?:]/g,qn=/[#\?]/g,Gn=/[#\?@]/g,Bn=/#/g;function zn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Hn(t){t.a||(t.a=new Tn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Kn(t,e){Hn(t),e=Yn(t,e),Nn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Nn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&An(t)))}function Wn(t,e){return Hn(t),e=Yn(t,e),Nn(t.a.b,e)}function Xn(t,e,n){Kn(t,e),0<n.length&&(t.c=null,t.a.set(Yn(t,e),mt(n)),t.b+=n.length)}function Yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Qn(t,e){this.b=t,this.a=e}function Jn(t){this.g=t||$n,et.PerformanceNavigationTiming?t=0<(t=et.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(et.ia&&et.ia.ya&&et.ia.ya()&&et.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}($=zn.prototype).add=function(t,e){Hn(this),this.c=null,t=Yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},$.forEach=function(t,e){Hn(this),this.a.forEach((function(n,r){yt(n,(function(n){t.call(e,n,r,this)}),this)}),this)},$.L=function(){Hn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},$.K=function(t){Hn(this);var e=[];if("string"==typeof t)Wn(this,t)&&(e=gt(e,this.a.get(Yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=gt(e,t[n])}return e},$.set=function(t,e){return Hn(this),this.c=null,Wn(this,t=Yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},$.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},$.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var $n=10;function Zn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function tr(t){return t.b?1:t.a?t.a.size:0}function er(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function nr(t,e){t.a?t.a.add(e):t.b=e}function rr(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function ir(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=J(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return mt(t.c)}function or(){}function sr(){this.a=new or}function ur(t,e,n){var r=n||"";try{_n(t,(function(t,n){var i=t;ot(t)&&(i=Ee(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function ar(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Jn.prototype.cancel=function(){var t,e;if(this.c=ir(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=J(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},or.prototype.stringify=function(t){return et.JSON.stringify(t,void 0)},or.prototype.parse=function(t){return et.JSON.parse(t,void 0)};var cr=et.JSON.parse;function hr(t){we.call(this),this.headers=new Tn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=fr,this.D=this.F=!1}pt(hr,we);var fr="",lr=/^https?$/i,pr=["POST","PUT"];function dr(t){return"content-type"==t.toLowerCase()}function vr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,yr(t),mr(t)}function yr(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function gr(t){if(t.b&&void 0!==tt&&(!t.s[1]||4!=wr(t)||2!=t.X()))if(t.l&&4==wr(t))Ce(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==wr(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Sn)[1]||null;if(!o&&et.self&&et.self.location){var s=et.self.location.protocol;o=s.substr(0,s.length-1)}i=!lr.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<wr(t)?t.a.statusText:""}catch(a){u=""}t.f=u+" ["+t.X()+"]",yr(t)}}finally{mr(t)}}}function mr(t,e){if(t.a){br(t);var n=t.a,r=t.s[0]?nt:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function br(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(et.clearTimeout(t.m),t.m=null)}function wr(t){return t.a?t.a.readyState:0}function Ir(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Nt(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Rn(t,e,n))}function Er(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function _r(t){this.pa=0,this.g=[],this.c=new Ge,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Er("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Er("baseRetryDelayMs",5e3,t),this.Ma=Er("retryDelaySeedMs",1e4,t),this.Ja=Er("forwardChannelMaxRetries",2,t),this.ma=Er("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Jn(t&&t.concurrentRequestLimit),this.ka=new sr,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Tr(t){if(Nr(t),3==t.v){var e=t.R++,n=On(t.B);Rn(n,"SID",t.J),Rn(n,"RID",e),Rn(n,"TYPE","terminate"),xr(t,n),(e=new cn(t,t.c,e,void 0)).H=2,e.i=Cn(On(n)),n=!1,et.navigator&&et.navigator.sendBeacon&&(n=et.navigator.sendBeacon(e.i.toString(),"")),!n&&et.Image&&((new Image).src=e.i,n=!0),n||(e.a=Gr(e.g,null),e.a.ba(e.i)),e.u=lt(),gn(e)}Fr(t)}function Ar(t){t.a&&(Rr(t),t.a.cancel(),t.a=null)}function Nr(t){Ar(t),t.j&&(et.clearTimeout(t.j),t.j=null),Vr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&et.clearTimeout(t.h),t.h=null)}function Sr(t,e){t.g.push(new Qn(t.La++,e)),3==t.v&&Dr(t)}function Dr(t){Zn(t.b)||t.h||(t.h=!0,Oe(t.Ba,t),t.u=0)}function Or(t,e){var n;n=e?e.f:t.R++;var r=On(t.B);Rn(r,"SID",t.J),Rn(r,"RID",n),Rn(r,"AID",t.P),xr(t,r),t.i&&t.l&&Ir(r,t.i,t.l),n=new cn(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Pr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),nr(t.b,n),pn(n,r,e)}function xr(t,e){t.f&&_n({},(function(t,n){Rn(e,n,t)}))}function Pr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?ht(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{ur(h,s,"req"+c+"_")}catch(f){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function kr(t){t.a||t.j||(t.U=1,Oe(t.Aa,t),t.o=0)}function Lr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Je(ht(t.Aa,t),Ur(t,t.o)),t.o++,!0)}function Rr(t){null!=t.s&&(et.clearTimeout(t.s),t.s=null)}function Cr(t){t.a=new cn(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=On(t.la);Rn(e,"RID","rpc"),Rn(e,"SID",t.J),Rn(e,"CI",t.H?"0":"1"),Rn(e,"AID",t.P),xr(t,e),Rn(e,"TYPE","xmlhttp"),t.i&&t.l&&Ir(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Cn(On(e)),n.j=null,n.I=!0,dn(n,t)}function Vr(t){null!=t.m&&(et.clearTimeout(t.m),t.m=null)}function Mr(t,e){var n=null;if(t.a==e){Vr(t),Rr(t),t.a=null;var r=2}else{if(!er(t.b,e))return;n=e.s,rr(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=lt()-e.u;var i=t.u;(r=He()).dispatchEvent(new Qe(r,n,e,i)),Dr(t)}else kr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(tr(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)||(t.h=Je(ht(t.Ba,t,e),Ur(t,t.u)),t.u++,0)))}(t,e)||2==r&&Lr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:jr(t,5);break;case 4:jr(t,10);break;case 3:jr(t,6);break;default:jr(t,2)}}function Ur(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function jr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=ht(t.Xa,t);n||(n=new Dn("//www.google.com/images/cleardot.gif"),et.location&&"http"==et.location.protocol||xn(n,"https"),Cn(n)),function(t,e){var n=new Ge;if(et.Image){var r=new Image;r.onload=ft(ar,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ft(ar,n,r,"TestLoadImage: error",!1,e),r.onabort=ft(ar,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ft(ar,n,r,"TestLoadImage: timeout",!1,e),et.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ye(2);t.v=0,t.f&&t.f.ra(e),Fr(t),Nr(t)}function Fr(t){t.v=0,t.I=-1,t.f&&(0==ir(t.b).length&&0==t.g.length||(t.b.c.length=0,mt(t.g),t.g.length=0),t.f.qa())}function qr(t,e,n){var r=function(t){return t instanceof Dn?On(t):new Dn(t,void 0)}(n);if(""!=r.c)e&&Pn(r,e+"."+r.c),kn(r,r.h);else{var i=et.location;r=function(t,e,n,r){var i=new Dn(null,void 0);return t&&xn(i,t),e&&Pn(i,e),n&&kn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&Nt(t.W,(function(t,e){Rn(r,e,t)})),e=t.A,n=t.na,e&&n&&Rn(r,e,n),Rn(r,"VER",t.ha),xr(t,r),r}function Gr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new hr(t.Ka)).F=t.C,e}function Br(){}function zr(){if(Rt&&!(10<=Number(Wt)))throw Error("Environmental error: no available transport.")}function Hr(t,e){we.call(this),this.a=new _r(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!bt(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!bt(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Xr(this)}function Kr(t){sn.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Wr(){un.call(this),this.status=1}function Xr(t){this.a=t}($=hr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?en(this.H):en(rn),this.a.onreadystatechange=ht(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void vr(this,o)}t=n||"";var i=new Tn(this.headers);r&&_n(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=dr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=et.FormData&&t instanceof et.FormData,!(0<=vt(pr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{br(this),0<this.o&&((this.D=function(t){return Rt&&Ht(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=ht(this.xa,this)):this.m=Ce(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){vr(this,o)}},$.xa=function(){void 0!==tt&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},$.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),mr(this))},$.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),mr(this,!0)),hr.S.G.call(this)},$.za=function(){this.j||(this.A||this.l||this.g?gr(this):this.Ta())},$.Ta=function(){gr(this)},$.X=function(){try{return 2<wr(this)?this.a.status:-1}catch(kt){return-1}},$.$=function(){try{return this.a?this.a.responseText:""}catch(kt){return""}},$.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),cr(e)}},$.ua=function(){return this.h},$.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},($=_r.prototype).ha=8,$.v=1,$.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new cn(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Ot(r=St(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Pr(this,n,e),Rn(i=On(this.B),"RID",t),Rn(i,"CVER",22),this.A&&Rn(i,"X-HTTP-Session-Id",this.A),xr(this,i),this.i&&r&&Ir(i,this.i,r),nr(this.b,n),this.Ga&&Rn(i,"TYPE","init"),this.da?(Rn(i,"$req",e),Rn(i,"SID","null"),n.V=!0,pn(n,i,null)):pn(n,i,e),this.v=2}}else 3==this.v&&(t?Or(this,t):0==this.g.length||Zn(this.b)||Or(this))},$.Aa=function(){if(this.j=null,Cr(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Je(ht(this.Sa,this),t)}},$.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Ar(this),Cr(this))},$.Ra=function(){null!=this.m&&(this.m=null,Ar(this),Lr(this),Ye(19))},$.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Ye(2)):(this.c.info("Failed to ping google.com"),Ye(1))},($=Br.prototype).ta=function(){},$.sa=function(){},$.ra=function(){},$.qa=function(){},$.Ha=function(){},zr.prototype.a=function(t,e){return new Hr(t,e)},pt(Hr,we),($=Hr.prototype).addEventListener=function(t,e,n,r){Hr.S.addEventListener.call(this,t,e,n,r)},$.removeEventListener=function(t,e,n,r){Hr.S.removeEventListener.call(this,t,e,n,r)},$.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ye(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=qr(t,null,t.fa),Dr(t)},$.close=function(){Tr(this.a)},$.Pa=function(t){if("string"==typeof t){var e={};e.__data__=t,Sr(this.a,e)}else this.g?((e={}).__data__=Ee(t),Sr(this.a,e)):Sr(this.a,t)},$.G=function(){this.a.f=null,delete this.f,Tr(this.a),delete this.a,Hr.S.G.call(this)},pt(Kr,sn),pt(Wr,un),pt(Xr,Br),Xr.prototype.ta=function(){this.a.dispatchEvent("a")},Xr.prototype.sa=function(t){this.a.dispatchEvent(new Kr(t))},Xr.prototype.ra=function(t){this.a.dispatchEvent(new Wr(t))},Xr.prototype.qa=function(){this.a.dispatchEvent("b")},zr.prototype.createWebChannel=zr.prototype.a,Hr.prototype.send=Hr.prototype.Pa,Hr.prototype.open=Hr.prototype.Oa,Hr.prototype.close=Hr.prototype.close,$e.NO_ERROR=0,$e.TIMEOUT=8,$e.HTTP_ERROR=6,Ze.COMPLETE="complete",nn.EventType=on,on.OPEN="a",on.CLOSE="b",on.ERROR="c",on.MESSAGE="d",we.prototype.listen=we.prototype.va,hr.prototype.listenOnce=hr.prototype.wa,hr.prototype.getLastError=hr.prototype.Qa,hr.prototype.getLastErrorCode=hr.prototype.ua,hr.prototype.getStatus=hr.prototype.X,hr.prototype.getResponseJson=hr.prototype.Na,hr.prototype.getResponseText=hr.prototype.$,hr.prototype.send=hr.prototype.ba;var Yr=$e,Qr=Ze,Jr=nn,$r=hr,Zr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ti=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return e(n,t),n}(Error),ei=new R("@firebase/firestore");function ni(){return ei.logLevel}function ri(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ei.logLevel<=N.DEBUG){var r=e.map(si);ei.debug.apply(ei,a(["Firestore (8.0.0): "+t],r))}}function ii(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ei.logLevel<=N.ERROR){var r=e.map(si);ei.error.apply(ei,a(["Firestore (8.0.0): "+t],r))}}function oi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ei.logLevel<=N.WARN){var r=e.map(si);ei.warn.apply(ei,a(["Firestore (8.0.0): "+t],r))}}function si(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(n){return t}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.0.0) INTERNAL ASSERTION FAILED: "+t;throw ii(e),new Error(e)}function ai(t,e){t||ui()}function ci(t,e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fi=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=hi(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function li(t,e){return t<e?-1:t>e?1:0}function pi(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function di(t){return t+"\0"}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vi=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.i,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.h=function(t){return li(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();vi.u=new vi("");var yi=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(vi.fromBase64String(e))}catch(n){throw new ti(Zr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+n)}},t.fromUint8Array=function(e){return new t(vi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(){if("undefined"==typeof Uint8Array)throw new ti(Zr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function mi(){if("undefined"==typeof atob)throw new ti(Zr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var bi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.fromBase64String=function(t){mi();try{return new n(vi.fromBase64String(t))}catch(e){throw new ti(Zr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},n.fromUint8Array=function(t){return gi(),new n(vi.fromUint8Array(t))},n.prototype.toBase64=function(){return mi(),t.prototype.toBase64.call(this)},n.prototype.toUint8Array=function(){return gi(),t.prototype.toUint8Array.call(this)},n.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},n}(yi),wi=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o},Ii=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.h=function(t){return li(this.projectId,t.projectId)||li(this.database,t.database)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function _i(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ti(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ai=function(){function t(t,e){this.m=t,this.A=e,this.R={}}return t.prototype.get=function(t){var e=this.m(t),n=this.R[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.A(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){_i(this.R,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},t.prototype.P=function(){return Ti(this.R)},t}(),Ni=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new ti(Zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new ti(Zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new ti(Zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ti(Zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.g=function(t){return this.seconds===t.seconds?li(this.nanoseconds,t.nanoseconds):li(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Si=function(){function t(t){this.timestamp=t}return t.V=function(e){return new t(e)},t.min=function(){return new t(new Ni(0,0))},t.prototype.h=function(t){return this.timestamp.g(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.v=function(){return this.timestamp},t}(),Di=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ui(),void 0===n?n=t.length-e:n>t.length-e&&ui(),this.segments=t,this.offset=e,this.S=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.D(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.C(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.N=function(t){return t=void 0===t?1:t,this.C(this.segments,this.offset+t,this.length-t)},t.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},t.prototype.k=function(){return this.segments[this.offset]},t.prototype.O=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.P=function(){return 0===this.length},t.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},t.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Oi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.C=function(t,e,r){return new n(t,e,r)},n.prototype.B=function(){return this.L().join("/")},n.prototype.toString=function(){return this.B()},n.q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new ti(Zr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new n(r)},n.U=function(){return new n([])},n}(Di),xi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Pi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.C=function(t,e,r){return new n(t,e,r)},n.K=function(t){return xi.test(t)},n.prototype.B=function(){return this.L().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),n.K(t)||(t="`"+t+"`"),t})).join(".")},n.prototype.toString=function(){return this.B()},n.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},n.j=function(){return new n(["__name__"])},n.G=function(t){for(var e=[],r="",i=0,o=function(){if(0===r.length)throw new ti(Zr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new ti(Zr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new ti(Zr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new ti(Zr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new n(e)},n.U=function(){return new n([])},n}(Di),ki=function(){function t(t){this.path=t}return t.H=function(e){return new t(Oi.q(e))},t.J=function(e){return new t(Oi.q(e).N(5))},t.prototype.Y=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Oi.D(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.D=function(t,e){return Oi.D(t.path,e.path)},t.X=function(t){return t.length%2==0},t.Z=function(e){return new t(new Oi(e.slice()))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(t){return null==t}function Ri(t){return 0===t&&1/t==-1/0}function Ci(t){return"number"==typeof t&&Number.isInteger(t)&&!Ri(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function Mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Vi(t,e,n,r,i,o,s)}function Ui(t){var e=ci(t);if(null===e.tt){var n=e.path.B();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return(e=t).field.B()+e.op.toString()+xo(e.value);var e})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.B()+e.dir;var e})).join(","),Li(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Ru(e.startAt)),e.endAt&&(n+="|ub:",n+=Ru(e.endAt)),e.tt=n}return e.tt}function ji(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!ju(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!No(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Vu(t.startAt,e.startAt)&&Vu(t.endAt,e.endAt)}function Fi(t){return ki.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qi,Gi,Bi=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Si.min()),void 0===o&&(o=Si.min()),void 0===s&&(s=vi.u),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.st=function(e){return new t(this.target,this.targetId,this.et,e,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.it=function(e,n){return new t(this.target,this.targetId,this.et,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.rt=function(e){return new t(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,e,this.resumeToken)},t}(),zi=function(t){this.count=t};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(t){switch(t){case Zr.OK:return ui();case Zr.CANCELLED:case Zr.UNKNOWN:case Zr.DEADLINE_EXCEEDED:case Zr.RESOURCE_EXHAUSTED:case Zr.INTERNAL:case Zr.UNAVAILABLE:case Zr.UNAUTHENTICATED:return!1;case Zr.INVALID_ARGUMENT:case Zr.NOT_FOUND:case Zr.ALREADY_EXISTS:case Zr.PERMISSION_DENIED:case Zr.FAILED_PRECONDITION:case Zr.ABORTED:case Zr.OUT_OF_RANGE:case Zr.UNIMPLEMENTED:case Zr.DATA_LOSS:return!0;default:return ui()}}function Ki(t){if(void 0===t)return ii("GRPC error has no .code"),Zr.UNKNOWN;switch(t){case qi.OK:return Zr.OK;case qi.CANCELLED:return Zr.CANCELLED;case qi.UNKNOWN:return Zr.UNKNOWN;case qi.DEADLINE_EXCEEDED:return Zr.DEADLINE_EXCEEDED;case qi.RESOURCE_EXHAUSTED:return Zr.RESOURCE_EXHAUSTED;case qi.INTERNAL:return Zr.INTERNAL;case qi.UNAVAILABLE:return Zr.UNAVAILABLE;case qi.UNAUTHENTICATED:return Zr.UNAUTHENTICATED;case qi.INVALID_ARGUMENT:return Zr.INVALID_ARGUMENT;case qi.NOT_FOUND:return Zr.NOT_FOUND;case qi.ALREADY_EXISTS:return Zr.ALREADY_EXISTS;case qi.PERMISSION_DENIED:return Zr.PERMISSION_DENIED;case qi.FAILED_PRECONDITION:return Zr.FAILED_PRECONDITION;case qi.ABORTED:return Zr.ABORTED;case qi.OUT_OF_RANGE:return Zr.OUT_OF_RANGE;case qi.UNIMPLEMENTED:return Zr.UNIMPLEMENTED;case qi.DATA_LOSS:return Zr.DATA_LOSS;default:return ui()}}(Gi=qi||(qi={}))[Gi.OK=0]="OK",Gi[Gi.CANCELLED=1]="CANCELLED",Gi[Gi.UNKNOWN=2]="UNKNOWN",Gi[Gi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gi[Gi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gi[Gi.NOT_FOUND=5]="NOT_FOUND",Gi[Gi.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gi[Gi.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gi[Gi.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gi[Gi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gi[Gi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gi[Gi.ABORTED=10]="ABORTED",Gi[Gi.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gi[Gi.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gi[Gi.INTERNAL=13]="INTERNAL",Gi[Gi.UNAVAILABLE=14]="UNAVAILABLE",Gi[Gi.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wi=function(){function t(t,e){this.D=t,this.root=e||Yi.EMPTY}return t.prototype.ot=function(e,n){return new t(this.D,this.root.ot(e,n,this.D).copy(null,null,Yi.at,null,null))},t.prototype.remove=function(e){return new t(this.D,this.root.remove(e,this.D).copy(null,null,Yi.at,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.P=function(){return this.root.P()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.ht=function(){return this.root.ht()},t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ut((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.lt=function(t){return this.root.lt(t)},t.prototype._t=function(){return new Xi(this.root,null,this.D,!1)},t.prototype.ft=function(t){return new Xi(this.root,t,this.D,!1)},t.prototype.dt=function(){return new Xi(this.root,null,this.D,!0)},t.prototype.wt=function(t){return new Xi(this.root,t,this.D,!0)},t}(),Xi=function(){function t(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}return t.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},t.prototype.At=function(){return this.Tt.length>0},t.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),Yi=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.P=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},t.prototype.min=function(){return this.left.P()?this:this.left.min()},t.prototype.ht=function(){return this.min().key},t.prototype.ct=function(){return this.right.P()?this.key:this.right.ct()},t.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},t.prototype.gt=function(){if(this.left.P())return t.EMPTY;var e=this;return e.left.Vt()||e.left.left.Vt()||(e=e.yt()),(e=e.copy(null,null,null,e.left.gt(),null)).Pt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.P()||i.left.Vt()||i.left.left.Vt()||(i=i.yt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Vt()&&(i=i.bt()),i.right.P()||i.right.Vt()||i.right.left.Vt()||(i=i.vt()),0===n(e,i.key)){if(i.right.P())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.gt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Pt()},t.prototype.Vt=function(){return this.color},t.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.St()),t.left.Vt()&&t.left.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.right.Vt()&&(t=t.Dt()),t},t.prototype.yt=function(){var t=this.Dt();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},t.prototype.vt=function(){var t=this.Dt();return t.left.left.Vt()&&(t=(t=t.bt()).Dt()),t},t.prototype.St=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.bt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},t.prototype.Nt=function(){if(this.Vt()&&this.left.Vt())throw ui();if(this.right.Vt())throw ui();var t=this.left.Nt();if(t!==this.right.Nt())throw ui();return t+(this.Vt()?0:1)},t}();Yi.EMPTY=null,Yi.RED=!0,Yi.at=!1,Yi.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ui()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ui()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ui()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ui()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ui()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.ot=function(t,e,n){return new Yi(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.P=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.lt=function(t){return!1},t.prototype.ht=function(){return null},t.prototype.ct=function(){return null},t.prototype.Vt=function(){return!1},t.prototype.Ct=function(){return!0},t.prototype.Nt=function(){return 0},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Qi=function(){function t(t){this.D=t,this.data=new Wi(this.D)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.ht()},t.prototype.last=function(){return this.data.ct()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut((function(e,n){return t(e),!1}))},t.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(this.D(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},t.prototype.kt=function(t){var e=this.data.ft(t);return e.At()?e.It().key:null},t.prototype._t=function(){return new Ji(this.data._t())},t.prototype.ft=function(t){return new Ji(this.data.ft(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.P=function(){return this.data.P()},t.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data._t(),r=e.data._t();n.At();){var i=n.It().key,o=r.It().key;if(0!==this.D(i,o))return!1}return!0},t.prototype.L=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.D);return n.data=e,n},t}(),Ji=function(){function t(t){this.Mt=t}return t.prototype.It=function(){return this.Mt.It().key},t.prototype.At=function(){return this.Mt.At()},t}(),$i=new Wi(ki.D);function Zi(){return $i}function to(){return Zi()}var eo=new Wi(ki.D);function no(){return eo}var ro=new Wi(ki.D),io=new Qi(ki.D);function oo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=io,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var so=new Qi(li);function uo(){return so}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ao=function(){function t(t){this.D=t?function(e,n){return t(e,n)||ki.D(e.key,n.key)}:function(t,e){return ki.D(t.key,e.key)},this.$t=no(),this.Lt=new Wi(this.D)}return t.Bt=function(e){return new t(e.D)},t.prototype.has=function(t){return null!=this.$t.get(t)},t.prototype.get=function(t){return this.$t.get(t)},t.prototype.first=function(){return this.Lt.ht()},t.prototype.last=function(){return this.Lt.ct()},t.prototype.P=function(){return this.Lt.P()},t.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Lt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Lt.ut((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Lt._t(),r=e.Lt._t();n.At();){var i=n.It().key,o=r.It().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.D=this.D,r.$t=e,r.Lt=n,r},t}(),co=function(){function t(){this.qt=new Wi(ki.D)}return t.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);n?0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):ui():this.qt=this.qt.ot(e,t)},t.prototype.Ut=function(){var t=[];return this.qt.ut((function(e,n){t.push(n)})),t},t}(),ho=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}return t.Gt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,ao.Bt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&bu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),fo=function(){function t(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Jt=r,this.Yt=i}return t.Xt=function(e,n){var r=new Map;return r.set(e,lo.Zt(e,n)),new t(Si.min(),r,uo(),Zi(),oo())},t}(),lo=function(){function t(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}return t.Zt=function(e,n){return new t(vi.u,n,oo(),oo(),oo())},t}(),po=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},vo=function(t,e){this.targetId=t,this.oe=e},yo=function(t,e,n,r){void 0===n&&(n=vi.u),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},go=function(){function t(){this.ae=0,this.he=wo(),this.ce=vi.u,this.ue=!1,this.le=!0}return Object.defineProperty(t.prototype,"te",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),t.prototype.de=function(t){t.o()>0&&(this.le=!0,this.ce=t)},t.prototype.we=function(){var t=oo(),e=oo(),n=oo();return this.he.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ui()}})),new lo(this.ce,this.ue,t,e,n)},t.prototype.Ee=function(){this.le=!1,this.he=wo()},t.prototype.Te=function(t,e){this.le=!0,this.he=this.he.ot(t,e)},t.prototype.Ie=function(t){this.le=!0,this.he=this.he.remove(t)},t.prototype.me=function(){this.ae+=1},t.prototype.Ae=function(){this.ae-=1},t.prototype.Re=function(){this.le=!0,this.ue=!0},t}(),mo=function(){function t(t){this.Pe=t,this.ge=new Map,this.Ve=Zi(),this.ye=bo(),this.pe=new Qi(li)}return t.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof ru?this.ve(r,t.re):t.re instanceof iu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},t.prototype.De=function(t){var e=this;this.Ce(t,(function(n){var r=e.Ne(n);switch(t.state){case 0:e.xe(n)&&r.de(t.resumeToken);break;case 1:r.Ae(),r._e||r.Ee(),r.de(t.resumeToken);break;case 2:r.Ae(),r._e||e.removeTarget(n);break;case 3:e.xe(n)&&(r.Re(),r.de(t.resumeToken));break;case 4:e.xe(n)&&(e.Fe(n),r.de(t.resumeToken));break;default:ui()}}))},t.prototype.Ce=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ge.forEach((function(t,r){n.xe(r)&&e(r)}))},t.prototype.ke=function(t){var e=t.targetId,n=t.oe.count,r=this.Oe(e);if(r){var i=r.target;if(Fi(i))if(0===n){var o=new ki(i.path);this.Se(e,o,new iu(o,Si.min()))}else ai(1===n);else this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e))}},t.prototype.$e=function(t){var e=this,n=new Map;this.ge.forEach((function(r,i){var o=e.Oe(i);if(o){if(r.te&&Fi(o.target)){var s=new ki(o.target.path);null!==e.Ve.get(s)||e.Le(i,s)||e.Se(i,s,new iu(s,t))}r.fe&&(n.set(i,r.we()),r.Ee())}}));var r=oo();this.ye.forEach((function(t,n){var i=!0;n.Ft((function(t){var n=e.Oe(t);return!n||2===n.et||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new fo(t,n,this.pe,this.Ve,r);return this.Ve=Zi(),this.ye=bo(),this.pe=new Qi(li),i},t.prototype.ve=function(t,e){if(this.xe(t)){var n=this.Le(t,e.key)?2:0;this.Ne(t).Te(e.key,n),this.Ve=this.Ve.ot(e.key,e),this.ye=this.ye.ot(e.key,this.Be(e.key).add(t))}},t.prototype.Se=function(t,e,n){if(this.xe(t)){var r=this.Ne(t);this.Le(t,e)?r.Te(e,1):r.Ie(e),this.ye=this.ye.ot(e,this.Be(e).delete(t)),n&&(this.Ve=this.Ve.ot(e,n))}},t.prototype.removeTarget=function(t){this.ge.delete(t)},t.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},t.prototype.me=function(t){this.Ne(t).me()},t.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new go,this.ge.set(t,e)),e},t.prototype.Be=function(t){var e=this.ye.get(t);return e||(e=new Qi(li),this.ye=this.ye.ot(t,e)),e},t.prototype.xe=function(t){var e=null!==this.Oe(t);return e||ri("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Oe=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},t.prototype.Fe=function(t){var e=this;this.ge.set(t,new go),this.Pe.qe(t).forEach((function(n){e.Se(t,n,null)}))},t.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(){return new Wi(ki.D)}function wo(){return new Wi(ki.D)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Eo(t){var e=t.mapValue.fields.__previous_value__;return Io(e)?Eo(e):e}function _o(t){var e=ko(t.mapValue.fields.__local_write_time__.timestampValue);return new Ni(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var To=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Io(t)?4:10:ui()}function No(t,e){var n,r=Ao(t);if(r!==Ao(e))return!1;switch(r){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return _o(t).isEqual(_o(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ko(t.timestampValue),r=ko(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return n=e,Ro(t.bytesValue).isEqual(Ro(n.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Lo(t.geoPointValue.latitude)===Lo(e.geoPointValue.latitude)&&Lo(t.geoPointValue.longitude)===Lo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Lo(t.integerValue)===Lo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Lo(t.doubleValue),r=Lo(e.doubleValue);return n===r?Ri(n)===Ri(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return pi(t.arrayValue.values||[],e.arrayValue.values||[],No);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Ei(n)!==Ei(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!No(n[i],r[i])))return!1;return!0}(t,e);default:return ui()}}function So(t,e){return void 0!==(t.values||[]).find((function(t){return No(t,e)}))}function Do(t,e){var n,r,i,o,s=Ao(t),u=Ao(e);if(s!==u)return li(s,u);switch(s){case 0:return 0;case 1:return li(t.booleanValue,e.booleanValue);case 2:return r=e,i=Lo((n=t).integerValue||n.doubleValue),o=Lo(r.integerValue||r.doubleValue),i<o?-1:i>o?1:i===o?0:isNaN(i)?isNaN(o)?0:-1:1;case 3:return Oo(t.timestampValue,e.timestampValue);case 4:return Oo(_o(t),_o(e));case 5:return li(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Ro(t),r=Ro(e);return n.h(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=li(n[i],r[i]);if(0!==o)return o}return li(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=li(Lo(t.latitude),Lo(e.latitude));return 0!==n?n:li(Lo(t.longitude),Lo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Do(n[i],r[i]);if(o)return o}return li(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=li(r[s],o[s]);if(0!==u)return u;var a=Do(n[r[s]],i[o[s]]);if(0!==a)return a}return li(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ui()}}function Oo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return li(t,e);var n=ko(t),r=ko(e),i=li(n.seconds,r.seconds);return 0!==i?i:li(n.nanos,r.nanos)}function xo(t){return Po(t)}function Po(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(e=t.timestampValue,"time("+(n=ko(e)).seconds+","+n.nanos+")"):"stringValue"in t?t.stringValue:"bytesValue"in t?Ro(t.bytesValue).toBase64():"referenceValue"in t?(i=t.referenceValue,ki.J(i).toString()):"geoPointValue"in t?"geo("+(r=t.geoPointValue).latitude+","+r.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Po(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Po(t.fields[o])}return e+"}"}(t.mapValue):ui();var e,n,r,i}function ko(t){if(ai(!!t),"string"==typeof t){var e=0,n=To.exec(t);if(ai(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Lo(t.seconds),nanos:Lo(t.nanos)}}function Lo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ro(t){return"string"==typeof t?vi.fromBase64String(t):vi.fromUint8Array(t)}function Co(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function Vo(t){return!!t&&"integerValue"in t}function Mo(t){return!!t&&"arrayValue"in t}function Uo(t){return!!t&&"nullValue"in t}function jo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fo(t){return!!t&&"mapValue"in t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qo={asc:"ASCENDING",desc:"DESCENDING"},Go={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Bo=function(t,e){this._=t,this.Ke=e};function zo(t){return{integerValue:""+t}}function Ho(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ri(e)?"-0":e}}function Ko(t,e){return Ci(e)?zo(e):Ho(t,e)}function Wo(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Xo(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function Yo(t,e){return Wo(t,e.v())}function Qo(t){return ai(!!t),Si.V((e=ko(t),new Ni(e.seconds,e.nanos)));var e}function Jo(t,e){return(n=t,new Oi(["projects",n.projectId,"databases",n.database])).child("documents").child(e).B();var n}function $o(t){var e=Oi.q(t);return ai(Is(e)),e}function Zo(t,e){return Jo(t._,e.path)}function ts(t,e){var n=$o(e);return ai(n.get(1)===t._.projectId),ai(!n.get(3)&&!t._.database||n.get(3)===t._.database),new ki(is(n))}function es(t,e){return Jo(t._,e)}function ns(t){var e=$o(t);return 4===e.length?Oi.U():is(e)}function rs(t){return new Oi(["projects",t._.projectId,"databases",t._.database]).B()}function is(t){return ai(t.length>4&&"documents"===t.get(4)),t.N(5)}function os(t,e,n){return{name:Zo(t,e),fields:n.proto.mapValue.fields}}function ss(t,e){var n,r,i;if(e instanceof Hs)n={update:os(t,e.key,e.value)};else if(e instanceof Js)n={delete:Zo(t,e.key)};else if(e instanceof Ks)n={update:os(t,e.key,e.data),updateMask:ws(e.Qe)};else if(e instanceof Xs)n={transform:{document:Zo(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Ns)return{fieldPath:e.field.B(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ss)return{fieldPath:e.field.B(),appendMissingElements:{values:n.elements}};if(n instanceof Os)return{fieldPath:e.field.B(),removeAllFromArray:{values:n.elements}};if(n instanceof Ps)return{fieldPath:e.field.B(),increment:n.We};throw ui()}(0,t)}))}};else{if(!(e instanceof $s))return ui();n={verify:Zo(t,e.key)}}return e.Ge.je||(n.currentDocument=(r=t,void 0!==(i=e.Ge).updateTime?{updateTime:Yo(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:ui())),n}function us(t,e){var n,r=e.currentDocument?void 0!==(n=e.currentDocument).updateTime?Ms.updateTime(Qo(n.updateTime)):void 0!==n.exists?Ms.exists(n.exists):Ms.ze():Ms.ze();if(e.update){e.update.name;var i=ts(t,e.update.name),o=new Zs({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Rs(e.map((function(t){return Pi.G(t)})))}(e.updateMask);return new Ks(i,o,s,r)}return new Hs(i,o,r)}if(e.delete){var u=ts(t,e.delete);return new Js(u,r)}if(e.transform){var a=ts(t,e.transform.document),c=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)ai("REQUEST_TIME"===e.setToServerValue),n=new Ns;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Ss(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Os(i)}else"increment"in e?n=new Ps(t,e.increment):ui();var o=Pi.G(e.fieldPath);return new Cs(o,n)}(t,e)}));return ai(!0===r.exists),new Xs(a,c)}if(e.verify){var h=ts(t,e.verify);return new $s(h,r)}return ui()}function as(t,e){return{documents:[es(t,e.path)]}}function cs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=es(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=es(t,r.F()),n.structuredQuery.from=[{collectionId:r.O()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(jo(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NAN"}};if(Uo(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(jo(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NOT_NAN"}};if(Uo(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ys(t.field),op:vs(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return{field:ys((e=t).field),direction:ds(e.dir)};var e}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u,a=(s=t,u=e.limit,s.Ke||Li(u)?u:{value:u});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=ls(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ls(e.endAt)),n}function hs(t){var e=ns(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ai(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=fs(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return new Mu(gs((e=t).field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction));var e})));var a,c,h=null;n.limit&&(a=n.limit,h=Li(c="object"==typeof a?a.value:a)?null:c);var f=null;n.startAt&&(f=ps(n.startAt));var l=null;return n.endAt&&(l=ps(n.endAt)),vu(uu(e,i,u,s,h,"F",f,l))}function fs(t){return t?void 0!==t.unaryFilter?[bs(t)]:void 0!==t.fieldFilter?[ms(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return fs(t)})).reduce((function(t,e){return t.concat(e)})):ui():[]}function ls(t){return{before:t.before,values:t.position}}function ps(t){var e=!!t.before,n=t.values||[];return new Lu(n,e)}function ds(t){return qo[t]}function vs(t){return Go[t]}function ys(t){return{fieldPath:t.B()}}function gs(t){return Pi.G(t.fieldPath)}function ms(t){return Tu.create(gs(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ui()}}(t.fieldFilter.op),t.fieldFilter.value)}function bs(t){switch(t.unaryFilter.op){case"IS_NAN":var e=gs(t.unaryFilter.field);return Tu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=gs(t.unaryFilter.field);return Tu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=gs(t.unaryFilter.field);return Tu.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=gs(t.unaryFilter.field);return Tu.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ui()}}function ws(t){var e=[];return t.fields.forEach((function(t){return e.push(t.B())})),{fieldPaths:e}}function Is(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Es=function(){this.He=void 0};function _s(t,e,n){return t instanceof Ns?(i=e,o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(o.fields.__previous_value__=i),{mapValue:o}):t instanceof Ss?Ds(t,e):t instanceof Os?xs(t,e):function(t,e){var n=As(t,e),r=ks(n)+ks(t.We);return Vo(n)&&Vo(t.We)?zo(r):Ho(t.serializer,r)}(t,e);var r,i,o}function Ts(t,e,n){return t instanceof Ss?Ds(t,e):t instanceof Os?xs(t,e):n}function As(t,e){return t instanceof Ps?Vo(r=e)||(n=r)&&"doubleValue"in n?e:{integerValue:0}:null;var n,r}var Ns=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n}(Es),Ss=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return e(n,t),n}(Es);function Ds(t,e){for(var n=Ls(e),r=function(t){n.some((function(e){return No(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Os=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return e(n,t),n}(Es);function xs(t,e){for(var n=Ls(e),r=function(t){n=n.filter((function(e){return!No(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ps=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.We=n,r}return e(n,t),n}(Es);function ks(t){return Lo(t.integerValue||t.doubleValue)}function Ls(t){return Mo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rs=function(){function t(t){this.fields=t,t.sort(Pi.D)}return t.prototype.Je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},t.prototype.isEqual=function(t){return pi(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Cs=function(t,e){this.field=t,this.transform=e},Vs=function(t,e){this.version=t,this.transformResults=e},Ms=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.ze=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Us(t,e){return void 0!==t.updateTime?e instanceof ru&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ru}var js=function(){};function Fs(t,e,n){return t instanceof Hs?(i=n,new ru((r=t).key,i.version,r.value,{hasCommittedMutations:!0})):t instanceof Ks?function(t,e,n){if(!Us(t.Ge,e))return new ou(t.key,n.version);var r=Ws(t,e);return new ru(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Xs?function(t,e,n){if(ai(null!=n.transformResults),!Us(t.Ge,e))return new ou(t.key,n.version);var r=Ys(t,e),i=function(t,e,n){var r=[];ai(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof ru&&(u=e.field(o.field)),r.push(Ts(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Qs(t,r.data(),i);return new ru(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new iu(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n);var r,i}function qs(t,e,n,r){return t instanceof Hs?function(t,e){if(!Us(t.Ge,e))return e;var n=zs(e);return new ru(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof Ks?function(t,e){if(!Us(t.Ge,e))return e;var n=zs(e),r=Ws(t,e);return new ru(t.key,n,r,{Ye:!0})}(t,e):t instanceof Xs?function(t,e,n,r){if(!Us(t.Ge,e))return e;var i=Ys(t,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof ru&&(c=n.field(u.field)),null===c&&r instanceof ru&&(c=r.field(u.field)),i.push(_s(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=Qs(t,i.data(),o);return new ru(t.key,i.version,s,{Ye:!0})}(t,e,r,n):(o=e,Us((i=t).Ge,o)?new iu(i.key,Si.min()):o);var i,o}function Gs(t,e){return t instanceof Xs?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof ru?e.field(o.field):void 0,u=As(o.transform,s||null);null!=u&&(n=null==n?(new tu).set(o.field,u):n.set(o.field,u))}return n?n.Xe():null}(t,e):null}function Bs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||pi(t.fieldTransforms,t.fieldTransforms,(function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Ss&&o instanceof Ss||i instanceof Os&&o instanceof Os?pi(i.elements,o.elements,No):i instanceof Ps&&o instanceof Ps?No(i.We,o.We):i instanceof Ns&&o instanceof Ns);var n,r,i,o})))}function zs(t){return t instanceof ru?t.version:Si.min()}var Hs=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ge=r,i.type=0,i}return e(n,t),n}(js),Ks=function(t){function n(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Qe=r,o.Ge=i,o.type=1,o}return e(n,t),n}(js);function Ws(t,e){return n=t,r=e instanceof ru?e.data():Zs.empty(),i=new tu(r),n.Qe.fields.forEach((function(t){if(!t.P()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}})),i.Xe();var n,r,i}var Xs=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ge=Ms.exists(!0),r}return e(n,t),n}(js);function Ys(t,e){return e}function Qs(t,e,n){for(var r=new tu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Js=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=3,r}return e(n,t),n}(js),$s=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=4,r}return e(n,t),n}(js),Zs=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Fo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},t.prototype.isEqual=function(t){return No(this.proto,t.proto)},t}(),tu=function(){function t(t){void 0===t&&(t=Zs.empty()),this.Ze=t,this.tn=new Map}return t.prototype.set=function(t,e){return this.en(t,e),this},t.prototype.delete=function(t){return this.en(t,null),this},t.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Ao(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.O(),e)},t.prototype.Xe=function(){var t=this.nn(Pi.U(),this.tn);return null!=t?new Zs(t):this.Ze},t.prototype.nn=function(t,e){var n=this,r=!1,i=this.Ze.field(t),o=Fo(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.nn(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function eu(t){var e=[];return _i(t.fields||{},(function(t,n){var r=new Pi([t]);if(Fo(n)){var i=eu(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new Rs(e)}var nu=function(t,e){this.key=t,this.version=e},ru=function(t){function n(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).sn=r,o.Ye=!!i.Ye,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return e(n,t),n.prototype.field=function(t){return this.sn.field(t)},n.prototype.data=function(){return this.sn},n.prototype.rn=function(){return this.sn.proto},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},n.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),n}(nu),iu=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return e(n,t),n.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(nu),ou=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(nu),su=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.hn=null,this.cn=null,this.startAt,this.endAt};function uu(t,e,n,r,i,o,s,u){return new su(t,e,n,r,i,o,s,u)}function au(t){return new su(t)}function cu(t){return!Li(t.limit)&&"F"===t.an}function hu(t){return!Li(t.limit)&&"L"===t.an}function fu(t){return t.on.length>0?t.on[0].field:null}function lu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function pu(t){return null!==t.collectionGroup}function du(t){var e=ci(t);if(null===e.hn){e.hn=[];var n=lu(e),r=fu(e);if(null!==n&&null===r)n.W()||e.hn.push(new Mu(n)),e.hn.push(new Mu(Pi.j(),"asc"));else{for(var i=!1,o=0,s=e.on;o<s.length;o++){var u=s[o];e.hn.push(u),u.field.W()&&(i=!0)}if(!i){var a=e.on.length>0?e.on[e.on.length-1].dir:"asc";e.hn.push(new Mu(Pi.j(),a))}}}return e.hn}function vu(t){var e=ci(t);if(!e.cn)if("F"===e.an)e.cn=Mi(e.path,e.collectionGroup,du(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=du(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Mu(o.field,s))}var u=e.endAt?new Lu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Lu(e.startAt.position,!e.startAt.before):null;e.cn=Mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.cn}function yu(t,e,n){return new su(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function gu(t,e){return new su(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function mu(t,e){return new su(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function bu(t,e){return ji(vu(t),vu(e))&&t.an===e.an}function wu(t){return Ui(vu(t))+"|lt:"+t.an}function Iu(t){return"Query(target="+(e=vu(t),n=e.path.B(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=", filters: ["+e.filters.map((function(t){return(e=t).field.B()+" "+e.op+" "+xo(e.value);var e})).join(", ")+"]"),Li(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=", orderBy: ["+e.orderBy.map((function(t){return(e=t).field.B()+" ("+e.dir+")";var e})).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ru(e.startAt)),e.endAt&&(n+=", endAt: "+Ru(e.endAt)),"Target("+n+"); limitType=")+t.an+")";var e,n}function Eu(t,e){return n=t,i=(r=e).key.path,(null!==n.collectionGroup?r.key.Y(n.collectionGroup)&&n.path.M(i):ki.X(n.path)?n.path.isEqual(i):n.path.$(i))&&function(t,e){for(var n=0,r=t.on;n<r.length;n++){var i=r[n];if(!i.field.W()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Cu(t.startAt,du(t),e)||t.endAt&&Cu(t.endAt,du(t),e))}(t,e);var n,r,i}function _u(t){return function(e,n){for(var r=!1,i=0,o=du(t);i<o.length;i++){var s=o[i],u=Uu(s,e,n);if(0!==u)return u;r=r||s.field.W()}return 0}}var Tu=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return e(n,t),n.create=function(t,e,r){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,r):new Au(t,e,r):"array-contains"===e?new Ou(t,r):"in"===e?new xu(t,r):"not-in"===e?new Pu(t,r):"array-contains-any"===e?new ku(t,r):new n(t,e,r)},n.ln=function(t,e,n){return"in"===e?new Nu(t,n):new Su(t,n)},n.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this._n(Do(e,this.value)):null!==e&&Ao(this.value)===Ao(e)&&this._n(Do(e,this.value))},n.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ui()}},n.prototype.un=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},n}((function(){})),Au=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ki.J(r.referenceValue),i}return e(n,t),n.prototype.matches=function(t){var e=ki.D(t.key,this.key);return this._n(e)},n}(Tu),Nu=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Du("in",n),r}return e(n,t),n.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Tu),Su=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Du("not-in",n),r}return e(n,t),n.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Tu);function Du(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return ki.J(t.referenceValue)}))}var Ou=function(t){function n(e,n){return t.call(this,e,"array-contains",n)||this}return e(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return Mo(e)&&So(e.arrayValue,this.value)},n}(Tu),xu=function(t){function n(e,n){return t.call(this,e,"in",n)||this}return e(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&So(this.value.arrayValue,e)},n}(Tu),Pu=function(t){function n(e,n){return t.call(this,e,"not-in",n)||this}return e(n,t),n.prototype.matches=function(t){if(So(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!So(this.value.arrayValue,e)},n}(Tu),ku=function(t){function n(e,n){return t.call(this,e,"array-contains-any",n)||this}return e(n,t),n.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Mo(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return So(e.value.arrayValue,t)}))},n}(Tu),Lu=function(t,e){this.position=t,this.before=e};function Ru(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return xo(t)})).join(",")}function Cu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.W()?ki.D(ki.J(s.referenceValue),n.key):Do(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Vu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!No(t.position[n],e.position[n]))return!1;return!0}var Mu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Uu(t,e,n){var r,i,o,s,u=t.field.W()?ki.D(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?Do(o,s):ui());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return ui()}}function ju(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fu=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},qu=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}return t.prototype.reset=function(){this.In=0},t.prototype.Rn=function(){this.In=this.Tn},t.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);i>0&&ri("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.Vn(this.dn,i,(function(){return e.An=Date.now(),t()})),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},t.prototype.yn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},t.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},t.prototype.gn=function(){return(Math.random()-.5)*this.In},t}(),Gu=function(){function t(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t((function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)}),(function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Dn&&ui(),this.Dn=!0,this.Sn?this.error?this.Cn(n,this.error):this.Nn(e,this.result):new t((function(t,i){r.bn=function(n){r.Nn(e,n).next(t,i)},r.vn=function(e){r.Cn(n,e).next(t,i)}}))},t.prototype.xn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Fn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.Nn=function(e,n){return e?this.Fn((function(){return e(n)})):t.resolve(n)},t.prototype.Cn=function(e,n){return e?this.Fn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.kn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.On=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.kn(r)},t}(),Bu=function(){function t(e,n,r){this.name=e,this.version=n,this.Mn=r,12.2===t.$n(f())&&ii("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return ri("SimpleDb","Removing database:",t),Yu(window.indexedDB.deleteDatabase(t)).xn()},t.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(t.Bn())return!0;var e=f(),n=t.$n(e),r=0<n&&n<10,i=t.qn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},t.Kn=function(t,e){return t.store(e)},t.$n=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.qn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Qn=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(ri("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Hu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new ti(Zr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Hu(t,n))},i.onupgradeneeded=function(t){ri("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Mn.createOrUpgrade(e,i.transaction,t.oldVersion,n.version).next((function(){ri("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return n.Wn(t)}),this.db)]}}))}))},t.prototype.jn=function(t){this.Wn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,u,a,c;return i(this,(function(h){switch(h.label){case 0:r="readonly"===e,s=0,u=function(){var e,u,c,h,f;return i(this,(function(i){switch(i.label){case 0:++s,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,a.Qn(t)];case 2:return a.db=i.sent(),e=Wu.open(a.db,t,r?"readonly":"readwrite",n),u=o(e).catch((function(t){return e.abort(t),Gu.reject(t)})).xn(),c={},u.catch((function(){})),[4,e.Gn];case 3:return[2,(c.value=(i.sent(),u),c)];case 4:return h=i.sent(),f="FirebaseError"!==h.name&&s<3,ri("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),a.close(),f?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},a=this,h.label=1;case 1:return[5,u()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),zu=function(){function t(t){this.zn=t,this.Hn=!1,this.Jn=null}return Object.defineProperty(t.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Yn",{get:function(){return this.Jn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Hn=!0},t.prototype.Xn=function(t){this.Jn=t},t.prototype.delete=function(){return Yu(this.zn.delete())},t}(),Hu=function(t){function n(e,n){var r=this;return(r=t.call(this,Zr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return e(n,t),n}(ti);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ku(t){return"IndexedDbTransactionError"===t.name}var Wu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Zn=new Fu,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){e.error?n.Zn.reject(new Hu(t,e.error)):n.Zn.resolve()},this.transaction.onerror=function(e){var r=Ju(e.target.error);n.Zn.reject(new Hu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(o){throw new Hu(n,o)}},Object.defineProperty(t.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(ri("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Xu(e)},t}(),Xu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(ri("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(ri("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Yu(n)},t.prototype.add=function(t){return ri("SimpleDb","ADD",this.store.name,t,t),Yu(this.store.add(t))},t.prototype.get=function(t){var e=this;return Yu(this.store.get(t)).next((function(n){return void 0===n&&(n=null),ri("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return ri("SimpleDb","DELETE",this.store.name,t),Yu(this.store.delete(t))},t.prototype.count=function(){return ri("SimpleDb","COUNT",this.store.name),Yu(this.store.count())},t.prototype.ts=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.es(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.ns=function(t,e){ri("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ss=!1;var r=this.cursor(n);return this.es(r,(function(t,e,n){return n.delete()}))},t.prototype.rs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.es(r,e)},t.prototype.os=function(t){var e=this.cursor({});return new Gu((function(n,r){e.onerror=function(t){var e=Ju(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.es=function(t,e){var n=[];return new Gu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new zu(i),s=e(i.primaryKey,i.value,o);if(s instanceof Gu){var u=s.catch((function(t){return o.done(),Gu.reject(t)}));n.push(u)}o.Sn?r():null===o.Yn?i.continue():i.continue(o.Yn)}else r()}})).next((function(){return Gu.kn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Yu(t){return new Gu((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Ju(t.target.error);n(e)}}))}var Qu=!1;function Ju(t){var e=Bu.$n(f());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new ti("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Qu||(Qu=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $u(){return"undefined"!=typeof window?window:null}function Zu(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ta=function(){function t(t,e,n,r,i){this.hs=t,this.dn=e,this.cs=n,this.op=r,this.us=i,this.ls=new Fu,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch((function(t){}))}return t._s=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.fs=setTimeout((function(){return e.ds()}),t)},t.prototype.pn=function(){return this.ds()},t.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new ti(Zr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.ds=function(){var t=this;this.hs.ws((function(){return null!==t.fs?(t.clearTimeout(),t.op().then((function(e){return t.ls.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.fs&&(this.us(this),clearTimeout(this.fs),this.fs=null)},t}(),ea=function(){function t(){var t=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.Vs=new qu(this,"async_queue_retry"),this.ys=function(){var e=Zu();e&&ri("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.Vs.yn()};var e=Zu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.ys)}return Object.defineProperty(t.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),t.prototype.ws=function(t){this.enqueue(t)},t.prototype.bs=function(t){this.vs(),this.Ss(t)},t.prototype.Ds=function(){if(!this.Is){this.Is=!0;var t=Zu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys)}},t.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise((function(t){})):this.Ss(t)},t.prototype.Cs=function(t){var e=this;this.ws((function(){return e.Ts.push(t),e.Ns()}))},t.prototype.Ns=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:if(0===this.Ts.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return n.sent(),this.Ts.shift(),this.Vs.reset(),[3,4];case 3:if(!Ku(t=n.sent()))throw t;return ri("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Ts.length>0&&this.Vs.Pn((function(){return e.Ns()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ss=function(t){var e=this,n=this.Es.then((function(){return e.Ps=!0,t().catch((function(t){throw e.Rs=t,e.Ps=!1,ii("INTERNAL UNHANDLED ERROR: ",(r=(n=t).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),t;var n,r})).then((function(t){return e.Ps=!1,t}))}));return this.Es=n,n},t.prototype.Vn=function(t,e,n){var r=this;this.vs(),this.gs.indexOf(t)>-1&&(e=0);var i=ta._s(this,t,e,n,(function(t){return r.xs(t)}));return this.As.push(i),i},t.prototype.vs=function(){this.Rs&&ui()},t.prototype.Fs=function(){},t.prototype.ks=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,t=this.Es];case 1:e.sent(),e.label=2;case 2:if(t!==this.Es)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Os=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},t.prototype.Ms=function(t){var e=this;return this.ks().then((function(){e.As.sort((function(t,e){return t.cs-e.cs}));for(var n=0,r=e.As;n<r.length;n++){var i=r[n];if(i.pn(),"all"!==t&&i.dn===t)break}return e.ks()}))},t.prototype.$s=function(t){this.gs.push(t)},t.prototype.xs=function(t){var e=this.As.indexOf(t);this.As.splice(e,1)},t}();function na(t,e){if(ii("AsyncQueue",e+": "+t),Ku(t))return new ti(Zr.UNAVAILABLE,e+": "+t);throw t}var ra=function(){this.Ls=void 0,this.listeners=[]},ia=function(){this.Bs=new Ai((function(t){return wu(t)}),bu),this.onlineState="Unknown",this.qs=new Set};function oa(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a,c;return i(this,(function(i){switch(i.label){case 0:if(n=ci(t),r=e.query,o=!1,(s=n.Bs.get(r))||(o=!0,s=new ra),!o)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),u=s,[4,n.Us(r)];case 2:return u.Ls=i.sent(),[3,4];case 3:return a=i.sent(),c=na(a,"Initialization of query '"+Iu(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.Bs.set(r,s),s.listeners.push(e),e.Ks(n.onlineState),s.Ls&&e.Qs(s.Ls)&&ca(n),[2]}}))}))}function sa(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u;return i(this,(function(i){return n=ci(t),r=e.query,o=!1,(s=n.Bs.get(r))&&(u=s.listeners.indexOf(e))>=0&&(s.listeners.splice(u,1),o=0===s.listeners.length),o?[2,(n.Bs.delete(r),n.Ws(r))]:[2]}))}))}function ua(t,e){for(var n=ci(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.Bs.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Qs(s)&&(r=!0);a.Ls=s}}r&&ca(n)}function aa(t,e,n){var r=ci(t),i=r.Bs.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.Bs.delete(e)}function ca(t){t.qs.forEach((function(t){t.next()}))}var ha=function(){function t(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ho(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Js(t,this.onlineState)&&(this.Ys(t),o=!0),this.zs=t,o},t.prototype.onError=function(t){this.js.error(t)},t.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Js(this.zs,t)&&(this.Ys(this.zs),e=!0),e},t.prototype.Js=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.P()&&"Offline"!==e)},t.prototype.Hs=function(t){if(t.docChanges.length>0)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Ys=function(t){t=ho.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},t}(),fa=function(){function t(t){this.uid=t}return t.prototype.Zs=function(){return null!=this.uid},t.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fa.UNAUTHENTICATED=new fa(null),fa.ei=new fa("google-credentials-uid"),fa.ni=new fa("first-party-uid");
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var la=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}return t.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},t}();function pa(t,e){return"firestore_clients_"+t+"_"+e}function da(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Zs()&&(r+="_"+e.uid),r}function va(t,e){return"firestore_targets_"+t+"_"+e}la.ai=-1;var ya=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.hi=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new ti(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(ii("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ga=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.hi=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new ti(r.error.code,r.error.message)),i?new t(e,r.state,o):(ii("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ma=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.hi=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=uo(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ci(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(ii("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),ba=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.hi=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(ii("SharedClientState","Failed to parse online state: "+e),null)},t}(),wa=function(){function t(){this.activeTargetIds=uo()}return t.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ia=function(){function t(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.Ei.bind(this),this.Ti=new Wi(li),this.Ii=!1,this.mi=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ai=pa(this.persistenceKey,this._i),this.Ri="firestore_sequence_number_"+this.persistenceKey,this.Ti=this.Ti.ot(this._i,new wa),this.Pi=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.gi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Vi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.yi=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wi)}return t.Ln=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,o,s,u,a,c,h,f,l=this;return i(this,(function(i){switch(i.label){case 0:return[4,this.fi.pi()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._i&&(o=this.getItem(pa(this.persistenceKey,r)))&&(s=ma.hi(r,o))&&(this.Ti=this.Ti.ot(s.clientId,s));for(this.bi(),(u=this.storage.getItem(this.yi))&&(a=this.vi(u))&&this.Si(a),c=0,h=this.mi;c<h.length;c++)f=h[c],this.Ei(f);return this.mi=[],this.window.addEventListener("unload",(function(){return l.Di()})),this.Ii=!0,[2]}}))}))},t.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},t.prototype.Ci=function(){return this.Ni(this.Ti)},t.prototype.xi=function(t){var e=!1;return this.Ti.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Fi=function(t){this.ki(t,"pending")},t.prototype.Oi=function(t,e,n){this.ki(t,e,n),this.Mi(t)},t.prototype.$i=function(t){var e="not-current";if(this.xi(t)){var n=this.storage.getItem(va(this.persistenceKey,t));if(n){var r=ga.hi(t,n);r&&(e=r.state)}}return this.Li.ui(t),this.bi(),e},t.prototype.Bi=function(t){this.Li.li(t),this.bi()},t.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},t.prototype.Ui=function(t){this.removeItem(va(this.persistenceKey,t))},t.prototype.Ki=function(t,e,n){this.Qi(t,e,n)},t.prototype.Wi=function(t,e,n){var r=this;e.forEach((function(t){r.Mi(t)})),this.currentUser=t,n.forEach((function(t){r.Fi(t)}))},t.prototype.ji=function(t){this.Gi(t)},t.prototype.Di=function(){this.Ii&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ii=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return ri("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){ri("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){ri("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ei=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(ri("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ai)return void ii("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs((function(){return r(e,void 0,void 0,(function(){var t,e,r,o,s,u;return i(this,(function(i){if(this.Ii){if(null!==n.key)if(this.Pi.test(n.key)){if(null==n.newValue)return t=this.zi(n.key),[2,this.Hi(t,null)];if(e=this.Ji(n.key,n.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.gi.test(n.key)){if(null!==n.newValue&&(r=this.Yi(n.key,n.newValue)))return[2,this.Xi(r)]}else if(this.Vi.test(n.key)){if(null!==n.newValue&&(o=this.Zi(n.key,n.newValue)))return[2,this.tr(o)]}else if(n.key===this.yi){if(null!==n.newValue&&(s=this.vi(n.newValue)))return[2,this.Si(s)]}else n.key===this.Ri&&(u=function(t){var e=la.ai;if(null!=t)try{var n=JSON.parse(t);ai("number"==typeof n),e=n}catch(r){ii("SharedClientState","Failed to read sequence number from WebStorage",r)}return e}(n.newValue))!==la.ai&&this.si(u)}else this.mi.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),t.prototype.bi=function(){this.setItem(this.Ai,this.Li.ci())},t.prototype.ki=function(t,e,n){var r=new ya(this.currentUser,t,e,n),i=da(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ci())},t.prototype.Mi=function(t){var e=da(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Gi=function(t){var e={clientId:this._i,onlineState:t};this.storage.setItem(this.yi,JSON.stringify(e))},t.prototype.Qi=function(t,e,n){var r=va(this.persistenceKey,t),i=new ga(t,e,n);this.setItem(r,i.ci())},t.prototype.zi=function(t){var e=this.Pi.exec(t);return e?e[1]:null},t.prototype.Ji=function(t,e){var n=this.zi(t);return ma.hi(n,e)},t.prototype.Yi=function(t,e){var n=this.gi.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return ya.hi(new fa(i),r,e)},t.prototype.Zi=function(t,e){var n=this.Vi.exec(t),r=Number(n[1]);return ga.hi(r,e)},t.prototype.vi=function(t){return ba.hi(t)},t.prototype.Xi=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.fi.er(t.batchId,t.state,t.error)]:(ri("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},t.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.fi.sr(s,u).then((function(){n.Ti=r}))},t.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},t.prototype.Ni=function(t){var e=uo();return t.forEach((function(t,n){e=e.Ot(n.activeTargetIds)})),e},t}(),Ea=function(){function t(){this.ir=new wa,this.rr={},this.di=null,this.si=null}return t.prototype.Fi=function(t){},t.prototype.Oi=function(t,e,n){},t.prototype.$i=function(t){return this.ir.ui(t),this.rr[t]||"not-current"},t.prototype.Ki=function(t,e,n){this.rr[t]=e},t.prototype.Bi=function(t){this.ir.li(t)},t.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.Ui=function(t){delete this.rr[t]},t.prototype.Ci=function(){return this.ir.activeTargetIds},t.prototype.xi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.start=function(){return this.ir=new wa,Promise.resolve()},t.prototype.Wi=function(t,e,n){},t.prototype.ji=function(t){},t.prototype.Di=function(){},t.prototype.oi=function(t){},t}(),_a=function(){function t(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}return t.prototype.hr=function(t,e,n){for(var r=n.cr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Fs(o,e,r[i]))}return e},t.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=qs(i,e,e,this.ar))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=qs(a,e,o,this.ar))}return e},t.prototype.lr=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ur(r.key,t.get(r.key));i&&(n=n.ot(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),oo())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&pi(this.mutations,t.mutations,(function(t,e){return Bs(t,e)}))&&pi(this.baseMutations,t.baseMutations,(function(t,e){return Bs(t,e)}))},t}(),Ta=function(){function t(t,e,n,r){this.batch=t,this._r=e,this.cr=n,this.dr=r}return t.from=function(e,n,r){ai(e.mutations.length===r.length);for(var i=ro,o=e.mutations,s=0;s<o.length;s++)i=i.ot(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Aa=function(){function t(){this.wr=new Ai((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.Er=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),t.prototype.Ir=function(t,e){this.mr(),this.readTime=e,this.wr.set(t.key,t)},t.prototype.Ar=function(t,e){this.mr(),e&&(this.readTime=e),this.wr.set(t,null)},t.prototype.Rr=function(t,e){this.mr();var n=this.wr.get(e);return void 0!==n?Gu.resolve(n):this.Pr(t,e)},t.prototype.getEntries=function(t,e){return this.gr(t,e)},t.prototype.apply=function(t){return this.mr(),this.Er=!0,this.Vr(t)},t.prototype.mr=function(){},t}(),Na="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Sa=function(){function t(){this.yr=[]}return t.prototype.pr=function(t){this.yr.push(t)},t.prototype.br=function(){this.yr.forEach((function(t){return t()}))},t}(),Da=function(){function t(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}return t.prototype.Cr=function(t,e){var n=this;return this.Sr.Nr(t,e).next((function(r){return n.Fr(t,e,r)}))},t.prototype.Fr=function(t,e,n){return this.vr.Rr(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ur(e,t);return t}))},t.prototype.kr=function(t,e,n){var r=to();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ur(t,e);r=r.ot(t,e)})),r},t.prototype.Or=function(t,e){var n=this;return this.vr.getEntries(t,e).next((function(e){return n.Mr(t,e)}))},t.prototype.Mr=function(t,e){var n=this;return this.Sr.$r(t,e).next((function(r){var i=n.kr(t,e,r),o=Zi();return i.forEach((function(t,e){e||(e=new iu(t,Si.min())),o=o.ot(t,e)})),o}))},t.prototype.Lr=function(t,e,n){return r=e,ki.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Br(t,e.path):pu(e)?this.qr(t,e,n):this.Ur(t,e,n);var r},t.prototype.Br=function(t,e){return this.Cr(t,new ki(e)).next((function(t){var e=no();return t instanceof ru&&(e=e.ot(t.key,t)),e}))},t.prototype.qr=function(t,e,n){var r=this,i=e.collectionGroup,o=no();return this.Dr.Kr(t,i).next((function(s){return Gu.forEach(s,(function(s){var u,a,c=(u=e,a=s.child(i),new su(a,null,u.on.slice(),u.filters.slice(),u.limit,u.an,u.startAt,u.endAt));return r.Ur(t,c,n).next((function(t){t.forEach((function(t,e){o=o.ot(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Ur=function(t,e,n){var r,i,o=this;return this.vr.Lr(t,e,n).next((function(n){return r=n,o.Sr.Qr(t,e)})).next((function(e){return i=e,o.Wr(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=qs(a,h,h,o.ar);r=f instanceof ru?r.ot(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Eu(e,n)||(r=r.remove(t))})),r}))},t.prototype.Wr=function(t,e,n){for(var r=oo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ks&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.vr.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof ru&&(c=c.ot(t,e))})),c}))},t}(),Oa=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Gr=r}return t.zr=function(e,n){for(var r=oo(),i=oo(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}();
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xa(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=li(n,i);return 0===s?li(r,o):s}var Pa=function(){function t(t){this.Hr=t,this.buffer=new Qi(xa),this.Jr=0}return t.prototype.Yr=function(){return++this.Jr},t.prototype.Xr=function(t){var e=[t,this.Yr()];if(this.buffer.size<this.Hr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();xa(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ka={Zr:!1,eo:0,no:0,so:0},La=function(){function t(t,e,n){this.io=t,this.ro=e,this.oo=n}return t.ao=function(e){return new t(e,t.ho,t.co)},t}();La.uo=-1,La.lo=1048576,La._o=41943040,La.ho=10,La.co=1e3,La.fo=new La(La._o,La.ho,La.co),La.do=new La(La.uo,0,0);var Ra=function(){function t(t,e){this.wo=t,this.hs=e,this.Eo=!1,this.To=null}return t.prototype.start=function(t){this.wo.params.io!==La.uo&&this.Io(t)},t.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(t.prototype,"Ii",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),t.prototype.Io=function(t){var e=this,n=this.Eo?3e5:6e4;ri("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.To=this.hs.Vn("lru_garbage_collection",n,(function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:this.To=null,this.Eo=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mo(this.wo)];case 2:return n.sent(),[3,7];case 3:return Ku(e=n.sent())?(ri("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Zc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Io(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Ca=function(){function t(t,e){this.Ao=t,this.params=e}return t.prototype.Ro=function(t,e){return this.Ao.Po(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Vo=function(t,e){var n=this;if(0===e)return Gu.resolve(la.ai);var r=new Pa(e);return this.Ao.Ce(t,(function(t){return r.Xr(t.sequenceNumber)})).next((function(){return n.Ao.yo(t,(function(t){return r.Xr(t)}))})).next((function(){return r.maxValue}))},t.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},t.prototype.bo=function(t,e){return this.Ao.bo(t,e)},t.prototype.vo=function(t,e){var n=this;return this.params.io===La.uo?(ri("LruGarbageCollector","Garbage collection skipped; disabled"),Gu.resolve(ka)):this.So(t).next((function(r){return r<n.params.io?(ri("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.io),ka):n.Do(t,e)}))},t.prototype.So=function(t){return this.Ao.So(t)},t.prototype.Do=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Ro(t,this.params.ro).next((function(e){return e>c.params.oo?(ri("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.oo+" from "+e),r=c.params.oo):r=e,o=Date.now(),c.Vo(t,r)})).next((function(r){return n=r,s=Date.now(),c.po(t,n,e)})).next((function(e){return i=e,u=Date.now(),c.bo(t,n)})).next((function(t){return a=Date.now(),ni()<=N.DEBUG&&ri("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),Gu.resolve({Zr:!0,eo:r,no:i,so:t})}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ua(e)),e=Ma(t.get(n),e);return Ua(e)}function Ma(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Ua(t){return t+""}function ja(t){var e=t.length;if(ai(e>=2),2===e)return ai(""===t.charAt(0)&&""===t.charAt(1)),Oi.U();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&ui(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:ui()}o=s+2}return new Oi(r)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fa=function(t){this.Co=t};function qa(t,e){if(e.document)return n=t.Co,r=e.document,i=!!e.hasCommittedMutations,o=ts(n,r.name),s=Qo(r.updateTime),u=new Zs({mapValue:{fields:r.fields}}),new ru(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ki.Z(e.noDocument.path),c=Ka(e.noDocument.readTime);return new iu(a,c,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var h=ki.Z(e.unknownDocument.path),f=Ka(e.unknownDocument.version);return new ou(h,f)}return ui()}function Ga(t,e,n){var r,i,o=Ba(n),s=e.key.path.F().L();if(e instanceof ru){var u={name:Zo(r=t.Co,(i=e).key),fields:i.rn().mapValue.fields,updateTime:Wo(r,i.version.v())},a=e.hasCommittedMutations;return new mc(null,null,u,a,o,s)}if(e instanceof iu){var c=e.key.path.L(),h=Ha(e.version),f=e.hasCommittedMutations;return new mc(null,new yc(c,h),null,f,o,s)}if(e instanceof ou){var l=e.key.path.L(),p=Ha(e.version);return new mc(new gc(l,p),null,null,!0,o,s)}return ui()}function Ba(t){var e=t.v();return[e.seconds,e.nanoseconds]}function za(t){var e=new Ni(t[0],t[1]);return Si.V(e)}function Ha(t){var e=t.v();return new fc(e.seconds,e.nanoseconds)}function Ka(t){var e=new Ni(t.seconds,t.nanoseconds);return Si.V(e)}function Wa(t,e){var n=(e.baseMutations||[]).map((function(e){return us(t.Co,e)})),r=e.mutations.map((function(e){return us(t.Co,e)})),i=Ni.fromMillis(e.localWriteTimeMs);return new _a(e.batchId,i,n,r)}function Xa(t){var e,n,r=Ka(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ka(t.lastLimboFreeSnapshotVersion):Si.min();return void 0!==t.query.documents?(ai(1===(n=t.query).documents.length),e=vu(au(ns(n.documents[0])))):e=hs(t.query),new Bi(e,t.targetId,0,t.lastListenSequenceNumber,r,i,vi.fromBase64String(t.resumeToken))}function Ya(t,e){var n,r=Ha(e.nt),i=Ha(e.lastLimboFreeSnapshotVersion);n=Fi(e.target)?as(t.Co,e.target):cs(t.Co,e.target);var o=e.resumeToken.toBase64();return new wc(e.targetId,Ui(e.target),r,o,e.sequenceNumber,i,n)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qa=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.xo={}}return t.Fo=function(e,n,r,i){return ai(""!==e.uid),new t(e.Zs()?e.uid:"",n,r,i)},t.prototype.ko=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Za(t).rs({index:dc.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Oo=function(t,e,n,r){var i=this,o=tc(t),s=Za(t);return s.add({}).next((function(u){ai("number"==typeof u);for(var a=new _a(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return ss(t.Co,e)})),i=n.mutations.map((function(e){return ss(t.Co,e)}));return new dc(e,n.batchId,n.ar.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new Qi((function(t,e){return li(t.B(),e.B())})),l=0,p=r;l<p.length;l++){var d=p[l],v=vc.key(i.userId,d.key.path,u);f=f.add(d.key.path.F()),h.push(s.put(c)),h.push(o.put(v,vc.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Dr.Mo(t,e))})),t.pr((function(){i.xo[u]=a.keys()})),Gu.kn(h).next((function(){return a}))}))},t.prototype.$o=function(t,e){var n=this;return Za(t).get(e).next((function(t){return t?(ai(t.userId===n.userId),Wa(n.serializer,t)):null}))},t.prototype.Lo=function(t,e){var n=this;return this.xo[e]?Gu.resolve(this.xo[e]):this.$o(t,e).next((function(t){if(t){var r=t.keys();return n.xo[e]=r,r}return null}))},t.prototype.Bo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Za(t).rs({index:dc.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(ai(e.batchId>=r),o=Wa(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Za(t).rs({index:dc.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Za(t).ts(dc.userMutationsIndex,n).next((function(t){return t.map((function(t){return Wa(e.serializer,t)}))}))},t.prototype.Nr=function(t,e){var n=this,r=vc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return tc(t).rs({range:i},(function(r,i,s){var u=r[0],a=r[1],c=r[2],h=ja(a);if(u===n.userId&&e.path.isEqual(h))return Za(t).get(c).next((function(t){if(!t)throw ui();ai(t.userId===n.userId),o.push(Wa(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.$r=function(t,e){var n=this,r=new Qi(li),i=[];return e.forEach((function(e){var o=vc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=tc(t).rs({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],c=ja(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),Gu.kn(i).next((function(){return n.Ko(t,r)}))},t.prototype.Qr=function(t,e){var n=this,r=e.path,i=r.length+1,o=vc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Qi(li);return tc(t).rs({range:s},(function(t,e,o){var s=t[0],a=t[1],c=t[2],h=ja(a);s===n.userId&&r.M(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.Ko(t,u)}))},t.prototype.Ko=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Za(t).get(e).next((function(t){if(null===t)throw ui();ai(t.userId===n.userId),r.push(Wa(n.serializer,t))})))})),Gu.kn(i).next((function(){return r}))},t.prototype.Qo=function(t,e){var n=this;return $a(t.Wo,this.userId,e).next((function(r){return t.pr((function(){n.jo(e.batchId)})),Gu.forEach(r,(function(e){return n.No.Go(t,e)}))}))},t.prototype.jo=function(t){delete this.xo[t]},t.prototype.zo=function(t){var e=this;return this.ko(t).next((function(n){if(!n)return Gu.resolve();var r=IDBKeyRange.lowerBound(vc.prefixForUser(e.userId)),i=[];return tc(t).rs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ja(t[1]);i.push(o)}else r.done()})).next((function(){ai(0===i.length)}))}))},t.prototype.Ho=function(t,e){return Ja(t,this.userId,e)},t.prototype.Jo=function(t){var e=this;return ec(t).get(this.userId).next((function(t){return t||new pc(e.userId,-1,"")}))},t}();function Ja(t,e,n){var r=vc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return tc(t).rs({range:o,ss:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function $a(t,e,n){var r=t.store(dc.store),i=t.store(vc.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.rs({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){ai(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=vc.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Gu.kn(o).next((function(){return c}))}function Za(t){return Vc.Kn(t,dc.store)}function tc(t){return Vc.Kn(t,vc.store)}function ec(t){return Vc.Kn(t,pc.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nc=function(){function t(t,e){this.serializer=t,this.Dr=e}return t.prototype.Ir=function(t,e,n){return oc(t).put(sc(e),n)},t.prototype.Ar=function(t,e){var n=oc(t),r=sc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Yo(t,r)}))},t.prototype.Rr=function(t,e){var n=this;return oc(t).get(sc(e)).next((function(t){return n.Xo(t)}))},t.prototype.Zo=function(t,e){var n=this;return oc(t).get(sc(e)).next((function(t){var e=n.Xo(t);return e?{ta:e,size:uc(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=to();return this.ea(t,e,(function(t,e){var i=n.Xo(e);r=r.ot(t,i)})).next((function(){return r}))},t.prototype.na=function(t,e){var n=this,r=to(),i=new Wi(ki.D);return this.ea(t,e,(function(t,e){var o=n.Xo(e);o?(r=r.ot(t,o),i=i.ot(t,uc(e))):(r=r.ot(t,null),i=i.ot(t,0))})).next((function(){return{sa:r,ia:i}}))},t.prototype.ea=function(t,e,n){if(e.P())return Gu.resolve();var r=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),i=e._t(),o=i.It();return oc(t).rs({range:r},(function(t,e,r){for(var s=ki.Z(t);o&&ki.D(o,s)<0;)n(o,null),o=i.It();o&&o.isEqual(s)&&(n(o,e),o=i.At()?i.It():null),o?r.Xn(o.path.L()):r.done()})).next((function(){for(;o;)n(o,null),o=i.At()?i.It():null}))},t.prototype.Lr=function(t,e,n){var r=this,i=no(),o=e.path.length+1,s={};if(n.isEqual(Si.min())){var u=e.path.L();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.L(),c=Ba(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=mc.collectionReadTimeIndex}return oc(t).rs(s,(function(t,n,s){if(t.length===o){var u=qa(r.serializer,n);e.path.M(u.key.path)?u instanceof ru&&Eu(e,u)&&(i=i.ot(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.ra=function(t){return new rc(this,!!t&&t.oa)},t.prototype.aa=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ic(t).get(bc.key).next((function(t){return ai(!!t),t}))},t.prototype.Yo=function(t,e){return ic(t).put(bc.key,e)},t.prototype.Xo=function(t){if(t){var e=qa(this.serializer,t);return e instanceof iu&&e.version.isEqual(Si.min())?null:e}return null},t}(),rc=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).ha=e,r.oa=n,r.ca=new Ai((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return e(n,t),n.prototype.Vr=function(t){var e=this,n=[],r=0,i=new Qi((function(t,e){return li(t.B(),e.B())}));return this.wr.forEach((function(o,s){var u=e.ca.get(o);if(s){var a=Ga(e.ha.serializer,s,e.readTime);i=i.add(o.path.F());var c=uc(a);r+=c-u,n.push(e.ha.Ir(t,o,a))}else if(r-=u,e.oa){var h=Ga(e.ha.serializer,new iu(o,Si.min()),e.readTime);n.push(e.ha.Ir(t,o,h))}else n.push(e.ha.Ar(t,o))})),i.forEach((function(r){n.push(e.ha.Dr.Mo(t,r))})),n.push(this.ha.updateMetadata(t,r)),Gu.kn(n)},n.prototype.Pr=function(t,e){var n=this;return this.ha.Zo(t,e).next((function(t){return null===t?(n.ca.set(e,0),null):(n.ca.set(e,t.size),t.ta)}))},n.prototype.gr=function(t,e){var n=this;return this.ha.na(t,e).next((function(t){var e=t.sa;return t.ia.forEach((function(t,e){n.ca.set(t,e)})),e}))},n}(Aa);function ic(t){return Vc.Kn(t,bc.store)}function oc(t){return Vc.Kn(t,mc.store)}function sc(t){return t.path.L()}function uc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ui();e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ac=function(){function t(){this.ua=new cc}return t.prototype.Mo=function(t,e){return this.ua.add(e),Gu.resolve()},t.prototype.Kr=function(t,e){return Gu.resolve(this.ua.getEntries(e))},t}(),cc=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.O(),n=t.F(),r=this.index[e]||new Qi(Oi.D),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.O(),n=t.F(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Qi(Oi.D)).L()},t}(),hc=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;ai(n<r&&n>=0&&r<=10);var o=new Wu("createOrUpgrade",e);n<1&&r>=1&&(t.createObjectStore(lc.store),function(t){t.createObjectStore(pc.store,{keyPath:pc.keyPath}),t.createObjectStore(dc.store,{keyPath:dc.keyPath,autoIncrement:!0}).createIndex(dc.userMutationsIndex,dc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(vc.store)}(t),Tc(t),function(t){t.createObjectStore(mc.store)}(t));var s=Gu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ic.store),t.deleteObjectStore(wc.store),t.deleteObjectStore(Ec.store)}(t),Tc(t)),s=s.next((function(){return function(t){var e=t.store(Ec.store),n=new Ec(0,0,Si.min().v(),0);return e.put(Ec.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(dc.store).ts().next((function(n){t.deleteObjectStore(dc.store),t.createObjectStore(dc.store,{keyPath:dc.keyPath,autoIncrement:!0}).createIndex(dc.userMutationsIndex,dc.userMutationsKeyPath,{unique:!0});var r=e.store(dc.store),i=n.map((function(t){return r.put(t)}));return Gu.kn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Ac.store,{keyPath:Ac.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(bc.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(mc.store);e.createIndex(mc.readTimeIndex,mc.readTimeIndexPath,{unique:!1}),e.createIndex(mc.collectionReadTimeIndex,mc.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(mc.store).rs((function(t,n){e+=uc(n)})).next((function(){var n=new bc(e);return t.store(bc.store).put(bc.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(pc.store),r=t.store(dc.store);return n.ts().next((function(n){return Gu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ts(dc.userMutationsIndex,i).next((function(r){return Gu.forEach(r,(function(r){ai(r.userId===n.userId);var i=Wa(e.serializer,r);return $a(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Ic.store),n=t.store(mc.store);return t.store(Ec.store).get(Ec.key).next((function(t){var r=[];return n.rs((function(n,i){var o=new Oi(n),s=[0,Va(o)];r.push(e.get(s).next((function(n){return n?Gu.resolve():(r=o,e.put(new Ic(0,Va(r),t.highestListenSequenceNumber)));var r})))})).next((function(){return Gu.kn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(_c.store,{keyPath:_c.keyPath});var n=e.store(_c.store),r=new cc,i=function(t){if(r.add(t)){var e=t.O(),i=t.F();return n.put({collectionId:e,parent:Va(i)})}};return e.store(mc.store).rs({ss:!0},(function(t,e){var n=new Oi(t);return i(n.F())})).next((function(){return e.store(vc.store).rs({ss:!0},(function(t,e){t[0];var n=t[1],r=(t[2],ja(n));return i(r.F())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(wc.store);return n.rs((function(t,r){var i=Xa(r),o=Ya(e.serializer,i);return n.put(o)}))},t}(),fc=function(t,e){this.seconds=t,this.nanoseconds=e},lc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};lc.store="owner",lc.key="owner";var pc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};pc.store="mutationQueues",pc.keyPath="userId";var dc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};dc.store="mutations",dc.keyPath="batchId",dc.userMutationsIndex="userMutationsIndex",dc.userMutationsKeyPath=["userId","batchId"];var vc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Va(e)]},t.key=function(t,e,n){return[t,Va(e),n]},t}();vc.store="documentMutations",vc.PLACEHOLDER=new vc;var yc=function(t,e){this.path=t,this.readTime=e},gc=function(t,e){this.path=t,this.version=e},mc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};mc.store="remoteDocuments",mc.readTimeIndex="readTimeIndex",mc.readTimeIndexPath="readTime",mc.collectionReadTimeIndex="collectionReadTimeIndex",mc.collectionReadTimeIndexPath=["parentPath","readTime"];var bc=function(t){this.byteSize=t};bc.store="remoteDocumentGlobal",bc.key="remoteDocumentGlobalKey";var wc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};wc.store="targets",wc.keyPath="targetId",wc.queryTargetsIndexName="queryTargetsIndex",wc.queryTargetsKeyPath=["canonicalId","targetId"];var Ic=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ic.store="targetDocuments",Ic.keyPath=["targetId","path"],Ic.documentTargetsIndex="documentTargetsIndex",Ic.documentTargetsKeyPath=["path","targetId"];var Ec=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ec.key="targetGlobalKey",Ec.store="targetGlobal";var _c=function(t,e){this.collectionId=t,this.parent=e};function Tc(t){t.createObjectStore(Ic.store,{keyPath:Ic.keyPath}).createIndex(Ic.documentTargetsIndex,Ic.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(wc.store,{keyPath:wc.keyPath}).createIndex(wc.queryTargetsIndexName,wc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ec.store)}_c.store="collectionParents",_c.keyPath=["collectionId","parent"];var Ac=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ac.store="clientMetadata",Ac.keyPath="clientId";var Nc=a(a(a([pc.store,dc.store,vc.store,mc.store,wc.store,lc.store,Ec.store,Ic.store],[Ac.store]),[bc.store]),[_c.store]),Sc=function(){function t(){this.la=new cc}return t.prototype.Mo=function(t,e){var n=this;if(!this.la.has(e)){var r=e.O(),i=e.F();t.pr((function(){n.la.add(e)}));var o={collectionId:r,parent:Va(i)};return Dc(t).put(o)}return Gu.resolve()},t.prototype.Kr=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[di(e),""],!1,!0);return Dc(t).ts(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ja(o.parent))}return n}))},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dc(t){return Vc.Kn(t,_c.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oc=function(){function t(t){this._a=t}return t.prototype.next=function(){return this._a+=2,this._a},t.fa=function(){return new t(0)},t.da=function(){return new t(-1)},t}(),xc=function(){function t(t,e){this.No=t,this.serializer=e}return t.prototype.wa=function(t){var e=this;return this.Ea(t).next((function(n){var r=new Oc(n.highestTargetId);return n.highestTargetId=r.next(),e.Ta(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Ia=function(t){return this.Ea(t).next((function(t){return Si.V(new Ni(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.ma=function(t){return this.Ea(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Aa=function(t,e,n){var r=this;return this.Ea(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.v()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ta(t,i)}))},t.prototype.Ra=function(t,e){var n=this;return this.Pa(t,e).next((function(){return n.Ea(t).next((function(r){return r.targetCount+=1,n.ga(e,r),n.Ta(t,r)}))}))},t.prototype.Va=function(t,e){return this.Pa(t,e)},t.prototype.ya=function(t,e){var n=this;return this.pa(t,e.targetId).next((function(){return Pc(t).delete(e.targetId)})).next((function(){return n.Ea(t)})).next((function(e){return ai(e.targetCount>0),e.targetCount-=1,n.Ta(t,e)}))},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return Pc(t).rs((function(s,u){var a=Xa(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.ya(t,a)))})).next((function(){return Gu.kn(o)})).next((function(){return i}))},t.prototype.Ce=function(t,e){return Pc(t).rs((function(t,n){var r=Xa(n);e(r)}))},t.prototype.Ea=function(t){return kc(t).get(Ec.key).next((function(t){return ai(null!==t),t}))},t.prototype.Ta=function(t,e){return kc(t).put(Ec.key,e)},t.prototype.Pa=function(t,e){return Pc(t).put(Ya(this.serializer,e))},t.prototype.ga=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.ba=function(t){return this.Ea(t).next((function(t){return t.targetCount}))},t.prototype.va=function(t,e){var n=Ui(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Pc(t).rs({range:r,index:wc.queryTargetsIndexName},(function(t,n,r){var o=Xa(n);ji(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Sa=function(t,e,n){var r=this,i=[],o=Lc(t);return e.forEach((function(e){var s=Va(e.path);i.push(o.put(new Ic(n,s))),i.push(r.No.Da(t,n,e))})),Gu.kn(i)},t.prototype.Ca=function(t,e,n){var r=this,i=Lc(t);return Gu.forEach(e,(function(e){var o=Va(e.path);return Gu.kn([i.delete([n,o]),r.No.Na(t,n,e)])}))},t.prototype.pa=function(t,e){var n=Lc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.xa=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Lc(t),i=oo();return r.rs({range:n,ss:!0},(function(t,e,n){var r=ja(t[1]),o=new ki(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Ho=function(t,e){var n=Va(e.path),r=IDBKeyRange.bound([n],[di(n)],!1,!0),i=0;return Lc(t).rs({index:Ic.documentTargetsIndex,ss:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Ue=function(t,e){return Pc(t).get(e).next((function(t){return t?Xa(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t){return Vc.Kn(t,wc.store)}function kc(t){return Vc.Kn(t,Ec.store)}function Lc(t){return Vc.Kn(t,Ic.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Cc=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Wo=e,r.Fa=n,r}return e(n,t),n}(Sa),Vc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.fn=o,this.window=s,this.document=u,this.ka=c,this.Oa=h,this.Ma=null,this.$a=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!t.Ln())throw new ti(Zr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");var f,l;this.No=new jc(this,i),this.Qa=n+"main",this.serializer=new Fa(a),this.Wa=new Bu(this.Qa,10,new hc(this.serializer)),this.ja=new xc(this.No,this.serializer),this.Dr=new Sc,this.vr=(f=this.serializer,l=this.Dr,new nc(f,l)),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===h&&ii("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Kn=function(t,e){if(t instanceof Cc)return Bu.Kn(t.Wo,e);throw ui()},t.prototype.start=function(){var t=this;return this.za().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new ti(Zr.FAILED_PRECONDITION,Rc);return t.Ha(),t.Ja(),t.Ya(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.ja.ma(e)}))})).then((function(e){t.Ma=new la(e,t.ka)})).then((function(){t.$a=!0})).catch((function(e){return t.Wa&&t.Wa.close(),Promise.reject(e)}))},t.prototype.Xa=function(t){var e=this;return this.Ka=function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){return this.Ii?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Za=function(t){var e=this;this.Wa.jn((function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.th=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws((function(){return r(e,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.Ii?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.za=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Uc(e).put(new Ac(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.eh(e).next((function(e){e||(t.isPrimary=!1,t.fn.Cs((function(){return t.Ka(!1)})))}))})).next((function(){return t.nh(e)})).next((function(n){return t.isPrimary&&!n?t.sh(e).next((function(){return!1})):!!n&&t.ih(e).next((function(){return!0}))}))})).catch((function(e){if(Ku(e))return ri("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return ri("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.fn.Cs((function(){return t.Ka(e)})),t.isPrimary=e}))},t.prototype.eh=function(t){var e=this;return Mc(t).get(lc.key).next((function(t){return Gu.resolve(e.rh(t))}))},t.prototype.oh=function(t){return Uc(t).delete(this.clientId)},t.prototype.ah=function(){return r(this,void 0,void 0,(function(){var e,n,r,o,s=this;return i(this,(function(i){switch(i.label){case 0:return!this.isPrimary||this.hh(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Kn(e,Ac.store);return n.ts().next((function(t){var e=s.uh(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return Gu.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=i.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)o=r[n],this.Ga.removeItem(this.lh(o.clientId));i.label=2;case 2:return[2]}}))}))},t.prototype.Ya=function(){var t=this;this.qa=this.fn.Vn("client_metadata_refresh",4e3,(function(){return t.za().then((function(){return t.ah()})).then((function(){return t.Ya()}))}))},t.prototype.rh=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.nh=function(t){var e=this;return this.Oa?Gu.resolve(!0):Mc(t).get(lc.key).next((function(n){if(null!==n&&e.hh(n.leaseTimestampMs,5e3)&&!e._h(n.ownerId)){if(e.rh(n)&&e.networkEnabled)return!0;if(!e.rh(n)){if(!n.allowTabSynchronization)throw new ti(Zr.FAILED_PRECONDITION,Rc);return!1}}return!(!e.networkEnabled||!e.inForeground)||Uc(t).ts().next((function(t){return void 0===e.uh(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&ri("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Di=function(){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(e){switch(e.label){case 0:return this.$a=!1,this.fh(),this.qa&&(this.qa.cancel(),this.qa=null),this.dh(),this.wh(),[4,this.Wa.runTransaction("shutdown","readwrite",[lc.store,Ac.store],(function(e){var n=new Cc(e,la.ai);return t.sh(n).next((function(){return t.oh(n)}))}))];case 1:return e.sent(),this.Wa.close(),this.Eh(),[2]}}))}))},t.prototype.uh=function(t,e){var n=this;return t.filter((function(t){return n.hh(t.updateTimeMs,e)&&!n._h(t.clientId)}))},t.prototype.pi=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Uc(e).ts().next((function(e){return t.uh(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),t.prototype.Th=function(t){return Qa.Fo(t,this.serializer,this.Dr,this.No)},t.prototype.Ih=function(){return this.ja},t.prototype.mh=function(){return this.vr},t.prototype.Ah=function(){return this.Dr},t.prototype.runTransaction=function(t,e,n){var r=this;ri("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Wa.runTransaction(t,o,Nc,(function(o){return i=new Cc(o,r.Ma?r.Ma.next():la.ai),"readwrite-primary"===e?r.eh(i).next((function(t){return!!t||r.nh(i)})).next((function(e){if(!e)throw ii("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.fn.Cs((function(){return r.Ka(!1)})),new ti(Zr.FAILED_PRECONDITION,Na);return n(i)})).next((function(t){return r.ih(i).next((function(){return t}))})):r.Rh(i).next((function(){return n(i)}))})).then((function(t){return i.br(),t}))},t.prototype.Rh=function(t){var e=this;return Mc(t).get(lc.key).next((function(t){if(null!==t&&e.hh(t.leaseTimestampMs,5e3)&&!e._h(t.ownerId)&&!e.rh(t)&&!(e.Oa||e.allowTabSynchronization&&t.allowTabSynchronization))throw new ti(Zr.FAILED_PRECONDITION,Rc)}))},t.prototype.ih=function(t){var e=new lc(this.clientId,this.allowTabSynchronization,Date.now());return Mc(t).put(lc.key,e)},t.Ln=function(){return Bu.Ln()},t.prototype.sh=function(t){var e=this,n=Mc(t);return n.get(lc.key).next((function(t){return e.rh(t)?(ri("IndexedDbPersistence","Releasing primary lease."),n.delete(lc.key)):Gu.resolve()}))},t.prototype.hh=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(ii("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws((function(){return t.inForeground="visible"===t.document.visibilityState,t.za()}))},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},t.prototype.dh=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},t.prototype.Ja=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e.fh(),e.fn.ws((function(){return e.Di()}))},this.window.addEventListener("unload",this.La))},t.prototype.wh=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},t.prototype._h=function(t){var e;try{var n=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.lh(t)));return ri("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(r){return ii("IndexedDbPersistence","Failed to get zombied client id.",r),!1}},t.prototype.fh=function(){if(this.Ga)try{this.Ga.setItem(this.lh(this.clientId),String(Date.now()))}catch(t){ii("Failed to set zombie client id.",t)}},t.prototype.Eh=function(){if(this.Ga)try{this.Ga.removeItem(this.lh(this.clientId))}catch(t){}},t.prototype.lh=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Mc(t){return Vc.Kn(t,lc.store)}function Uc(t){return Vc.Kn(t,Ac.store)}var jc=function(){function t(t,e){this.db=t,this.wo=new Ca(this,e)}return t.prototype.Po=function(t){var e=this.Ph(t);return this.db.Ih().ba(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Ph=function(t){var e=0;return this.yo(t,(function(t){e++})).next((function(){return e}))},t.prototype.Ce=function(t,e){return this.db.Ih().Ce(t,e)},t.prototype.yo=function(t,e){return this.gh(t,(function(t,n){return e(n)}))},t.prototype.Da=function(t,e,n){return Fc(t,n)},t.prototype.Na=function(t,e,n){return Fc(t,n)},t.prototype.po=function(t,e,n){return this.db.Ih().po(t,e,n)},t.prototype.Go=function(t,e){return Fc(t,e)},t.prototype.Vh=function(t,e){return r=e,i=!1,ec(n=t).os((function(t){return Ja(n,t,r).next((function(t){return t&&(i=!0),Gu.resolve(!t)}))})).next((function(){return i}));var n,r,i},t.prototype.bo=function(t,e){var n=this,r=this.db.mh().ra(),i=[],o=0;return this.gh(t,(function(s,u){if(u<=e){var a=n.Vh(t,s).next((function(e){if(!e)return o++,r.Rr(t,s).next((function(){return r.Ar(s),Lc(t).delete([0,Va(s.path)])}))}));i.push(a)}})).next((function(){return Gu.kn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.st(t.Fa);return this.db.Ih().Va(t,n)},t.prototype.yh=function(t,e){return Fc(t,e)},t.prototype.gh=function(t,e){var n,r=Lc(t),i=la.ai;return r.rs({index:Ic.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==la.ai&&e(new ki(ja(n)),i),i=u,n=s):i=la.ai})).next((function(){i!==la.ai&&e(new ki(ja(n)),i)}))},t.prototype.So=function(t){return this.db.mh().aa(t)},t}();function Fc(t,e){return Lc(t).put((n=e,r=t.Fa,new Ic(0,Va(n.path),r)));var n,r}function qc(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Gc=function(){function t(t,e,n){this.persistence=t,this.ph=e,this.bh=new Wi(li),this.Sh=new Ai((function(t){return Ui(t)}),ji),this.Dh=Si.min(),this.Sr=t.Th(n),this.Ch=t.mh(),this.ja=t.Ih(),this.Nh=new Da(this.Ch,this.Sr,this.persistence.Ah()),this.ph.xh(this.Nh)}return t.prototype.mo=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.vo(n,e.bh)}))},t}();function Bc(t,e){var n=ci(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r,i,o,s,u,a,c,h=e.batch.keys(),f=n.Ch.ra({oa:!0});return(r=n,i=t,o=e,s=f,u=o.batch,a=u.keys(),c=Gu.resolve(),a.forEach((function(t){c=c.next((function(){return s.Rr(i,t)})).next((function(e){var n=e,r=o.dr.get(t);ai(null!==r),(!n||n.version.h(r)<0)&&(n=u.hr(t,n,o))&&s.Ir(n,o._r)}))})),c.next((function(){return r.Sr.Qo(i,u)}))).next((function(){return f.apply(t)})).next((function(){return n.Sr.zo(t)})).next((function(){return n.Nh.Or(t,h)}))}))}function zc(t){var e=ci(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.ja.Ia(t)}))}function Hc(t,e){var n=ci(t),r=e.nt,i=n.bh;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ch.ra({oa:!0});i=n.bh;var s=[];e.zt.forEach((function(e,o){var u,a,c,h=i.get(o);if(h){s.push(n.ja.Ca(t,e.se,o).next((function(){return n.ja.Sa(t,e.ee,o)})));var f=e.resumeToken;if(f.o()>0){var l=h.it(f,r).st(t.Fa);i=i.ot(o,l),u=h,c=e,ai((a=l).resumeToken.o()>0),(0===u.resumeToken.o()||a.nt.p()-u.nt.p()>=3e8||c.ee.size+c.ne.size+c.se.size>0)&&s.push(n.ja.Va(t,l))}}}));var u=Zi(),a=oo();if(e.Jt.forEach((function(t,e){a=a.add(t)})),s.push(o.getEntries(t,a).next((function(i){e.Jt.forEach((function(a,c){var h=i.get(a);c instanceof iu&&c.version.isEqual(Si.min())?(o.Ar(a,r),u=u.ot(a,c)):null==h||c.version.h(h.version)>0||0===c.version.h(h.version)&&h.hasPendingWrites?(o.Ir(c,r),u=u.ot(a,c)):ri("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version),e.Yt.has(a)&&s.push(n.persistence.No.yh(t,a))}))}))),!r.isEqual(Si.min())){var c=n.ja.Ia(t).next((function(e){return n.ja.Aa(t,t.Fa,r)}));s.push(c)}return Gu.kn(s).next((function(){return o.apply(t)})).next((function(){return n.Nh.Mr(t,u)}))})).then((function(t){return n.bh=i,t}))}function Kc(t,e){var n=ci(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Sr.Bo(t,e)}))}function Wc(t,e){var n=ci(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.ja.va(t,e).next((function(i){return i?(r=i,Gu.resolve(r)):n.ja.wa(t).next((function(i){return r=new Bi(e,i,0,t.Fa),n.ja.Ra(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.bh.get(t.targetId);return(null===r||t.nt.h(r.nt)>0)&&(n.bh=n.bh.ot(t.targetId,t),n.Sh.set(e,t.targetId)),t}))}function Xc(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u;return i(this,(function(i){switch(i.label){case 0:r=ci(t),o=r.bh.get(e),s=n?"readwrite":"readwrite-primary",i.label=1;case 1:return i.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",s,(function(t){return r.persistence.No.removeTarget(t,o)}))];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:if(!Ku(u=i.sent()))throw u;return ri("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return r.bh=r.bh.remove(e),r.Sh.delete(o.target),[2]}}))}))}function Yc(t,e,n){var r=ci(t),i=Si.min(),o=oo();return r.persistence.runTransaction("Execute query","readonly",(function(t){return(s=r,u=t,a=vu(e),c=ci(s),h=c.Sh.get(a),void 0!==h?Gu.resolve(c.bh.get(h)):c.ja.va(u,a)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.ja.xa(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.ph.Lr(t,e,n?i:Si.min(),n?o:oo())})).next((function(t){return{documents:t,Fh:o}}));var s,u,a,c,h}))}function Qc(t,e){var n=ci(t),r=ci(n.ja),i=n.bh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Ue(t,e).next((function(t){return t?t.target:null}))}))}function Jc(t){var e=ci(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n=e.Ch,r=t,i=e.Dh,o=ci(n),s=Zi(),u=Ba(i),a=oc(r),c=IDBKeyRange.lowerBound(u,!0),a.rs({index:mc.readTimeIndex,range:c},(function(t,e){var n=qa(o.serializer,e);s=s.ot(n.key,n),u=e.readTime})).next((function(){return{kh:s,readTime:za(u)}}));var n,r,i,o,s,u,a,c})).then((function(t){var n=t.kh,r=t.readTime;return e.Dh=r,n}))}function $c(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){return[2,(e=ci(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return e=oc(t),n=Si.min(),e.rs({index:mc.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=za(e.readTime)),r.done()})).next((function(){return n}));var e,n})).then((function(t){e.Dh=t}))]}))}))}function Zc(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){if(t.code!==Zr.FAILED_PRECONDITION||t.message!==Na)throw t;return ri("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var th=function(){function t(){this.Oh=new Qi(eh.Mh),this.$h=new Qi(eh.Lh)}return t.prototype.P=function(){return this.Oh.P()},t.prototype.Da=function(t,e){var n=new eh(t,e);this.Oh=this.Oh.add(n),this.$h=this.$h.add(n)},t.prototype.Bh=function(t,e){var n=this;t.forEach((function(t){return n.Da(t,e)}))},t.prototype.Na=function(t,e){this.qh(new eh(t,e))},t.prototype.Uh=function(t,e){var n=this;t.forEach((function(t){return n.Na(t,e)}))},t.prototype.Kh=function(t){var e=this,n=new ki(new Oi([])),r=new eh(n,t),i=new eh(n,t+1),o=[];return this.$h.xt([r,i],(function(t){e.qh(t),o.push(t.key)})),o},t.prototype.Qh=function(){var t=this;this.Oh.forEach((function(e){return t.qh(e)}))},t.prototype.qh=function(t){this.Oh=this.Oh.delete(t),this.$h=this.$h.delete(t)},t.prototype.Wh=function(t){var e=new ki(new Oi([])),n=new eh(e,t),r=new eh(e,t+1),i=oo();return this.$h.xt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Ho=function(t){var e=new eh(t,0),n=this.Oh.kt(e);return null!==n&&t.isEqual(n.key)},t}(),eh=function(){function t(t,e){this.key=t,this.jh=e}return t.Mh=function(t,e){return ki.D(t.key,e.key)||li(t.jh,e.jh)},t.Lh=function(t,e){return li(t.jh,e.jh)||ki.D(t.key,e.key)},t}(),nh=function(t,e){this.user=e,this.type="OAuth",this.Gh={},this.Gh.Authorization="Bearer "+t},rh=function(){function t(){this.zh=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.Hh=function(){},t.prototype.Jh=function(t){this.zh=t,t(fa.UNAUTHENTICATED)},t.prototype.Yh=function(){this.zh=null},t}(),ih=function(){function t(t){var e=this;this.Xh=null,this.currentUser=fa.UNAUTHENTICATED,this.Zh=!1,this.tc=0,this.zh=null,this.forceRefresh=!1,this.Xh=function(){e.tc++,e.currentUser=e.ec(),e.Zh=!0,e.zh&&e.zh(e.currentUser)},this.tc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Xh):(this.Xh(null),t.get().then((function(t){e.auth=t,e.Xh&&e.auth.addAuthTokenListener(e.Xh)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.tc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.tc!==e?(ri("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(ai("string"==typeof n.accessToken),new nh(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.Hh=function(){this.forceRefresh=!0},t.prototype.Jh=function(t){this.zh=t,this.Zh&&t(this.currentUser)},t.prototype.Yh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Xh),this.Xh=null,this.zh=null},t.prototype.ec=function(){var t=this.auth&&this.auth.getUid();return ai(null===t||"string"==typeof t),new fa(t)},t}(),oh=function(){function t(t,e){this.nc=t,this.sc=e,this.type="FirstParty",this.user=fa.ni}return Object.defineProperty(t.prototype,"Gh",{get:function(){var t={"X-Goog-AuthUser":this.sc},e=this.nc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),sh=function(){function t(t,e){this.nc=t,this.sc=e}return t.prototype.getToken=function(){return Promise.resolve(new oh(this.nc,this.sc))},t.prototype.Jh=function(t){t(fa.ni)},t.prototype.Yh=function(){},t.prototype.Hh=function(){},t}(),uh=function(){function t(t,e,n,r,i,o){this.fn=t,this.ic=n,this.rc=r,this.oc=i,this.listener=o,this.state=0,this.ac=0,this.hc=null,this.stream=null,this.Vs=new qu(t,e)}return t.prototype.cc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.uc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.lc()},t.prototype.stop=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.cc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype._c=function(){this.state=0,this.Vs.reset()},t.prototype.fc=function(){var t=this;this.uc()&&null===this.hc&&(this.hc=this.fn.Vn(this.ic,6e4,(function(){return t.dc()})))},t.prototype.wc=function(t){this.Ec(),this.stream.send(t)},t.prototype.dc=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this.uc()?[2,this.close(0)]:[2]}))}))},t.prototype.Ec=function(){this.hc&&(this.hc.cancel(),this.hc=null)},t.prototype.close=function(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return this.Ec(),this.Vs.cancel(),this.ac++,3!==t?this.Vs.reset():e&&e.code===Zr.RESOURCE_EXHAUSTED?(ii(e.toString()),ii("Using maximum backoff delay to prevent overloading the backend."),this.Vs.Rn()):e&&e.code===Zr.UNAUTHENTICATED&&this.oc.Hh(),null!==this.stream&&(this.Tc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ic(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.Tc=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.mc(this.ac),n=this.ac;this.oc.getToken().then((function(e){t.ac===n&&t.Ac(e)}),(function(n){e((function(){var e=new ti(Zr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Rc(e)}))}))},t.prototype.Ac=function(t){var e=this,n=this.mc(this.ac);this.stream=this.Pc(t),this.stream.gc((function(){n((function(){return e.state=2,e.listener.gc()}))})),this.stream.Ic((function(t){n((function(){return e.Rc(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.lc=function(){var t=this;this.state=4,this.Vs.Pn((function(){return r(t,void 0,void 0,(function(){return i(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Rc=function(t){return ri("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.mc=function(t){var e=this;return function(n){e.fn.ws((function(){return e.ac===t?n():(ri("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),ah=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return e(n,t),n.prototype.Pc=function(t){return this.rc.Vc("Listen",t)},n.prototype.onMessage=function(t){this.Vs.reset();var e=function(t,e){var n,r;if("targetChange"in e){e.targetChange;var i="NO_CHANGE"===(r=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:ui(),o=e.targetChange.targetIds||[],s=function(t,e){return t.Ke?(ai(void 0===e||"string"==typeof e),vi.fromBase64String(e||"")):(ai(void 0===e||e instanceof Uint8Array),vi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),u=e.targetChange.cause,a=u&&function(t){var e=void 0===t.code?Zr.UNKNOWN:Ki(t.code);return new ti(e,t.message||"")}(u);n=new yo(i,o,s,a||null)}else if("documentChange"in e){e.documentChange;var c=e.documentChange;c.document,c.document.name,c.document.updateTime;var h=ts(t,c.document.name),f=Qo(c.document.updateTime),l=new Zs({mapValue:{fields:c.document.fields}}),p=new ru(h,f,l,{}),d=c.targetIds||[],v=c.removedTargetIds||[];n=new po(d,v,p.key,p)}else if("documentDelete"in e){e.documentDelete;var y=e.documentDelete;y.document;var g=ts(t,y.document),m=y.readTime?Qo(y.readTime):Si.min(),b=new iu(g,m),w=y.removedTargetIds||[];n=new po([],w,b.key,b)}else if("documentRemove"in e){e.documentRemove;var I=e.documentRemove;I.document;var E=ts(t,I.document),_=I.removedTargetIds||[];n=new po([],_,E,null)}else{if(!("filter"in e))return ui();e.filter;var T=e.filter;T.targetId;var A=T.count||0,N=new zi(A),S=T.targetId;n=new vo(S,N)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Si.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Si.min():e.readTime?Qo(e.readTime):Si.min()}(t);return this.listener.yc(e,n)},n.prototype.bc=function(t){var e,n,r,i,o={};o.database=rs(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=Fi(i)?{documents:as(e,i)}:{query:cs(e,i)}).targetId=n.targetId,n.resumeToken.o()>0&&(r.resumeToken=Xo(e,n.resumeToken)),r);var s=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ui()}}(0,e.et);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);s&&(o.labels=s),this.wc(o)},n.prototype.vc=function(t){var e={};e.database=rs(this.serializer),e.removeTarget=t,this.wc(e)},n}(uh),ch=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Sc=!1,s}return e(n,t),Object.defineProperty(n.prototype,"Dc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),n.prototype.start=function(){this.Sc=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},n.prototype.Tc=function(){this.Sc&&this.Cc([])},n.prototype.Pc=function(t){return this.rc.Vc("Write",t)},n.prototype.onMessage=function(t){if(ai(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Sc){this.Vs.reset();var e=(r=t.writeResults,i=t.commitTime,r&&r.length>0?(ai(void 0!==i),r.map((function(t){return function(t,e){var n=t.updateTime?Qo(t.updateTime):Qo(e);n.isEqual(Si.min())&&(n=Qo(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Vs(n,r)}(t,i)}))):[]),n=Qo(t.commitTime);return this.listener.Nc(n,e)}var r,i;return ai(!t.writeResults||0===t.writeResults.length),this.Sc=!0,this.listener.xc()},n.prototype.Fc=function(){var t={};t.database=rs(this.serializer),this.wc(t)},n.prototype.Cc=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return ss(e.serializer,t)}))};this.wc(n)},n}(uh),hh=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.rc=n,i.serializer=r,i.kc=!1,i}return e(n,t),n.prototype.Oc=function(){if(this.kc)throw new ti(Zr.FAILED_PRECONDITION,"The client has already been terminated.")},n.prototype.Mc=function(t,e,n){var r=this;return this.Oc(),this.credentials.getToken().then((function(i){return r.rc.Mc(t,e,n,i)})).catch((function(t){throw t.code===Zr.UNAUTHENTICATED&&r.credentials.Hh(),t}))},n.prototype.$c=function(t,e,n){var r=this;return this.Oc(),this.credentials.getToken().then((function(i){return r.rc.$c(t,e,n,i)})).catch((function(t){throw t.code===Zr.UNAUTHENTICATED&&r.credentials.Hh(),t}))},n.prototype.terminate=function(){this.kc=!1},n}((function(){})),fh=function(){function t(t,e){this.hs=t,this.di=e,this.state="Unknown",this.Lc=0,this.Bc=null,this.qc=!0}return t.prototype.Uc=function(){var t=this;0===this.Lc&&(this.Kc("Unknown"),this.Bc=this.hs.Vn("online_state_timeout",1e4,(function(){return t.Bc=null,t.Qc("Backend didn't respond within 10 seconds."),t.Kc("Offline"),Promise.resolve()})))},t.prototype.Wc=function(t){"Online"===this.state?this.Kc("Unknown"):(this.Lc++,this.Lc>=1&&(this.jc(),this.Qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Kc("Offline")))},t.prototype.set=function(t){this.jc(),this.Lc=0,"Online"===t&&(this.qc=!1),this.Kc(t)},t.prototype.Kc=function(t){t!==this.state&&(this.state=t,this.di(t))},t.prototype.Qc=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.qc?(ii(e),this.qc=!1):ri("OnlineStateTracker",e)},t.prototype.jc=function(){null!==this.Bc&&(this.Bc.cancel(),this.Bc=null)},t}(),lh=function(t,e,n,o,s){var u=this;this.Gc=t,this.zc=e,this.hs=n,this.Hc={},this.Jc=[],this.Yc=new Map,this.Xc=new Set,this.Zc=[],this.tu=s,this.tu.eu((function(t){n.ws((function(){return r(u,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return Eh(this)?(ri("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return(e=ci(t)).Xc.add(4),[4,dh(e)];case 1:return n.sent(),e.nu.set("Unknown"),e.Xc.delete(4),[4,ph(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.nu=new fh(n,o)};function ph(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:if(!Eh(t))return[3,4];e=0,n=t.Zc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function dh(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:e=0,n=t.Zc,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function vh(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=ci(t),ri("RemoteStore","RemoteStore shutting down."),e.Xc.add(5),[4,dh(e)];case 1:return n.sent(),e.tu.Di(),e.nu.set("Unknown"),[2]}}))}))}function yh(t,e){var n=ci(t);n.Yc.has(e.targetId)||(n.Yc.set(e.targetId,e),Ih(n)?wh(n):Mh(n).uc()&&mh(n,e))}function gh(t,e){var n=ci(t),r=Mh(n);n.Yc.delete(e),r.uc()&&bh(n,e),0===n.Yc.size&&(r.uc()?r.fc():Eh(n)&&n.nu.set("Unknown"))}function mh(t,e){t.su.me(e.targetId),Mh(t).bc(e)}function bh(t,e){t.su.me(e),Mh(t).vc(e)}function wh(t){t.su=new mo({qe:function(e){return t.Hc.qe(e)},Ue:function(e){return t.Yc.get(e)||null}}),Mh(t).start(),t.nu.Uc()}function Ih(t){return Eh(t)&&!Mh(t).cc()&&t.Yc.size>0}function Eh(t){return 0===ci(t).Xc.size}function _h(t){t.su=void 0}function Th(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return t.Yc.forEach((function(e,n){mh(t,e)})),[2]}))}))}function Ah(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){return _h(t),Ih(t)?(t.nu.Wc(e),wh(t)):t.nu.set("Unknown"),[2]}))}))}function Nh(t,e,n){return r(this,void 0,void 0,(function(){var o,s,u;return i(this,(function(a){switch(a.label){case 0:if(t.nu.set("Online"),!(e instanceof yo&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s;return i(this,(function(i){switch(i.label){case 0:n=e.cause,r=0,o=e.targetIds,i.label=1;case 1:return r<o.length?(s=o[r],t.Yc.has(s)?[4,t.Hc.iu(s,n)]:[3,3]):[3,5];case 2:i.sent(),t.Yc.delete(s),t.su.removeTarget(s),i.label=3;case 3:i.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return o=a.sent(),ri("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),o),[4,Sh(t,o)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof po?t.su.be(e):e instanceof vo?t.su.ke(e):t.su.De(e),n.isEqual(Si.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,zc(t.Gc)];case 8:return s=a.sent(),n.h(s)>=0?[4,(c=t,h=n,f=c.su.$e(h),f.zt.forEach((function(t,e){if(t.resumeToken.o()>0){var n=c.Yc.get(e);n&&c.Yc.set(e,n.it(t.resumeToken,h))}})),f.Ht.forEach((function(t){var e=c.Yc.get(t);if(e){c.Yc.set(t,e.it(vi.u,e.nt)),bh(c,t);var n=new Bi(e.target,t,1,e.sequenceNumber);mh(c,n)}})),c.Hc.ru(f))]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return ri("RemoteStore","Failed to raise snapshot:",u=a.sent()),[4,Sh(t,u)];case 12:return a.sent(),[3,13];case 13:return[2]}var c,h,f}))}))}function Sh(t,e,n){return r(this,void 0,void 0,(function(){var o=this;return i(this,(function(s){switch(s.label){case 0:if(!Ku(e))throw e;return t.Xc.add(1),[4,dh(t)];case 1:return s.sent(),t.nu.set("Offline"),n||(n=function(){return zc(t.Gc)}),t.hs.Cs((function(){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return ri("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Xc.delete(1),[4,ph(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Dh(t,e){return e().catch((function(n){return Sh(t,n,e)}))}function Oh(t){return r(this,void 0,void 0,(function(){var e,n,r,o,s;return i(this,(function(i){switch(i.label){case 0:e=ci(t),n=Uh(e),r=e.Jc.length>0?e.Jc[e.Jc.length-1].batchId:-1,i.label=1;case 1:if(!(Eh(u=e)&&u.Jc.length<10))return[3,7];i.label=2;case 2:return i.trys.push([2,4,,6]),[4,Kc(e.Gc,r)];case 3:return null===(o=i.sent())?(0===e.Jc.length&&n.fc(),[3,7]):(r=o.batchId,function(t,e){t.Jc.push(e);var n=Uh(t);n.uc()&&n.Dc&&n.Cc(e.mutations)}(e,o),[3,6]);case 4:return s=i.sent(),[4,Sh(e,s)];case 5:return i.sent(),[3,6];case 6:return[3,1];case 7:return xh(e)&&Ph(e),[2]}var u}))}))}function xh(t){return Eh(t)&&!Uh(t).cc()&&t.Jc.length>0}function Ph(t){Uh(t).start()}function kh(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return Uh(t).Fc(),[2]}))}))}function Lh(t){return r(this,void 0,void 0,(function(){var e,n,r,o;return i(this,(function(i){for(e=Uh(t),n=0,r=t.Jc;n<r.length;n++)o=r[n],e.Cc(o.mutations);return[2]}))}))}function Rh(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return r=t.Jc.shift(),o=Ta.from(r,e,n),[4,Dh(t,(function(){return t.Hc.ou(o)}))];case 1:return i.sent(),[4,Oh(t)];case 2:return i.sent(),[2]}}))}))}function Ch(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e&&Uh(t).Dc?[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return Hi(r=e.code)&&r!==Zr.ABORTED?(n=t.Jc.shift(),Uh(t)._c(),[4,Dh(t,(function(){return t.Hc.au(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Oh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return xh(t)&&Ph(t),[2]}}))}))}function Vh(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=ci(t),e?(n.Xc.delete(2),[4,ph(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Xc.add(2),[4,dh(n)]);case 3:r.sent(),n.nu.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Mh(t){var e,n,o,s,u=this;return t.hu||(t.hu=(e=t.zc,n=t.hs,o={gc:Th.bind(null,t),Ic:Ah.bind(null,t),yc:Nh.bind(null,t)},(s=ci(e)).Oc(),new ah(n,s.rc,s.credentials,s.serializer,o)),t.Zc.push((function(e){return r(u,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e?(t.hu._c(),Ih(t)?wh(t):t.nu.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.hu.stop()];case 2:n.sent(),_h(t),n.label=3;case 3:return[2]}}))}))}))),t.hu}function Uh(t){var e,n,o,s,u=this;return t.cu||(t.cu=(e=t.zc,n=t.hs,o={gc:kh.bind(null,t),Ic:Ch.bind(null,t),xc:Lh.bind(null,t),Nc:Rh.bind(null,t)},(s=ci(e)).Oc(),new ch(n,s.rc,s.credentials,s.serializer,o)),t.Zc.push((function(e){return r(u,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e?(t.cu._c(),[4,Oh(t)]):[3,2];case 1:return n.sent(),[3,4];case 2:return[4,t.cu.stop()];case 3:n.sent(),t.Jc.length>0&&(ri("RemoteStore","Stopping write stream with "+t.Jc.length+" pending writes"),t.Jc=[]),n.label=4;case 4:return[2]}}))}))}))),t.cu}var jh=function(t){this.key=t},Fh=function(t){this.key=t},qh=function(){function t(t,e){this.query=t,this.uu=e,this.lu=null,this.te=!1,this._u=oo(),this.Qt=oo(),this.fu=_u(t),this.du=new ao(this.fu)}return Object.defineProperty(t.prototype,"wu",{get:function(){return this.uu},enumerable:!1,configurable:!0}),t.prototype.Eu=function(t,e){var n=this,r=e?e.Tu:new co,i=e?e.du:this.du,o=e?e.Qt:this.Qt,s=i,u=!1,a=cu(this.query)&&i.size===this.query.limit?i.last():null,c=hu(this.query)&&i.size===this.query.limit?i.first():null;if(t.ut((function(t,e){var h=i.get(t),f=e instanceof ru?e:null;f&&(f=Eu(n.query,f)?f:null);var l=!!h&&n.Qt.has(h.key),p=!!f&&(f.Ye||n.Qt.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Iu(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.fu(f,a)>0||c&&n.fu(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),cu(this.query)||hu(this.query))for(;s.size>this.query.limit;){var h=cu(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{du:s,Tu:r,mu:u,Qt:o}},t.prototype.Iu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},t.prototype.Vr=function(t,e,n){var r=this,i=this.du;this.du=t.du,this.Qt=t.Qt;var o=t.Tu.Ut();o.sort((function(t,e){return n=t.type,i=e.type,(o=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ui()}})(n)-o(i)||r.fu(t.doc,e.doc);var n,i,o})),this.Au(n);var s=e?this.Ru():[],u=0===this._u.size&&this.te?1:0,a=u!==this.lu;return this.lu=u,0!==o.length||a?{snapshot:new ho(this.query,t.du,i,o,t.Qt,0===u,a,!1),Pu:s}:{Pu:s}},t.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Vr({du:this.du,Tu:new co,Qt:this.Qt,mu:!1},!1)):{Pu:[]}},t.prototype.gu=function(t){return!this.uu.has(t)&&!!this.du.has(t)&&!this.du.get(t).Ye},t.prototype.Au=function(t){var e=this;t&&(t.ee.forEach((function(t){return e.uu=e.uu.add(t)})),t.ne.forEach((function(t){})),t.se.forEach((function(t){return e.uu=e.uu.delete(t)})),this.te=t.te)},t.prototype.Ru=function(){var t=this;if(!this.te)return[];var e=this._u;this._u=oo(),this.du.forEach((function(e){t.gu(e.key)&&(t._u=t._u.add(e.key))}));var n=[];return e.forEach((function(e){t._u.has(e)||n.push(new Fh(e))})),this._u.forEach((function(t){e.has(t)||n.push(new jh(t))})),n},t.prototype.Vu=function(t){this.uu=t.Fh,this._u=oo();var e=this.Eu(t.documents);return this.Vr(e,!0)},t.prototype.yu=function(){return ho.Gt(this.query,this.du,this.Qt,0===this.lu)},t}(),Gh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Bh=function(t){this.key=t,this.pu=!1},zh=function(){function t(t,e,n,r,i,o){this.Gc=t,this.bu=e,this.vu=n,this.Su=r,this.currentUser=i,this.Du=o,this.Cu={},this.Nu=new Ai((function(t){return wu(t)}),bu),this.xu=new Map,this.Fu=[],this.ku=new Wi(ki.D),this.Ou=new Map,this.Mu=new th,this.$u={},this.Lu=new Map,this.Bu=Oc.da(),this.onlineState="Unknown",this.qu=void 0}return Object.defineProperty(t.prototype,"Uu",{get:function(){return!0===this.qu},enumerable:!1,configurable:!0}),t}();function Hh(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a;return i(this,(function(i){switch(i.label){case 0:return n=mf(t),(s=n.Nu.get(e))?(r=s.targetId,n.Su.$i(r),o=s.view.yu(),[3,4]):[3,1];case 1:return[4,Wc(n.Gc,vu(e))];case 2:return u=i.sent(),a=n.Su.$i(u.targetId),r=u.targetId,[4,Kh(n,e,r,"current"===a)];case 3:o=i.sent(),n.Uu&&yh(n.bu,u),i.label=4;case 4:return[2,o]}}))}))}function Kh(t,e,n,o){return r(this,void 0,void 0,(function(){var s,u,a,c,h,f;return i(this,(function(l){switch(l.label){case 0:return t.Ku=function(e,n,o){return function(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,u;return i(this,(function(i){switch(i.label){case 0:return(r=e.view.Eu(n)).mu?[4,Yc(t.Gc,e.query,!1).then((function(t){var n=t.documents;return e.view.Eu(n,r)}))]:[3,2];case 1:r=i.sent(),i.label=2;case 2:return s=o&&o.zt.get(e.targetId),u=e.view.Vr(r,t.Uu,s),[2,(rf(t,e.targetId,u.Pu),u.snapshot)]}}))}))}(t,e,n,o)},[4,Yc(t.Gc,e,!0)];case 1:return s=l.sent(),u=new qh(e,s.Fh),a=u.Eu(s.documents),c=lo.Zt(n,o&&"Offline"!==t.onlineState),h=u.Vr(a,t.Uu,c),rf(t,n,h.Pu),f=new Gh(e,n,u),[2,(t.Nu.set(e,f),t.xu.has(n)?t.xu.get(n).push(e):t.xu.set(n,[e]),h.snapshot)]}}))}))}function Wh(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=ci(t),r=n.Nu.get(e),(o=n.xu.get(r.targetId)).length>1?[2,(n.xu.set(r.targetId,o.filter((function(t){return!bu(t,e)}))),void n.Nu.delete(e))]:n.Uu?(n.Su.Bi(r.targetId),n.Su.xi(r.targetId)?[3,2]:[4,Xc(n.Gc,r.targetId,!1).then((function(){n.Su.Ui(r.targetId),gh(n.bu,r.targetId),ef(n,r.targetId)})).catch(Zc)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return ef(n,r.targetId),[4,Xc(n.Gc,r.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))}function Xh(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:n=ci(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Hc(n.Gc,e)];case 2:return r=i.sent(),e.zt.forEach((function(t,e){var r=n.Ou.get(e);r&&(ai(t.ee.size+t.ne.size+t.se.size<=1),t.ee.size>0?r.pu=!0:t.ne.size>0?ai(r.pu):t.se.size>0&&(ai(r.pu),r.pu=!1))})),[4,uf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Zc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Yh(t,e,n){var r=ci(t);if(r.Uu&&0===n||!r.Uu&&1===n){var i=[];r.Nu.forEach((function(t,n){var r=n.view.Ks(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=ci(t);n.onlineState=e;var r=!1;n.Bs.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Ks(e)&&(r=!0)})),r&&ca(n)}(r.vu,e),i.length&&r.Cu.yc(i),r.onlineState=e,r.Uu&&r.Su.ji(e)}}function Qh(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u,a,c;return i(this,(function(i){switch(i.label){case 0:return(r=ci(t)).Su.Ki(e,"rejected",n),o=r.Ou.get(e),(s=o&&o.key)?(u=(u=new Wi(ki.D)).ot(s,new iu(s,Si.min())),a=oo().add(s),c=new fo(Si.min(),new Map,new Qi(li),u,a),[4,Xh(r,c)]):[3,2];case 1:return i.sent(),r.ku=r.ku.remove(s),r.Ou.delete(e),sf(r),[3,4];case 2:return[4,Xc(r.Gc,e,!1).then((function(){return ef(r,e,n)})).catch(Zc)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))}function Jh(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:n=ci(t),r=e.batch.batchId,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Bc(n.Gc,e)];case 2:return o=i.sent(),tf(n,r,null),Zh(n,r),n.Su.Oi(r,"acknowledged"),[4,uf(n,o)];case 3:return i.sent(),[3,6];case 4:return[4,Zc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function $h(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:r=ci(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,(s=r.Gc,u=e,a=ci(s),a.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var e;return a.Sr.$o(t,u).next((function(n){return ai(null!==n),e=n.keys(),a.Sr.Qo(t,n)})).next((function(){return a.Sr.zo(t)})).next((function(){return a.Nh.Or(t,e)}))})))];case 2:return o=i.sent(),tf(r,e,n),Zh(r,e),r.Su.Oi(e,"rejected",n),[4,uf(r,o)];case 3:return i.sent(),[3,6];case 4:return[4,Zc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}var s,u,a}))}))}function Zh(t,e){(t.Lu.get(e)||[]).forEach((function(t){t.resolve()})),t.Lu.delete(e)}function tf(t,e,n){var r=ci(t),i=r.$u[r.currentUser.ti()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.$u[r.currentUser.ti()]=i}}function ef(t,e,n){void 0===n&&(n=null),t.Su.Bi(e);for(var r=0,i=t.xu.get(e);r<i.length;r++){var o=i[r];t.Nu.delete(o),n&&t.Cu.Qu(o,n)}t.xu.delete(e),t.Uu&&t.Mu.Kh(e).forEach((function(e){t.Mu.Ho(e)||nf(t,e)}))}function nf(t,e){var n=t.ku.get(e);null!==n&&(gh(t.bu,n),t.ku=t.ku.remove(e),t.Ou.delete(n),sf(t))}function rf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof jh?(t.Mu.Da(o.key,e),of(t,o)):o instanceof Fh?(ri("SyncEngine","Document no longer in limbo: "+o.key),t.Mu.Na(o.key,e),t.Mu.Ho(o.key)||nf(t,o.key)):ui()}}function of(t,e){var n=e.key;t.ku.get(n)||(ri("SyncEngine","New document in limbo: "+n),t.Fu.push(n),sf(t))}function sf(t){for(;t.Fu.length>0&&t.ku.size<t.Du;){var e=t.Fu.shift(),n=t.Bu.next();t.Ou.set(n,new Bh(e)),t.ku=t.ku.ot(e,n),yh(t.bu,new Bi(vu(au(e.path)),n,2,la.ai))}}function uf(t,e,n){return r(this,void 0,void 0,(function(){var o,s,u,a;return i(this,(function(c){switch(c.label){case 0:return o=ci(t),s=[],u=[],a=[],o.Nu.P()?[3,3]:(o.Nu.forEach((function(t,r){a.push(o.Ku(r,e,n).then((function(t){if(t){o.Uu&&o.Su.Ki(r.targetId,t.fromCache?"not-current":"current"),s.push(t);var e=Oa.zr(r.targetId,t);u.push(e)}})))})),[4,Promise.all(a)]);case 1:return c.sent(),o.Cu.yc(s),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a,c,h,f;return i(this,(function(i){switch(i.label){case 0:n=ci(t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Gu.forEach(e,(function(e){return Gu.forEach(e.jr,(function(r){return n.persistence.No.Da(t,e.targetId,r)})).next((function(){return Gu.forEach(e.Gr,(function(r){return n.persistence.No.Na(t,e.targetId,r)}))}))}))}))];case 2:return i.sent(),[3,4];case 3:if(!Ku(r=i.sent()))throw r;return ri("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(o=0,s=e;o<s.length;o++)u=s[o],a=u.targetId,u.fromCache||(c=n.bh.get(a),h=c.nt,f=c.rt(h),n.bh=n.bh.ot(a,f));return[2]}}))}))}(o.Gc,u)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function af(t,e){return r(this,void 0,void 0,(function(){var n,o;return i(this,(function(s){switch(s.label){case 0:return(n=ci(t)).currentUser.isEqual(e)?[3,3]:(ri("SyncEngine","User change. New user:",e.ti()),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s;return i(this,(function(i){switch(i.label){case 0:return n=ci(t),r=n.Sr,o=n.Nh,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var i;return n.Sr.Uo(t).next((function(s){return i=s,r=n.persistence.Th(e),o=new Da(n.Ch,r,n.persistence.Ah()),r.Uo(t)})).next((function(e){for(var n=[],r=[],s=oo(),u=0,a=i;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];s=s.add(m.key)}}return o.Or(t,s).next((function(t){return{Wu:t,ju:n,Gu:r}}))}))}))];case 1:return s=i.sent(),[2,(n.Sr=r,n.Nh=o,n.ph.xh(n.Nh),s)]}}))}))}(n.Gc,e)]);case 1:return o=s.sent(),n.currentUser=e,(u=n).Lu.forEach((function(t){t.forEach((function(t){t.reject(new ti(Zr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),u.Lu.clear(),n.Su.Wi(e,o.ju,o.Gu),[4,uf(n,o.Wu)];case 2:s.sent(),s.label=3;case 3:return[2]}var u}))}))}function cf(t,e){var n=ci(t),r=n.Ou.get(e);if(r&&r.pu)return oo().add(r.key);var i=oo(),o=n.xu.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.Nu.get(a);i=i.Ot(c.view.wu)}return i}function hf(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,Yc((n=ci(t)).Gc,e.query,!0)];case 1:return r=i.sent(),o=e.view.Vu(r),[2,(n.Uu&&rf(n,e.targetId,o.Pu),o)]}}))}))}function ff(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s;return i(this,(function(i){switch(i.label){case 0:return[4,(u=(r=ci(t)).Gc,a=e,c=ci(u),h=ci(c.Sr),c.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return h.Lo(t,a).next((function(e){return e?c.Nh.Or(t,e):Gu.resolve(null)}))})))];case 1:return null===(s=i.sent())?[3,6]:"pending"!==n?[3,3]:[4,Oh(r.bu)];case 2:return i.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(tf(r,e,o||null),Zh(r,e),function(t,e){ci(ci(t).Sr).jo(e)}(r.Gc,e)):ui(),i.label=4;case 4:return[4,uf(r,s)];case 5:return i.sent(),[3,7];case 6:ri("SyncEngine","Cannot apply mutation batch with id: "+e),i.label=7;case 7:return[2]}var u,a,c,h}))}))}function lf(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a,c,h;return i(this,(function(i){switch(i.label){case 0:return mf(n=ci(t)),bf(n),!0!==e||!0===n.qu?[3,3]:(r=n.Su.Ci(),[4,pf(n,r.L())]);case 1:return o=i.sent(),n.qu=!0,[4,Vh(n.bu,!0)];case 2:for(i.sent(),s=0,u=o;s<u.length;s++)a=u[s],yh(n.bu,a);return[3,7];case 3:return!1!==e||!1===n.qu?[3,7]:(c=[],h=Promise.resolve(),n.xu.forEach((function(t,e){n.Su.qi(e)?c.push(e):h=h.then((function(){return ef(n,e),Xc(n.Gc,e,!0)})),gh(n.bu,e)})),[4,h]);case 4:return i.sent(),[4,pf(n,c)];case 5:return i.sent(),(f=ci(n)).Ou.forEach((function(t,e){gh(f.bu,e)})),f.Mu.Qh(),f.Ou=new Map,f.ku=new Wi(ki.D),n.qu=!1,[4,Vh(n.bu,!1)];case 6:i.sent(),i.label=7;case 7:return[2]}var f}))}))}function pf(t,e,n){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a,c,h,f,l,p,d,v,y;return i(this,(function(i){switch(i.label){case 0:n=ci(t),r=[],o=[],s=0,u=e,i.label=1;case 1:return s<u.length?(a=u[s],c=void 0,(h=n.xu.get(a))&&0!==h.length?[4,Wc(n.Gc,vu(h[0]))]:[3,7]):[3,13];case 2:c=i.sent(),f=0,l=h,i.label=3;case 3:return f<l.length?(p=l[f],d=n.Nu.get(p),[4,hf(n,d)]):[3,6];case 4:(v=i.sent()).snapshot&&o.push(v.snapshot),i.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,Qc(n.Gc,a)];case 8:return y=i.sent(),[4,Wc(n.Gc,y)];case 9:return c=i.sent(),[4,Kh(n,df(y),a,!1)];case 10:i.sent(),i.label=11;case 11:r.push(c),i.label=12;case 12:return s++,[3,1];case 13:return[2,(n.Cu.yc(o),r)]}}))}))}function df(t){return uu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function vf(t){var e=ci(t);return ci(ci(e.Gc).persistence).pi()}function yf(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,u;return i(this,(function(i){switch(i.label){case 0:return(r=ci(t)).qu?(ri("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!r.xu.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Jc(r.Gc)];case 3:return s=i.sent(),u=fo.Xt(e,"current"===n),[4,uf(r,s,u)];case 4:return i.sent(),[3,8];case 5:return[4,Xc(r.Gc,e,!0)];case 6:return i.sent(),ef(r,e,o),[3,8];case 7:ui(),i.label=8;case 8:return[2]}}))}))}function gf(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u,a,c,h,f,l,p;return i(this,(function(d){switch(d.label){case 0:if(!(r=mf(t)).qu)return[3,10];o=0,s=e,d.label=1;case 1:return o<s.length?(u=s[o],r.xu.has(u)?(ri("SyncEngine","Adding an already active target "+u),[3,5]):[4,Qc(r.Gc,u)]):[3,6];case 2:return a=d.sent(),[4,Wc(r.Gc,a)];case 3:return c=d.sent(),[4,Kh(r,df(a),c.targetId,!1)];case 4:d.sent(),yh(r.bu,c),d.label=5;case 5:return o++,[3,1];case 6:h=function(t){return i(this,(function(e){switch(e.label){case 0:return r.xu.has(t)?[4,Xc(r.Gc,t,!1).then((function(){gh(r.bu,t),ef(r,t)})).catch(Zc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,l=n,d.label=7;case 7:return f<l.length?(p=l[f],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function mf(t){var e=ci(t);return e.bu.Hc.ru=Xh.bind(null,e),e.bu.Hc.qe=cf.bind(null,e),e.bu.Hc.iu=Qh.bind(null,e),e.Cu.yc=ua.bind(null,e.vu),e.Cu.Qu=aa.bind(null,e.vu),e}function bf(t){var e=ci(t);return e.bu.Hc.ou=Jh.bind(null,e),e.bu.Hc.au=$h.bind(null,e),e
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var wf=function(){function t(){}return t.prototype.xh=function(t){this.zu=t},t.prototype.Lr=function(t,e,n,r){var i,o=this;return 0===(i=e).filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.on.length||1===i.on.length&&i.on[0].field.W())||n.isEqual(Si.min())?this.Hu(t,e):this.zu.Or(t,r).next((function(i){var s=o.Ju(e,i);return(cu(e)||hu(e))&&o.mu(e.an,s,r,n)?o.Hu(t,e):(ni()<=N.DEBUG&&ri("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Iu(e)),o.zu.Lr(t,e,n).next((function(t){return s.forEach((function(e){t=t.ot(e.key,e)})),t})))}))},t.prototype.Ju=function(t,e){var n=new Qi(_u(t));return e.forEach((function(e,r){r instanceof ru&&Eu(t,r)&&(n=n.add(r))})),n},t.prototype.mu=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.h(r)>0)},t.prototype.Hu=function(t,e){return ni()<=N.DEBUG&&ri("IndexFreeQueryEngine","Using full collection scan to execute query:",Iu(e)),this.zu.Lr(t,e,Si.min())},t}(),If=function(){function t(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Yu=1,this.Xu=new Qi(eh.Mh)}return t.prototype.ko=function(t){return Gu.resolve(0===this.Sr.length)},t.prototype.Oo=function(t,e,n,r){var i=this.Yu;this.Yu++,this.Sr.length>0&&this.Sr[this.Sr.length-1];var o=new _a(i,e,n,r);this.Sr.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Xu=this.Xu.add(new eh(a.key,i)),this.Dr.Mo(t,a.key.path.F())}return Gu.resolve(o)},t.prototype.$o=function(t,e){return Gu.resolve(this.Zu(e))},t.prototype.Bo=function(t,e){var n=e+1,r=this.tl(n),i=r<0?0:r;return Gu.resolve(this.Sr.length>i?this.Sr[i]:null)},t.prototype.qo=function(){return Gu.resolve(0===this.Sr.length?-1:this.Yu-1)},t.prototype.Uo=function(t){return Gu.resolve(this.Sr.slice())},t.prototype.Nr=function(t,e){var n=this,r=new eh(e,0),i=new eh(e,Number.POSITIVE_INFINITY),o=[];return this.Xu.xt([r,i],(function(t){var e=n.Zu(t.jh);o.push(e)})),Gu.resolve(o)},t.prototype.$r=function(t,e){var n=this,r=new Qi(li);return e.forEach((function(t){var e=new eh(t,0),i=new eh(t,Number.POSITIVE_INFINITY);n.Xu.xt([e,i],(function(t){r=r.add(t.jh)}))})),Gu.resolve(this.el(r))},t.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,i=n;ki.X(i)||(i=i.child(""));var o=new eh(new ki(i),0),s=new Qi(li);return this.Xu.Ft((function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(s=s.add(t.jh)),!0)}),o),Gu.resolve(this.el(s))},t.prototype.el=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Zu(t);null!==r&&n.push(r)})),n},t.prototype.Qo=function(t,e){var n=this;ai(0===this.nl(e.batchId,"removed")),this.Sr.shift();var r=this.Xu;return Gu.forEach(e.mutations,(function(i){var o=new eh(i.key,e.batchId);return r=r.delete(o),n.No.Go(t,i.key)})).next((function(){n.Xu=r}))},t.prototype.jo=function(t){},t.prototype.Ho=function(t,e){var n=new eh(e,0),r=this.Xu.kt(n);return Gu.resolve(e.isEqual(r&&r.key))},t.prototype.zo=function(t){return this.Sr.length,Gu.resolve()},t.prototype.nl=function(t,e){return this.tl(t)},t.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},t.prototype.Zu=function(t){var e=this.tl(t);return e<0||e>=this.Sr.length?null:this.Sr[e]},t}(),Ef=function(){function t(t,e){this.Dr=t,this.sl=e,this.docs=new Wi(ki.D),this.size=0}return t.prototype.Ir=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:s,readTime:n}),this.size+=s-o,this.Dr.Mo(t,r.path.F())},t.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Rr=function(t,e){var n=this.docs.get(e);return Gu.resolve(n?n.ta:null)},t.prototype.getEntries=function(t,e){var n=this,r=to();return e.forEach((function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)})),Gu.resolve(r)},t.prototype.Lr=function(t,e,n){for(var r=no(),i=new ki(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),u=s.key,a=s.value,c=a.ta,h=a.readTime;if(!e.path.M(u.path))break;h.h(n)<=0||c instanceof ru&&Eu(e,c)&&(r=r.ot(c.key,c))}return Gu.resolve(r)},t.prototype.il=function(t,e){return Gu.forEach(this.docs,(function(t){return e(t)}))},t.prototype.ra=function(t){return new _f(this)},t.prototype.aa=function(t){return Gu.resolve(this.size)},t}(),_f=function(t){function n(e){var n=this;return(n=t.call(this)||this).ha=e,n}return e(n,t),n.prototype.Vr=function(t){var e=this,n=[];return this.wr.forEach((function(r,i){i?n.push(e.ha.Ir(t,i,e.readTime)):e.ha.Ar(r)})),Gu.kn(n)},n.prototype.Pr=function(t,e){return this.ha.Rr(t,e)},n.prototype.gr=function(t,e){return this.ha.getEntries(t,e)},n}(Aa),Tf=function(){function t(t){this.persistence=t,this.rl=new Ai((function(t){return Ui(t)}),ji),this.lastRemoteSnapshotVersion=Si.min(),this.highestTargetId=0,this.ol=0,this.al=new th,this.targetCount=0,this.hl=Oc.fa()}return t.prototype.Ce=function(t,e){return this.rl.forEach((function(t,n){return e(n)})),Gu.resolve()},t.prototype.Ia=function(t){return Gu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ma=function(t){return Gu.resolve(this.ol)},t.prototype.wa=function(t){return this.highestTargetId=this.hl.next(),Gu.resolve(this.highestTargetId)},t.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),Gu.resolve()},t.prototype.Pa=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new Oc(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},t.prototype.Ra=function(t,e){return this.Pa(e),this.targetCount+=1,Gu.resolve()},t.prototype.Va=function(t,e){return this.Pa(e),Gu.resolve()},t.prototype.ya=function(t,e){return this.rl.delete(e.target),this.al.Kh(e.targetId),this.targetCount-=1,Gu.resolve()},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return this.rl.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.rl.delete(s),o.push(r.pa(t,u.targetId)),i++)})),Gu.kn(o).next((function(){return i}))},t.prototype.ba=function(t){return Gu.resolve(this.targetCount)},t.prototype.va=function(t,e){var n=this.rl.get(e)||null;return Gu.resolve(n)},t.prototype.Sa=function(t,e,n){return this.al.Bh(e,n),Gu.resolve()},t.prototype.Ca=function(t,e,n){this.al.Uh(e,n);var r=this.persistence.No,i=[];return r&&e.forEach((function(e){i.push(r.Go(t,e))})),Gu.kn(i)},t.prototype.pa=function(t,e){return this.al.Kh(e),Gu.resolve()},t.prototype.xa=function(t,e){var n=this.al.Wh(e);return Gu.resolve(n)},t.prototype.Ho=function(t,e){return Gu.resolve(this.al.Ho(e))},t}(),Af=function(){function t(t){var e,n=this;this.cl={},this.Ma=new la(0),this.$a=!1,this.$a=!0,this.No=t(this),this.ja=new Tf(this),this.Dr=new ac,this.vr=(e=this.Dr,new Ef(e,(function(t){return n.No.ul(t)})))}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Di=function(){return this.$a=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),t.prototype.Za=function(){},t.prototype.th=function(){},t.prototype.Ah=function(){return this.Dr},t.prototype.Th=function(t){var e=this.cl[t.ti()];return e||(e=new If(this.Dr,this.No),this.cl[t.ti()]=e),e},t.prototype.Ih=function(){return this.ja},t.prototype.mh=function(){return this.vr},t.prototype.runTransaction=function(t,e,n){var r=this;ri("MemoryPersistence","Starting transaction:",t);var i=new Nf(this.Ma.next());return this.No.ll(),n(i).next((function(t){return r.No._l(i).next((function(){return t}))})).xn().then((function(t){return i.br(),t}))},t.prototype.fl=function(t,e){return Gu.On(Object.values(this.cl).map((function(n){return function(){return n.Ho(t,e)}})))},t}(),Nf=function(t){function n(e){var n=this;return(n=t.call(this)||this).Fa=e,n}return e(n,t),n}(Sa),Sf=function(){function t(t){this.persistence=t,this.dl=new th,this.wl=null}return t.El=function(e){return new t(e)},Object.defineProperty(t.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw ui()},enumerable:!1,configurable:!0}),t.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),Gu.resolve()},t.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),Gu.resolve()},t.prototype.Go=function(t,e){return this.Tl.add(e.toString()),Gu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.dl.Kh(e.targetId).forEach((function(t){return n.Tl.add(t.toString())}));var r=this.persistence.Ih();return r.xa(t,e.targetId).next((function(t){t.forEach((function(t){return n.Tl.add(t.toString())}))})).next((function(){return r.ya(t,e)}))},t.prototype.ll=function(){this.wl=new Set},t.prototype._l=function(t){var e=this,n=this.persistence.mh().ra();return Gu.forEach(this.Tl,(function(r){var i=ki.H(r);return e.Il(t,i).next((function(t){t||n.Ar(i)}))})).next((function(){return e.wl=null,n.apply(t)}))},t.prototype.yh=function(t,e){var n=this;return this.Il(t,e).next((function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())}))},t.prototype.ul=function(t){return 0},t.prototype.Il=function(t,e){var n=this;return Gu.On([function(){return Gu.resolve(n.dl.Ho(e))},function(){return n.persistence.Ih().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},t}(),Df=function(){function t(t){this.ml=t.ml,this.Al=t.Al}return t.prototype.gc=function(t){this.Rl=t},t.prototype.Ic=function(t){this.Pl=t},t.prototype.onMessage=function(t){this.gl=t},t.prototype.close=function(){this.Al()},t.prototype.send=function(t){this.ml(t)},t.prototype.Vl=function(){this.Rl()},t.prototype.yl=function(t){this.Pl(t)},t.prototype.pl=function(t){this.gl(t)},t}(),Of={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},xf=function(t){function n(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.T=e.T,n}return e(n,t),n.prototype.Nl=function(t,e,n,r){return new Promise((function(i,o){var s=new $r;s.listenOnce(Qr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Yr.NO_ERROR:var e=s.getResponseJson();ri("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Yr.TIMEOUT:ri("Connection",'RPC "'+t+'" timed out'),o(new ti(Zr.DEADLINE_EXCEEDED,"Request time out"));break;case Yr.HTTP_ERROR:var n=s.getStatus();if(ri("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=(a=r.status,c=a.toLowerCase().replace("_","-"),Object.values(Zr).indexOf(c)>=0?c:Zr.UNKNOWN);o(new ti(u,r.message))}else o(new ti(Zr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new ti(Zr.UNAVAILABLE,"Connection failed."));break;default:ui()}}finally{ri("Connection",'RPC "'+t+'" completed.')}var a,c}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},n.prototype.Vc=function(t,e){var n,r,i=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=new zr,s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.Cl(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())||"object"==typeof navigator&&"ReactNative"===navigator.product||f().indexOf("Electron/")>=0||((r=f()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)||f().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");ri("Connection","Creating WebChannel: "+u,s);var a=o.createWebChannel(u,s),c=!1,h=!1,l=new Df({ml:function(t){h?ri("Connection","Not sending because WebChannel is closed:",t):(c||(ri("Connection","Opening WebChannel transport."),a.open(),c=!0),ri("Connection","WebChannel sending:",t),a.send(t))},Al:function(){return a.close()}}),p=function(t,e){a.listen(t,(function(t){try{e(t)}catch(n){setTimeout((function(){throw n}),0)}}))};return p(Jr.EventType.OPEN,(function(){h||ri("Connection","WebChannel transport opened.")})),p(Jr.EventType.CLOSE,(function(){h||(h=!0,ri("Connection","WebChannel transport closed"),l.yl())})),p(Jr.EventType.ERROR,(function(t){h||(h=!0,oi("Connection","WebChannel transport errored:",t),l.yl(new ti(Zr.UNAVAILABLE,"The operation could not be completed")))})),p(Jr.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];ai(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){ri("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=qi[t];if(void 0!==e)return Ki(e)}(o),u=i.message;void 0===s&&(s=Zr.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),h=!0,l.yl(new ti(s,u)),a.close()}else ri("Connection","WebChannel received:",n),l.pl(n)}})),setTimeout((function(){l.Vl()}),0),l},n}(function(){function t(t){this.bl=t,this._=t._;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}return t.prototype.Mc=function(t,e,n,r){var i=this.Dl(t,e);ri("RestConnection","Sending: ",i,n);var o={};return this.Cl(o,r),this.Nl(t,i,o,n).then((function(t){return ri("RestConnection","Received: ",t),t}),(function(e){throw oi("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$c=function(t,e,n,r){return this.Mc(t,e,n,r)},t.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.0",t["Content-Type"]="text/plain",e)for(var n in e.Gh)e.Gh.hasOwnProperty(n)&&(t[n]=e.Gh[n])},t.prototype.Dl=function(t,e){var n=Of[t];return this.vl+"/v1/"+e+":"+n},t}()),Pf=function(){function t(){var t=this;this.xl=function(){return t.Fl()},this.kl=function(){return t.Ol()},this.Ml=[],this.$l()}return t.prototype.eu=function(t){this.Ml.push(t)},t.prototype.Di=function(){window.removeEventListener("online",this.xl),window.removeEventListener("offline",this.kl)},t.prototype.$l=function(){window.addEventListener("online",this.xl),window.addEventListener("offline",this.kl)},t.prototype.Fl=function(){ri("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},t.prototype.Ol=function(){ri("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},t.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),kf=function(){function t(){}return t.prototype.eu=function(t){},t.prototype.Di=function(){},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lf(t){return new Bo(t,!0)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.Su=this.Ll(t),this.persistence=this.Bl(t),[4,this.persistence.start()];case 1:return e.sent(),this.ql=this.Ul(t),this.Gc=this.Kl(t),[2]}}))}))},t.prototype.Ul=function(t){return null},t.prototype.Kl=function(t){return e=this.persistence,n=new wf,r=t.Ql,new Gc(e,n,r);var e,n,r},t.prototype.Bl=function(t){return new Af(Sf.El)},t.prototype.Ll=function(t){return new Ea},t.prototype.terminate=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Su.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}}))}))},t}(),Cf=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).Wl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return e(n,t),n.prototype.initialize=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,$c(this.Gc)];case 2:return n.sent(),[4,this.Wl.initialize(this,e)];case 3:return n.sent(),[4,bf(this.Wl.fi)];case 4:return n.sent(),[4,Oh(this.Wl.bu)];case 5:return n.sent(),[2]}}))}))},n.prototype.Ul=function(t){var e=this.persistence.No.wo;return new Ra(e,t.hs)},n.prototype.Bl=function(t){var e=qc(t.bl._,t.bl.persistenceKey),n=void 0!==this.cacheSizeBytes?La.ao(this.cacheSizeBytes):La.fo,r=Lf(t.bl._);return new Vc(this.synchronizeTabs,e,t.clientId,n,t.hs,$u(),Zu(),r,this.Su,!!this.forceOwnership)},n.prototype.Ll=function(t){return new Ea},n}(Rf),Vf=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Wl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return e(n,t),n.prototype.initialize=function(e){return r(this,void 0,void 0,(function(){var n,o=this;return i(this,(function(s){switch(s.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return s.sent(),n=this.Wl.fi,this.Su instanceof Ia?(this.Su.fi={er:ff.bind(null,n),nr:yf.bind(null,n),sr:gf.bind(null,n),pi:vf.bind(null,n)},[4,this.Su.start()]):[3,3];case 2:s.sent(),s.label=3;case 3:return[4,this.persistence.Xa((function(t){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,lf(this.Wl.fi,t)];case 1:return e.sent(),this.ql&&(t&&!this.ql.Ii?this.ql.start(this.Gc):t||this.ql.stop()),[2]}}))}))}))];case 4:return s.sent(),[2]}}))}))},n.prototype.Ll=function(t){var e=$u();if(!Ia.Ln(e))throw new ti(Zr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=qc(t.bl._,t.bl.persistenceKey);return new Ia(e,t.hs,n,t.clientId,t.Ql)},n}(Cf),Mf=function(){function t(){}return t.prototype.initialize=function(t,e){return r(this,void 0,void 0,(function(){var n=this;return i(this,(function(r){switch(r.label){case 0:return this.Gc?[3,2]:(this.Gc=t.Gc,this.Su=t.Su,this.zc=this.jl(e),this.bu=this.Gl(e),this.vu=this.zl(e),this.fi=this.Hl(e,!t.synchronizeTabs),this.Su.di=function(t){return Yh(n.fi,t,1)},this.bu.Hc.Jl=af.bind(null,this.fi),[4,Vh(this.bu,this.fi.Uu)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.zl=function(t){return new ia},t.prototype.jl=function(t){var e,n,r=Lf(t.bl._),i=(e=t.bl,new xf(e));return n=t.credentials,new hh(n,i,r)},t.prototype.Gl=function(t){var e,n,r,i,o,s=this;return e=this.Gc,n=this.zc,r=t.hs,i=function(t){return Yh(s.fi,t,0)},o=Pf.Ln()?new Pf:new kf,new lh(e,n,r,i,o)},t.prototype.Hl=function(t,e){return n=this.Gc,r=this.bu,i=this.vu,o=this.Su,s=t.Ql,u=t.Du,a=e,c=new zh(n,r,i,o,s,u),a&&(c.qu=!0),c;var n,r,i,o,s,u,a,c},t.prototype.terminate=function(){return vh(this.bu)},t}(),Uf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.Yl(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.Yl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Xl=function(){this.muted=!0},t.prototype.Yl=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(t,e,n){if(!n)throw new ti(Zr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Ff(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ti(Zr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function qf(t,e,n,r){if(!0===e&&!0===r)throw new ti(Zr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Gf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ui()}function Bf(t,e){if(e<=0)throw new ti(Zr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zf=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new ti(Zr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Zl=new Pi(t)},Hf=function(t){function n(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return e(n,t),n.documentId=function(){return new n(Pi.j().B())},n.prototype.isEqual=function(t){return t instanceof n&&this.Zl.isEqual(t.Zl)},n}(zf),Kf=new RegExp("[~\\*/\\[\\]]"),Wf=function(t){this.t_=t},Xf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.e_=function(t){if(2!==t.n_)throw 1===t.n_?t.s_(this.t_+"() can only appear at the top level of your update data"):t.s_(this.t_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},n.prototype.isEqual=function(t){return t instanceof n},n}(Wf);function Yf(t,e,n){return new ul({n_:3,i_:e.settings.i_,methodName:t.t_,r_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var Qf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.e_=function(t){return new Cs(t.path,new Ns)},n.prototype.isEqual=function(t){return t instanceof n},n}(Wf),Jf=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).o_=n,r}return e(n,t),n.prototype.e_=function(t){var e=Yf(this,t,!0),n=this.o_.map((function(t){return pl(t,e)})),r=new Ss(n);return new Cs(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(Wf),$f=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).o_=n,r}return e(n,t),n.prototype.e_=function(t){var e=Yf(this,t,!0),n=this.o_.map((function(t){return pl(t,e)})),r=new Os(n);return new Cs(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(Wf),Zf=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).a_=n,r}return e(n,t),n.prototype.e_=function(t){var e=new Ps(t.serializer,Ko(t.serializer,this.a_));return new Cs(t.path,e)},n.prototype.isEqual=function(t){return this===t},n}(Wf),tl=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new ti(Zr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new ti(Zr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.h_=t,this.c_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.c_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.h_===t.h_&&this.c_===t.c_},t.prototype.toJSON=function(){return{latitude:this.h_,longitude:this.c_}},t.prototype.g=function(t){return li(this.h_,t.h_)||li(this.c_,t.c_)},t}(),el=function(t){this.u_=t},nl=/^__.*__$/,rl=function(t,e,n){this.l_=t,this.__=e,this.f_=n},il=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.d_=function(t,e){var n=[];return null!==this.Qe?n.push(new Ks(t,this.data,this.Qe,e)):n.push(new Hs(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Xs(t,this.fieldTransforms)),n},t}(),ol=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.d_=function(t,e){var n=[new Ks(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new Xs(t,this.fieldTransforms)),n},t}();function sl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ui()}}var ul=function(){function t(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.w_(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"n_",{get:function(){return this.settings.n_},enumerable:!1,configurable:!0}),t.prototype.E_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.T_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.E_({path:n,r_:!1});return r.I_(t),r},t.prototype.m_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.E_({path:n,r_:!1});return r.w_(),r},t.prototype.A_=function(t){return this.E_({path:void 0,r_:!0})},t.prototype.s_=function(t){return bl(t,this.settings.methodName,this.settings.R_||!1,this.path,this.settings.i_)},t.prototype.contains=function(t){return void 0!==this.Qe.find((function(e){return t.M(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.M(e.field)}))},t.prototype.w_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},t.prototype.I_=function(t){if(0===t.length)throw this.s_("Document fields must not be empty");if(sl(this.n_)&&nl.test(t))throw this.s_('Document fields cannot begin and end with "__"')},t}(),al=function(){function t(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||Lf(t)}return t.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new ul({n_:t,methodName:e,i_:n,path:Pi.U(),r_:!1,R_:r},this._,this.serializer,this.ignoreUndefinedProperties)},t}();function cl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);yl("Data must be an object, but it was:",s,r);var u,a,c=dl(r,s);if(o.merge)u=new Rs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof zf)d=p.Zl;else{if("string"!=typeof p)throw ui();d=ml(e,p,n)}if(!s.contains(d))throw new ti(Zr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");wl(h,d)||h.push(d)}u=new Rs(h),a=s.fieldTransforms.filter((function(t){return u.Je(t.field)}))}else u=null,a=s.fieldTransforms;return new il(new Zs(c),u,a)}function hl(t,e,n,r){var i=t.P_(1,e,n);yl("Data must be an object, but it was:",i,r);var o=[],s=new tu;_i(r,(function(t,r){var u=ml(e,t,n),a=i.m_(u);if(r instanceof Xf||r instanceof el&&r.u_ instanceof Xf)o.push(u);else{var c=pl(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new Rs(o);return new ol(s.Xe(),u,i.fieldTransforms)}function fl(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[gl(e,r,n)],a=[i];if(o.length%2!=0)throw new ti(Zr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(gl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new tu,l=u.length-1;l>=0;--l)if(!wl(h,u[l])){var p=u[l],d=a[l],v=s.m_(p);if(d instanceof Xf||d instanceof el&&d.u_ instanceof Xf)h.push(p);else{var y=pl(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new Rs(h);return new ol(f.Xe(),g,s.fieldTransforms)}function ll(t,e,n,r){return void 0===r&&(r=!1),pl(n,t.P_(r?4:3,e))}function pl(t,e){if(t instanceof el&&(t=t.u_),vl(t))return yl("Unsupported field value:",e,t),dl(t,e);if(t instanceof Wf)return function(t,e){if(!sl(e.n_))throw e.s_(t.t_+"() can only be used with update() and set()");if(!e.path)throw e.s_(t.t_+"() is not currently supported inside arrays");var n=t.e_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.r_&&4!==e.n_)throw e.s_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=pl(o[i],e.A_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ko(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ni.fromDate(t);return{timestampValue:Wo(e.serializer,n)}}if(t instanceof Ni){var r=new Ni(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Wo(e.serializer,r)}}if(t instanceof tl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof yi)return{bytesValue:Xo(e.serializer,t.l)};if(t instanceof rl){var i=e._,o=t.l_;if(!o.isEqual(i))throw e.s_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Jo(t.l_||e._,t.__.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.s_("Unsupported field value: "+Gf(t))}(t,e)}function dl(t,e){var n={};return Ti(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):_i(t,(function(t,r){var i=pl(r,e.T_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function vl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ni||t instanceof tl||t instanceof yi||t instanceof rl||t instanceof Wf)}function yl(t,e,n){if(!vl(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=Gf(n);throw"an object"===r?e.s_(t+" a custom object"):e.s_(t+" "+r)}var i}function gl(t,e,n){if(e instanceof zf)return e.Zl;if("string"==typeof e)return ml(t,e);throw bl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function ml(t,e,n){try{return function(t){if(t.search(Kf)>=0)throw new ti(Zr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Hf.bind.apply(Hf,a([void 0],t.split("."))))}catch(e){throw new ti(Zr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Zl}catch(i){throw bl((r=i)instanceof Error?r.message:r.toString(),t,!1,void 0,n)}var r}function bl(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new ti(Zr.INVALID_ARGUMENT,(u+=". ")+t+a)}function wl(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Il=function(){function t(t){this.zc=t,this.g_=new Map,this.mutations=[],this.V_=!1,this.y_=null,this.p_=new Set}return t.prototype.b_=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(o){switch(o.label){case 0:if(this.v_(),this.mutations.length>0)throw new ti(Zr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a;return i(this,(function(i){switch(i.label){case 0:return n=ci(t),r=rs(n.serializer)+"/documents",o={documents:e.map((function(t){return Zo(n.serializer,t)}))},[4,n.$c("BatchGetDocuments",r,o)];case 1:return s=i.sent(),u=new Map,s.forEach((function(t){var e,r,i=(e=n.serializer,"found"in(r=t)?function(t,e){ai(!!e.found),e.found.name,e.found.updateTime;var n=ts(t,e.found.name),r=Qo(e.found.updateTime),i=new Zs({mapValue:{fields:e.found.fields}});return new ru(n,r,i,{})}(e,r):"missing"in r?function(t,e){ai(!!e.missing),ai(!!e.readTime);var n=ts(t,e.missing),r=Qo(e.readTime);return new iu(n,r)}(e,r):ui());u.set(i.key.toString(),i)})),a=[],[2,(e.forEach((function(t){var e=u.get(t.toString());ai(!!e),a.push(e)})),a)]}}))}))}(this.zc,t)];case 1:return[2,((e=o.sent()).forEach((function(t){t instanceof iu||t instanceof ru?n.S_(t):ui()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.d_(t,this.Ge(t))),this.p_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.d_(t,this.D_(t)))}catch(n){this.y_=n}this.p_.add(t.toString())},t.prototype.delete=function(t){this.write([new Js(t,this.Ge(t))]),this.p_.add(t.toString())},t.prototype.commit=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:if(this.v_(),this.y_)throw this.y_;return t=this.g_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=ki.H(n);e.mutations.push(new $s(r,e.Ge(r)))})),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=ci(t),r=rs(n.serializer)+"/documents",o={writes:e.map((function(t){return ss(n.serializer,t)}))},[4,n.Mc("Commit",r,o)];case 1:return i.sent(),[2]}}))}))}(this.zc,this.mutations)];case 1:return n.sent(),this.V_=!0,[2]}}))}))},t.prototype.S_=function(t){var e;if(t instanceof ru)e=t.version;else{if(!(t instanceof iu))throw ui();e=Si.min()}var n=this.g_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new ti(Zr.ABORTED,"Document version changed between two reads.")}else this.g_.set(t.key.toString(),e)},t.prototype.Ge=function(t){var e=this.g_.get(t.toString());return!this.p_.has(t.toString())&&e?Ms.updateTime(e):Ms.ze()},t.prototype.D_=function(t){var e=this.g_.get(t.toString());if(!this.p_.has(t.toString())&&e){if(e.isEqual(Si.min()))throw new ti(Zr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ms.updateTime(e)}return Ms.exists(!0)},t.prototype.write=function(t){this.v_(),this.mutations=this.mutations.concat(t)},t.prototype.v_=function(){},t}(),El=function(){function t(t,e,n,r){this.hs=t,this.zc=e,this.updateFunction=n,this.ls=r,this.C_=5,this.Vs=new qu(this.hs,"transaction_retry")}return t.prototype.run=function(){this.N_()},t.prototype.N_=function(){var t=this;this.Vs.Pn((function(){return r(t,void 0,void 0,(function(){var t,e,n=this;return i(this,(function(r){return t=new Il(this.zc),(e=this.x_(t))&&e.then((function(e){n.hs.ws((function(){return t.commit().then((function(){n.ls.resolve(e)})).catch((function(t){n.F_(t)}))}))})).catch((function(t){n.F_(t)})),[2]}))}))}))},t.prototype.x_=function(t){try{var e=this.updateFunction(t);return!Li(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.ls.reject(n),null}},t.prototype.F_=function(t){var e=this;this.C_>0&&this.k_(t)?(this.C_-=1,this.hs.ws((function(){return e.N_(),Promise.resolve()}))):this.ls.reject(t)},t.prototype.k_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Hi(e)}return!1},t}(),_l=function(){function t(t,e){this.credentials=t,this.hs=e,this.clientId=fi.t(),this.O_=new Fu}return t.prototype.start=function(t,e,n){var o=this;this.M_(),this.bl=t;var s=new Fu,u=!1;return this.credentials.Jh((function(t){if(!u)return u=!0,ri("FirestoreClient","Initializing. user=",t.uid),o.L_(e,n,t,s).then(o.O_.resolve,o.O_.reject);o.hs.Cs((function(){return function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return(n=ci(t)).hs.Fs(),ri("RemoteStore","RemoteStore received new credentials"),r=Eh(n),n.Xc.add(3),[4,dh(n)];case 1:return i.sent(),r&&n.nu.set("Unknown"),[4,n.Hc.Jl(e)];case 2:return i.sent(),n.Xc.delete(3),[4,ph(n)];case 3:return i.sent(),[2]}}))}))}(o.bu,t)}))})),this.hs.ws((function(){return o.O_.promise})),s.promise},t.prototype.enableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue((function(){return t.persistence.th(!0),e=t.bu,(n=ci(e)).Xc.delete(0),ph(n);var e,n}))},t.prototype.L_=function(t,e,n,o){return r(this,void 0,void 0,(function(){var s,u,a=this;return i(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),s={hs:this.hs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Ql:n,Du:100},[4,t.initialize(s)];case 1:return c.sent(),[4,e.initialize(t,s)];case 2:return c.sent(),this.persistence=t.persistence,this.Su=t.Su,this.Gc=t.Gc,this.ql=t.ql,this.zc=e.zc,this.bu=e.bu,this.fi=e.fi,this.B_=e.vu,this.B_.Us=Hh.bind(null,this.fi),this.B_.Ws=Wh.bind(null,this.fi),this.persistence.Za((function(){return r(a,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),o.resolve(),[3,4];case 3:if(u=c.sent(),o.reject(u),!("FirebaseError"===(h=u).name?h.code===Zr.FAILED_PRECONDITION||h.code===Zr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&h instanceof DOMException)||22===h.code||20===h.code||11===h.code))throw u;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+u),this.L_(new Rf,new Mf,n,o))];case 4:return[2]}var h}))}))},t.prototype.M_=function(){if(this.hs.ps)throw new ti(Zr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue((function(){return t.persistence.th(!1),function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return(e=ci(t)).Xc.add(0),[4,dh(e)];case 1:return n.sent(),e.nu.set("Offline"),[2]}}))}))}(t.bu)}))},t.prototype.terminate=function(){var t=this;this.hs.Ds();var e=new Fu;return this.hs.bs((function(){return r(t,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,vh(this.bu)];case 1:return r.sent(),[4,this.Su.Di()];case 2:return r.sent(),[4,this.persistence.Di()];case 3:return r.sent(),this.credentials.Yh(),e.resolve(),[3,5];case 4:return t=r.sent(),n=na(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}}))}))})),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.M_();var e=new Fu;return this.hs.ws((function(){return function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u;return i(this,(function(i){switch(i.label){case 0:Eh((n=ci(t)).bu)||ri("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(a=n.Gc,c=ci(a),c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return c.Sr.qo(t)})))];case 2:return-1===(r=i.sent())?[2,void e.resolve()]:((o=n.Lu.get(r)||[]).push(e),n.Lu.set(r,o),[3,4]);case 3:return s=i.sent(),u=na(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}var a,c}))}))}(t.fi,e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.M_();var i=new Uf(n),o=new ha(t,i,e);return this.hs.ws((function(){return oa(r.B_,o)})),function(){i.Xl(),r.hs.ws((function(){return sa(r.B_,o)}))}},t.prototype.q_=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(o){switch(o.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return o.sent(),e=new Fu,[2,(this.hs.ws((function(){return function(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,(u=t,a=e,c=ci(u),c.persistence.runTransaction("read document","readonly",(function(t){return c.Nh.Cr(t,a)})))];case 1:return(r=i.sent())instanceof ru?n.resolve(r):r instanceof iu?n.resolve(null):n.reject(new ti(Zr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return o=i.sent(),s=na(o,"Failed to get document '"+e+" from cache"),n.reject(s),[3,3];case 3:return[2]}var u,a,c}))}))}(n.Gc,t,e)})),e.promise)]}}))}))},t.prototype.U_=function(t,e){return void 0===e&&(e={}),r(this,void 0,void 0,(function(){var n,r=this;return i(this,(function(i){switch(i.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return i.sent(),n=new Fu,[2,(this.hs.ws((function(){return i=r.B_,o=r.hs,s=t,u=e,a=n,c=new Uf({next:function(t){o.ws((function(){return sa(i,h)}));var e=t.docs.has(s);!e&&t.fromCache?a.reject(new ti(Zr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&u&&"server"===u.source?a.reject(new ti(Zr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(t)},error:function(t){return a.reject(t)}}),h=new ha(au(s.path),c,{includeMetadataChanges:!0,Xs:!0}),oa(i,h);var i,o,s,u,a,c,h})),n.promise)]}}))}))},t.prototype.K_=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(o){switch(o.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return o.sent(),e=new Fu,[2,(this.hs.ws((function(){return function(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u,a,c;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Yc(t,e,!0)];case 1:return r=i.sent(),o=new qh(e,r.Fh),s=o.Eu(r.documents),u=o.Vr(s,!1),n.resolve(u.snapshot),[3,3];case 2:return a=i.sent(),c=na(a,"Failed to execute query '"+e+" against cache"),n.reject(c),[3,3];case 3:return[2]}}))}))}(n.Gc,t,e)})),e.promise)]}}))}))},t.prototype.Q_=function(t,e){return void 0===e&&(e={}),r(this,void 0,void 0,(function(){var n,r=this;return i(this,(function(i){switch(i.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return i.sent(),n=new Fu,[2,(this.hs.ws((function(){return i=r.B_,o=r.hs,s=t,u=e,a=n,c=new Uf({next:function(t){o.ws((function(){return sa(i,h)})),t.fromCache&&"server"===u.source?a.reject(new ti(Zr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(t)},error:function(t){return a.reject(t)}}),h=new ha(s,c,{includeMetadataChanges:!0,Xs:!0}),oa(i,h);var i,o,s,u,a,c,h})),n.promise)]}}))}))},t.prototype.write=function(t){var e=this;this.M_();var n=new Fu;return this.hs.ws((function(){return function(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u;return i(this,(function(i){switch(i.label){case 0:r=bf(t),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,(a=r.Gc,c=e,f=ci(a),l=Ni.now(),p=c.reduce((function(t,e){return t.add(e.key)}),oo()),f.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return f.Nh.Or(t,p).next((function(e){h=e;for(var n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=Gs(o,h.get(o.key));null!=s&&n.push(new Ks(o.key,s,eu(s.proto.mapValue),Ms.exists(!0)))}return f.Sr.Oo(t,l,n,c)}))})).then((function(t){var e=t.lr(h);return{batchId:t.batchId,wr:e}})))];case 2:return o=i.sent(),r.Su.Fi(o.batchId),function(t,e,n){var r=t.$u[t.currentUser.ti()];r||(r=new Wi(li)),r=r.ot(e,n),t.$u[t.currentUser.ti()]=r}(r,o.batchId,n),[4,uf(r,o.wr)];case 3:return i.sent(),[4,Oh(r.bu)];case 4:return i.sent(),[3,6];case 5:return s=i.sent(),u=na(s,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}var a,c,h,f,l,p}))}))}(e.fi,t,n)})),n.promise},t.prototype._=function(){return this.bl._},t.prototype.W_=function(t){var e=this;this.M_();var n=new Uf(t);return this.hs.ws((function(){return r(e,void 0,void 0,(function(){return i(this,(function(t){return[2,(e=this.B_,r=n,ci(e).qs.add(r),void r.next())];var e,r}))}))})),function(){n.Xl(),e.hs.ws((function(){return r(e,void 0,void 0,(function(){return i(this,(function(t){return[2,(e=this.B_,r=n,void ci(e).qs.delete(r))];var e,r}))}))}))}},Object.defineProperty(t.prototype,"j_",{get:function(){return this.hs.ps},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.M_();var n=new Fu;return this.hs.ws((function(){return new El(e.hs,e.zc,t,n).run(),Promise.resolve()})),n.promise},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Al=function(){function t(t,e,n,r){this._=t,this.G_=e,this.z_=n,this.H_=r}return t.prototype.J_=function(t){switch(Ao(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Lo(t.integerValue||t.doubleValue);case 3:return this.Y_(t.timestampValue);case 4:return this.X_(t);case 5:return t.stringValue;case 6:return this.H_(Ro(t.bytesValue));case 7:return this.Z_(t.referenceValue);case 8:return this.tf(t.geoPointValue);case 9:return this.ef(t.arrayValue);case 10:return this.nf(t.mapValue);default:throw ui()}},t.prototype.nf=function(t){var e=this,n={};return _i(t.fields||{},(function(t,r){n[t]=e.J_(r)})),n},t.prototype.tf=function(t){return new tl(Lo(t.latitude),Lo(t.longitude))},t.prototype.ef=function(t){var e=this;return(t.values||[]).map((function(t){return e.J_(t)}))},t.prototype.X_=function(t){switch(this.G_){case"previous":var e=Eo(t);return null==e?null:this.J_(e);case"estimate":return this.Y_(_o(t));default:return null}},t.prototype.Y_=function(t){var e=ko(t);return new Ni(e.seconds,e.nanos)},t.prototype.Z_=function(t){var e=Oi.q(t);ai(Is(e));var n=new Ii(e.get(1),e.get(3)),r=new ki(e.N(5));return n.isEqual(this._)||ii("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.z_(r)},t}(),Nl=La.uo,Sl=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new ti(Zr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=La._o;else{if(t.cacheSizeBytes!==Nl&&t.cacheSizeBytes<La.lo)throw new ti(Zr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+La.lo);this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,qf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Dl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Ol=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){throw new ti(Zr.FAILED_PRECONDITION,Dl)},t.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new ti(Zr.FAILED_PRECONDITION,Dl)},t.prototype.clearIndexedDbPersistence=function(t){throw new ti(Zr.FAILED_PRECONDITION,Dl)},t}(),xl=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){var n=new Mf,r=new Cf(n,t.sf().cacheSizeBytes,e);return t.if(r,n)},t.prototype.enableMultiTabIndexedDbPersistence=function(t){var e=new Mf,n=new Vf(e,t.sf().cacheSizeBytes);return t.if(n,e)},t.prototype.clearIndexedDbPersistence=function(t){var e=this,n=new Fu;return t.rf.bs((function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return Bu.Ln()?(e=t+"main",[4,Bu.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(qc(t.l_,t.af))];case 1:return o.sent(),n.resolve(),[3,3];case 2:return e=o.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise},t}(),Pl=function(){function t(e,n,o){var s=this;if(void 0===o&&(o=new Ol),this.hf=o,this.cf=null,this.rf=new ea,this.INTERNAL={delete:function(){return r(s,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.uf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var u=e;this.cf=u,this.l_=t._f(u),this.af=u.name,this.ff=new ih(n)}else{var a=e;if(!a.projectId)throw new ti(Zr.INVALID_ARGUMENT,"Must provide projectId");this.l_=new Ii(a.projectId,a.database),this.af="[DEFAULT]",this.ff=new rh}this.df=new Sl({})}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.Ef||(this.Ef=new al(this.l_,this.df.ignoreUndefinedProperties)),this.Ef},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.df),t)).merge;var e=new Sl(t);if(this.lf&&!this.df.isEqual(e))throw new ti(Zr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.df=e,void 0!==e.credentials&&(this.ff=function(t){if(!t)return new rh;switch(t.type){case"gapi":var e=t.client;return ai(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new sh(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new ti(Zr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.df.host&&oi("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},t.prototype.enableNetwork=function(){return this.uf(),this.lf.enableNetwork()},t.prototype.disableNetwork=function(){return this.uf(),this.lf.disableNetwork()},t.prototype.enablePersistence=function(t){if(this.lf)throw new ti(Zr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&qf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.hf.enableMultiTabIndexedDbPersistence(this):this.hf.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0!==this.lf&&!this.lf.j_)throw new ti(Zr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return[2,this.hf.clearIndexedDbPersistence(this)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"Tf",{get:function(){return this.uf(),this.lf.j_},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.uf(),this.lf.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.uf(),Tl(t))return this.lf.W_(t);var e={next:t};return this.lf.W_(e)},t.prototype.uf=function(){return this.lf||this.if(new Rf,new Mf),this.lf},t.prototype.If=function(){return new wi(this.l_,this.af,this.df.host,this.df.ssl,this.df.experimentalForceLongPolling,this.df.experimentalAutoDetectLongPolling)},t.prototype.if=function(t,e){var n=this.If();return this.lf=new _l(this.ff,this.rf),this.lf.start(n,t,e)},t._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new ti(Zr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new ti(Zr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ii(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.cf)throw new ti(Zr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return jf("Firestore.collection","path",t),this.uf(),new zl(Oi.q(t),this,null)},t.prototype.doc=function(t){return jf("Firestore.doc","path",t),this.uf(),Rl.mf(Oi.q(t),this,null)},t.prototype.collectionGroup=function(t){if(jf("Firestore.collectionGroup","collectionId",t),t.indexOf("/")>=0)throw new ti(Zr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.uf(),new Gl((e=t,new su(Oi.U(),e)),this,null);var e},t.prototype.runTransaction=function(t){var e=this;return this.uf().transaction((function(n){return t(new kl(e,n))}))},t.prototype.batch=function(){return this.uf(),new Ll(this)},t.prototype.sf=function(){return this.df},t}(),kl=function(){function t(t,e){this.Af=t,this.Rf=e}return t.prototype.get=function(t){var e=this,n=Hl("Transaction.get",t,this.Af);return this.Rf.b_([n.__]).then((function(t){if(!t||1!==t.length)return ui();var r=t[0];if(r instanceof iu)return new Vl(e.Af,n.__,null,!1,!1,n.f_);if(r instanceof ru)return new Vl(e.Af,n.__,r,!1,!1,n.f_);throw ui()}))},t.prototype.set=function(t,e,n){var r=Hl("Transaction.set",t,this.Af);n=Ff("Transaction.set",n);var i=Wl(r.f_,e,n),o=cl(this.Af.wf,"Transaction.set",r.__,i,null!==r.f_,n);return this.Rf.set(r.__,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof Hf?(r=Hl("Transaction.update",t,this.Af),i=fl(this.Af.wf,"Transaction.update",r.__,e,n,o)):(r=Hl("Transaction.update",t,this.Af),i=hl(this.Af.wf,"Transaction.update",r.__,e)),this.Rf.update(r.__,i),this},t.prototype.delete=function(t){var e=Hl("Transaction.delete",t,this.Af);return this.Rf.delete(e.__),this},t}(),Ll=function(){function t(t){this.Af=t,this.Pf=[],this.gf=!1}return t.prototype.set=function(t,e,n){this.Vf();var r=Hl("WriteBatch.set",t,this.Af);n=Ff("WriteBatch.set",n);var i=Wl(r.f_,e,n),o=cl(this.Af.wf,"WriteBatch.set",r.__,i,null!==r.f_,n);return this.Pf=this.Pf.concat(o.d_(r.__,Ms.ze())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Vf(),"string"==typeof e||e instanceof Hf?(r=Hl("WriteBatch.update",t,this.Af),i=fl(this.Af.wf,"WriteBatch.update",r.__,e,n,o)):(r=Hl("WriteBatch.update",t,this.Af),i=hl(this.Af.wf,"WriteBatch.update",r.__,e)),this.Pf=this.Pf.concat(i.d_(r.__,Ms.exists(!0))),this},t.prototype.delete=function(t){this.Vf();var e=Hl("WriteBatch.delete",t,this.Af);return this.Pf=this.Pf.concat(new Js(e.__,Ms.ze())),this},t.prototype.commit=function(){return this.Vf(),this.gf=!0,this.Pf.length>0?this.Af.uf().write(this.Pf):Promise.resolve()},t.prototype.Vf=function(){if(this.gf)throw new ti(Zr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Rl=function(t){function n(e,n,r){var i=this;return(i=t.call(this,n.l_,e,r)||this).__=e,i.firestore=n,i.f_=r,i.lf=i.firestore.uf(),i}return e(n,t),n.mf=function(t,e,r){if(t.length%2!=0)throw new ti(Zr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new n(new ki(t),e,r)},Object.defineProperty(n.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return new zl(this.__.path.F(),this.firestore,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.__.path.B()},enumerable:!1,configurable:!0}),n.prototype.collection=function(t){if(jf("DocumentReference.collection","path",t),!t)throw new ti(Zr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Oi.q(t);return new zl(this.__.path.child(e),this.firestore,null)},n.prototype.isEqual=function(t){return t instanceof n&&this.firestore===t.firestore&&this.__.isEqual(t.__)&&this.f_===t.f_},n.prototype.set=function(t,e){e=Ff("DocumentReference.set",e);var n=Wl(this.f_,t,e),r=cl(this.firestore.wf,"DocumentReference.set",this.__,n,null!==this.f_,e);return this.lf.write(r.d_(this.__,Ms.ze()))},n.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Hf?fl(this.firestore.wf,"DocumentReference.update",this.__,t,e,r):hl(this.firestore.wf,"DocumentReference.update",this.__,t),this.lf.write(n.d_(this.__,Ms.exists(!0)))},n.prototype.delete=function(){return this.lf.write([new Js(this.__,Ms.ze())])},n.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Tl(i[u])||(s=i[u],u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(Tl(i[u])){var c=i[u];i[u]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[u+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[u+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}var h={next:function(t){i[u]&&i[u](r.yf(t))},error:i[u+1],complete:i[u+2]};return this.lf.listen(au(this.__.path),a,h)},n.prototype.get=function(t){var e=this,n=this.firestore.uf();return t&&"cache"===t.source?n.q_(this.__).then((function(t){return new Vl(e.firestore,e.__,t,!0,t instanceof ru&&t.Ye,e.f_)})):n.U_(this.__,t).then((function(t){return e.yf(t)}))},n.prototype.withConverter=function(t){return new n(this.__,this.firestore,t)},n.prototype.yf=function(t){var e=t.docs.get(this.__);return new Vl(this.firestore,this.__,e,t.fromCache,t.hasPendingWrites,this.f_)},n}(rl),Cl=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Vl=function(){function t(t,e,n,r,i,o){this.Af=t,this.__=e,this.pf=n,this.bf=r,this.vf=i,this.f_=o}return t.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.pf){if(this.f_){var n=new Ml(this.Af,this.__,this.pf,this.bf,this.vf,null);return this.f_.fromFirestore(n,t)}return new Al(this.Af.l_,t.serverTimestamps||"none",(function(t){return new Rl(t,e.Af,null)}),(function(t){return new bi(t)})).J_(this.pf.rn())}},t.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.pf){var r=this.pf.data().field(gl("DocumentSnapshot.get",t,this.__));if(null!==r)return new Al(this.Af.l_,e.serverTimestamps||"none",(function(t){return new Rl(t,n.Af,n.f_)}),(function(t){return new bi(t)})).J_(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Rl(this.__,this.Af,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.pf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Cl(this.vf,this.bf)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&this.Af===e.Af&&this.bf===e.bf&&this.__.isEqual(e.__)&&(null===this.pf?null===e.pf:this.pf.isEqual(e.pf))&&this.f_===e.f_},t}(),Ml=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(e){return t.prototype.data.call(this,e)},n}(Vl);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ul(t,e,n){if("string"==typeof n){if(""===n)throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!pu(e)&&-1!==n.indexOf("/"))throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Oi.q(n));if(!ki.X(r))throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Co(t,new ki(r))}if(n instanceof rl)return Co(t,n.__);throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Gf(n)+".")}function jl(t,e){if(!Array.isArray(t)||0===t.length)throw new ti(Zr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new ti(Zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Fl(t,e,n){if(!n.isEqual(e))throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ql(t){if(hu(t)&&0===t.on.length)throw new ti(Zr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Gl=function(){function t(t,e,n){this.Sf=t,this.firestore=e,this.f_=n}return t.prototype.where=function(e,n,r){var i,o,s,u=gl("Query.where",e),a=function(t,e,n,r,i,o,s){var u;if(i.W()){if("array-contains"===o||"array-contains-any"===o)throw new ti(Zr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){jl(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(Ul(r,t,f))}u={arrayValue:{values:a}}}else u=Ul(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||jl(s,o),u=ll(n,"Query.where",s,"in"===o||"not-in"===o);var l=Tu.create(i,o,u);return function(t,e){if(e.un()){var n=lu(t);if(null!==n&&!n.isEqual(e.field))throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=fu(t);null!==r&&Fl(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new ti(Zr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new ti(Zr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(this.Sf,0,this.firestore.wf,this.firestore.l_,u,n,r);return new t((i=this.Sf,o=a,s=i.filters.concat([o]),new su(i.path,i.collectionGroup,i.on.slice(),s,i.limit,i.an,i.startAt,i.endAt)),this.firestore,this.f_)},t.prototype.orderBy=function(e,n){var r;if(void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new ti(Zr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i,o,s,u=gl("Query.orderBy",e),a=function(t,e,n){if(null!==t.startAt)throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Mu(e,n);return function(t,e){if(null===fu(t)){var n=lu(t);null!==n&&Fl(0,n,e.field)}}(t,r),r}(this.Sf,u,r);return new t((i=this.Sf,o=a,s=i.on.concat([o]),new su(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.an,i.startAt,i.endAt)),this.firestore,this.f_)},t.prototype.limit=function(e){return Bf("Query.limit",e),new t(yu(this.Sf,e,"F"),this.firestore,this.f_)},t.prototype.limitToLast=function(e){return Bf("Query.limitToLast",e),new t(yu(this.Sf,e,"L"),this.firestore,this.f_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.startAt",e,n,!0);return new t(gu(this.Sf,i),this.firestore,this.f_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.startAfter",e,n,!1);return new t(gu(this.Sf,i),this.firestore,this.f_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.endBefore",e,n,!0);return new t(mu(this.Sf,i),this.firestore,this.f_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.Df("Query.endAt",e,n,!1);return new t(mu(this.Sf,i),this.firestore,this.f_)},t.prototype.isEqual=function(e){return e instanceof t&&this.firestore===e.firestore&&bu(this.Sf,e.Sf)&&this.f_===e.f_},t.prototype.withConverter=function(e){return new t(this.Sf,this.firestore,e)},t.prototype.Df=function(t,e,n,r){if(e instanceof Vl)return function(t,e,n,r,i){if(!r)throw new ti(Zr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=du(t);s<u.length;s++){var a=u[s];if(a.field.W())o.push(Co(e,r.key));else{var c=r.field(a.field);if(Io(c))throw new ti(Zr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.B();throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Lu(o,i)}(this.Sf,this.firestore.l_,t,e.pf,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new ti(Zr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.W()){if("string"!=typeof c)throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!pu(t)&&-1!==c.indexOf("/"))throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Oi.q(c));if(!ki.X(h))throw new ti(Zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new ki(h);u.push(Co(e,f))}else{var l=ll(n,r,c);u.push(l)}}return new Lu(u,o)}(this.Sf,this.firestore.l_,this.firestore.wf,t,i,r)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s={},u=0;if("object"!=typeof i[u]||Tl(i[u])||(s=i[u],u++),Tl(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}var c={next:function(t){i[u]&&i[u](new Bl(r.firestore,r.Sf,t,r.f_))},error:i[u+1],complete:i[u+2]};return ql(this.Sf),this.firestore.uf().listen(this.Sf,s,c)},t.prototype.get=function(t){var e=this;ql(this.Sf);var n=this.firestore.uf();return(t&&"cache"===t.source?n.K_(this.Sf):n.Q_(this.Sf,t)).then((function(t){return new Bl(e.firestore,e.Sf,t,e.f_)}))},t}(),Bl=function(){function t(t,e,n,r){this.Af=t,this.Cf=e,this.Nf=n,this.f_=r,this.xf=null,this.Ff=null,this.metadata=new Cl(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Nf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Nf.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Nf.docs.forEach((function(r){t.call(e,n.kf(r,n.metadata.fromCache,n.Nf.Qt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new Gl(this.Cf,this.Af,this.f_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=!(!t||!t.includeMetadataChanges);if(e&&this.Nf.jt)throw new ti(Zr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.xf&&this.Ff===e||(this.xf=function(t,e,n){if(t.Kt.P()){var r=0;return t.docChanges.map((function(e){var i=n(e.doc,t.fromCache,t.Qt.has(e.doc.key));return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}}))}var i=t.Kt;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:Kl(e.type),doc:r,oldIndex:o,newIndex:s}}))}(this.Nf,e,this.kf.bind(this)),this.Ff=e),this.xf},t.prototype.isEqual=function(e){return e instanceof t&&this.Af===e.Af&&bu(this.Cf,e.Cf)&&this.Nf.isEqual(e.Nf)&&this.f_===e.f_},t.prototype.kf=function(t,e,n){return new Ml(this.Af,t.key,t,e,n,this.f_)},t}(),zl=function(t){function n(e,n,r){var i=this;if((i=t.call(this,au(e),n,r)||this).Of=e,e.length%2!=1)throw new ti(Zr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.B()+" has "+e.length);return i}return e(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.Sf.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this.Sf.path.F();return t.P()?null:new Rl(new ki(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.Sf.path.B()},enumerable:!1,configurable:!0}),n.prototype.doc=function(t){0===arguments.length&&(t=fi.t()),jf("CollectionReference.doc","path",t);var e=Oi.q(t);return Rl.mf(this.Sf.path.child(e),this.firestore,this.f_)},n.prototype.add=function(t){var e=this.f_?this.f_.toFirestore(t):t,n=this.doc();return new Rl(n.__,this.firestore,null).set(e).then((function(){return n}))},n.prototype.withConverter=function(t){return new n(this.Of,this.firestore,t)},n}(Gl);function Hl(t,e,n){var r=function(t,e){if(!(t instanceof e)){if(e.name===t.constructor.name)throw new ti(Zr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Gf(t);throw new ti(Zr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}(e,Rl);if(r.firestore!==n)throw new ti(Zr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function Kl(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ui()}}function Wl(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xl,Yl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.serverTimestamp=function(){var t=new Qf("serverTimestamp");return t.t_="FieldValue.serverTimestamp",new n(t)},n.delete=function(){var t=new Xf("deleteField");return t.t_="FieldValue.delete",new n(t)},n.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jf("arrayUnion",t)}.apply(void 0,t);return r.t_="FieldValue.arrayUnion",new n(r)},n.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $f("arrayRemove",t)}.apply(void 0,t);return r.t_="FieldValue.arrayRemove",new n(r)},n.increment=function(t){var e=new Zf("increment",t);return e.t_="FieldValue.increment",new n(e)},n.prototype.isEqual=function(t){return this.u_.isEqual(t.u_)},n}(el),Ql={Firestore:Pl,GeoPoint:tl,Timestamp:Ni,Blob:bi,Transaction:kl,WriteBatch:Ll,DocumentReference:Rl,DocumentSnapshot:Vl,Query:Gl,QueryDocumentSnapshot:Ml,QuerySnapshot:Bl,CollectionReference:zl,FieldPath:Hf,FieldValue:Yl,setLogLevel:function(t){var e;e=t,ei.setLogLevel(e)},CACHE_SIZE_UNLIMITED:Nl};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(Xl=Y).INTERNAL.registerComponent(new I("firestore",(function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Pl(e,n,new xl);var e,n}),"PUBLIC").setServiceProps(Object.assign({},Ql))),Xl.registerVersion("@firebase/firestore","2.0.0");export{Y as f};
