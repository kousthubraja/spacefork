import{f as e}from"./vendor.8906583d.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const t={apiKey:"AIzaSyBigDTTZrUNg3YcLglsHeIYelSYTPVcCf4",authDomain:"spacefork-1.firebaseapp.com",projectId:"spacefork-1",storageBucket:"spacefork-1.appspot.com",messagingSenderId:"877568258289",appId:"1:877568258289:web:488731f32de4202551f950",measurementId:"G-847QFBN2C6"};e.apps.length||e.initializeApp(t);const o=e.firestore(),n=new RTCPeerConnection({iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10});let a=null,c=null;const d=document.getElementById("webcamButton"),i=document.getElementById("webcamVideo"),s=document.getElementById("callButton"),r=document.getElementById("callInput"),l=document.getElementById("answerButton"),p=document.getElementById("remoteVideo"),u=document.getElementById("hangupButton");d.onclick=async()=>{a=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),c=new MediaStream,a.getTracks().forEach((e=>{n.addTrack(e,a)})),n.ontrack=e=>{e.streams[0].getTracks().forEach((e=>{c.addTrack(e)}))},i.srcObject=a,p.srcObject=c,s.disabled=!1,l.disabled=!1,d.disabled=!0},s.onclick=async()=>{const e=o.collection("calls").doc(),t=e.collection("offerCandidates"),a=e.collection("answerCandidates");r.value=e.id,n.onicecandidate=e=>{e.candidate&&t.add(e.candidate.toJSON())};const c=await n.createOffer();await n.setLocalDescription(c);const d={sdp:c.sdp,type:c.type};await e.set({offer:d}),e.onSnapshot((e=>{const t=e.data();if(!n.currentRemoteDescription&&(null==t?void 0:t.answer)){const e=new RTCSessionDescription(t.answer);n.setRemoteDescription(e)}})),a.onSnapshot((e=>{e.docChanges().forEach((e=>{if("added"===e.type){const t=new RTCIceCandidate(e.doc.data());n.addIceCandidate(t)}}))})),u.disabled=!1},l.onclick=async()=>{const e=r.value,t=o.collection("calls").doc(e),a=t.collection("answerCandidates"),c=t.collection("offerCandidates");n.onicecandidate=e=>{e.candidate&&a.add(e.candidate.toJSON())};const d=(await t.get()).data().offer;await n.setRemoteDescription(new RTCSessionDescription(d));const i=await n.createAnswer();await n.setLocalDescription(i);const s={type:i.type,sdp:i.sdp};await t.update({answer:s}),c.onSnapshot((e=>{e.docChanges().forEach((e=>{if(console.log(e),"added"===e.type){let t=e.doc.data();n.addIceCandidate(new RTCIceCandidate(t))}}))}))};
